var ct=Object.defineProperty;var mt=(_,s,c)=>s in _?ct(_,s,{enumerable:!0,configurable:!0,writable:!0,value:c}):_[s]=c;var Ke=(_,s,c)=>(mt(_,typeof s!="symbol"?s+"":s,c),c);import{B as Ae}from"./index-00a8ffd2.js";/* empty css              */import{u as Y}from"./modal-e4c7fed2.js";import{_ as pt}from"./index-e9d8f074.js";/* empty css              */import"./index-97222043.js";/* empty css              *//* empty css              *//* empty css              */import{a as ft}from"./dayjs.min-2389bdff.js";import{H as _t,u as te}from"./HttpClient-64290c27.js";import{o as x,t as ce,a as Me}from"./index-f9e6a35e.js";import{_ as Z}from"./InputDropdown.vue_vue_type_script_setup_true_lang-55961ea3.js";import{_ as ae}from"./AgGrid.vue_vue_type_script_setup_true_lang-d3dbb188.js";import{_ as me}from"./AgGridActionCell.vue_vue_type_script_setup_true_lang-cd281192.js";import{d as Re,r as d,O as F,w as He,a as Ee,e as Q,a7 as pe,ac as u,f as We,g as l,a9 as b,c as o,u as r,aa as Qe,ae as vt,X as ee,ak as gt}from"./_plugin-vue_export-helper-50c92bea.js";import{_ as yt}from"./index-f9be8515.js";import{I as bt}from"./Input-97482d20.js";import{_ as kt,F as wt}from"./Form-2caee2e0.js";import{D as ht}from"./dayjs-3e6b4e4c.js";import{_ as Ct}from"./TextArea-afcadf10.js";import{M as qt}from"./Modal-5bd2bcee.js";import{T as Dt,_ as Nt}from"./TabPane-053c7c75.js";import"./DownOutlined-dca0ecad.js";import"./_flatRest-6ef3b5aa.js";import"./isSymbol-5a6ec0b4.js";import"./debounce-52dc8683.js";import"./useRefs-9f478e5b.js";import"./useMemo-6199d1b3.js";import"./pickAttrs-44b65975.js";class T{static list(s,c){return this.HttpClient.axiosInstance.get("/survey_reports",{params:{start_date:s,end_date:c}})}static show(s){return this.HttpClient.axiosInstance.get(`/survey_reports/${s}`)}static create(s){return this.HttpClient.withOptions({showSuccessFeedback:!0,successFeedbackMessage:"Laporan survey berhasil dibuat"}).axiosInstance.post("/survey_reports",s)}static update(s,c){return this.HttpClient.withOptions({showSuccessFeedback:!0,successFeedbackMessage:"Laporan survey berhasil diupdate"}).axiosInstance.put(`/survey_reports/${s}`,c)}static print(s){return this.HttpClient.axiosInstance.get(`/survey_reports/${s}/print`)}static printMaterialRequest(s){return this.HttpClient.axiosInstance.get(`/survey_reports/${s}/print_material_request`)}static formOptions(){return this.HttpClient.axiosInstance.get("/survey_reports/form_options")}}Ke(T,"HttpClient",new _t);const xt={class:"card card-custom card-dense"},$t={class:"card-header"},Mt={class:"card-title w-100 d-flex justify-content-between"},Rt=u("h4",{class:"card-label"},"Form Laporan Survey",-1),Tt={class:"card-body"},jt={class:"row"},Ft={class:"col-lg-6"},Pt={class:"col-lg-12"},St={class:"d-flex align-items-center mb-3 justify-content-between"},Ot=u("h6",{class:"me-3 mb-0"},"Deskripsi Pekerjaan",-1),Ut={class:"col-lg-12 mt-3"},It={class:"d-flex align-items-center mb-3 justify-content-between"},Jt=u("h6",{class:"me-3 mb-0"},"Material",-1),Bt={class:"col-lg-12 mt-3"},Kt={class:"d-flex align-items-center mb-3 justify-content-between"},Wt=u("h6",{class:"me-3 mb-0"},"Consumable",-1),Qt={class:"col-lg-12 mt-3"},At={class:"d-flex align-items-center mb-3 justify-content-between"},Ht=u("h6",{class:"me-3 mb-0"},"Alat Kerja",-1),Et={class:"col-lg-12 mt-3"},Lt=u("i",{class:"fe fe-save me-2"},null,-1),zt={key:0,class:"d-inline-block"},Vt=u("span",null,"Cetak Laporan Survey",-1),Gt=u("span",null,"Cetak Permintaan Material",-1),Xt=["data"],Yt=Re({__name:"Form",props:{formData:null,editMode:{type:Boolean}},emits:["cancelEdit","onSuccess"],setup(_,{emit:s}){const c=_,$=[{field:"worklist_number",headerName:"No. Projek"},{field:"title",headerName:"Judul Projek"}],M=[{field:"product_code",headerName:"Kode Produk"},{field:"product_name",headerName:"Nama Produk"},{field:"qty",headerName:"Qty",filter:"agNumberColumnFilter",type:"numericColumn",valueFormatter:i=>ce(i.value)},{field:"note",headerName:"Catatan"},{headerName:"Aksi",filter:!1,floatingFilter:!1,sortable:!1,resizable:!1,suppressMovable:!0,pinned:"right",width:75,flex:0,cellRenderer:me,cellRendererParams:i=>({onDelete:()=>{h.value=h.value.filter(e=>e.id!==i.data.id),typeof i.data.id=="number"?be.value.push({id:i.data.id,_destroy:1}):I.value=I.value.filter(e=>e._id!==i.data.id)}})}],A=[{field:"product_code",headerName:"Kode Produk"},{field:"product_name",headerName:"Nama Produk"},{field:"qty",headerName:"Qty",filter:"agNumberColumnFilter",type:"numericColumn",valueFormatter:i=>ce(i.value)},{field:"note",headerName:"Catatan"},{headerName:"Aksi",filter:!1,floatingFilter:!1,sortable:!1,resizable:!1,suppressMovable:!0,pinned:"right",width:75,flex:0,cellRenderer:me,cellRendererParams:i=>({onDelete:()=>{C.value=C.value.filter(e=>e.id!==i.data.id),typeof i.data.id=="number"?ke.value.push({id:i.data.id,_destroy:1}):J.value=J.value.filter(e=>e._id!==i.data.id)}})}],P=[{field:"working_tool_name",headerName:"Nama Alat"},{field:"working_tool_spec",headerName:"Spesifikasi"},{field:"qty",headerName:"Qty",filter:"agNumberColumnFilter",type:"numericColumn",valueFormatter:i=>ce(i.value)},{field:"note",headerName:"Catatan"},{headerName:"Aksi",filter:!1,floatingFilter:!1,sortable:!1,resizable:!1,suppressMovable:!0,pinned:"right",width:75,flex:0,cellRenderer:me,cellRendererParams:i=>({onDelete:()=>{q.value=q.value.filter(e=>e.id!==i.data.id),typeof i.data.id=="number"?we.value.push({id:i.data.id,_destroy:1}):B.value=B.value.filter(e=>e._id!==i.data.id)}})}],H=[{field:"title",headerName:"Judul"},{field:"specification",headerName:"Spesifikasi"},{field:"qty",headerName:"Qty",filter:"agNumberColumnFilter",type:"numericColumn",valueFormatter:i=>ce(i.value)},{field:"unit_name",headerName:"Satuan"},{field:"note",headerName:"Catatan"},{headerName:"Aksi",filter:!1,floatingFilter:!1,sortable:!1,resizable:!1,suppressMovable:!0,pinned:"right",width:75,flex:0,cellRenderer:me,cellRendererParams:i=>({onDelete:()=>{D.value=D.value.filter(e=>e.id!==i.data.id),typeof i.data.id=="number"?he.value.push({id:i.data.id,_destroy:1}):K.value=K.value.filter(e=>e._id!==i.data.id)}})}],k=[{field:"code",headerName:"Kode Produk"},{field:"name",headerName:"Nama Produk"}],R=[{field:"code",headerName:"Kode Produk"},{field:"name",headerName:"Nama Produk"}],w=[{field:"name",headerName:"Nama"},{field:"specification",headerName:"Spesifikasi"}],E=[{field:"code",headerName:"Kode Unit"},{field:"name",headerName:"Nama Unit"}],S=d(""),O=d(""),fe=d(""),_e=d(""),ve=d(""),ge=d(""),ye=d(""),U=d(),oe=d(),f=F({}),Le={worklist_id:[{required:!0,message:"Projek wajib dipilih",trigger:"change"}],survey_report_date:[{required:!0,message:"Tanggal wajib diisi",trigger:"change"}]},ie=d(),v=F({}),ze={product_id:[{required:!0,message:"Produk wajib dipilih",trigger:"change"}],qty:[{required:!0,message:"Qty wajib diisi",trigger:"change"}]},le=d(),g=F({}),Ve={product_id:[{required:!0,message:"Produk wajib dipilih",trigger:"change"}],qty:[{required:!0,message:"Qty wajib diisi",trigger:"change"}]},ne=d(),y=F({}),Ge={working_tool_id:[{required:!0,message:"Alat kerja wajib dipilih",trigger:"change"}],qty:[{required:!0,message:"Qty wajib diisi",trigger:"change"}]},re=d(),p=F({}),Xe={title:[{required:!0,message:"Judul wajib dipilih",trigger:"change"}],specification:[{required:!0,message:"Spesifikasi wajib diisi",trigger:"change"}],qty:[{required:!0,message:"Qty wajib diisi",trigger:"change"}],unit_id:[{required:!0,message:"Satuan wajib dipilih",trigger:"change"}]},h=d([]),I=d([]),be=d([]),C=d([]),J=d([]),ke=d([]),q=d([]),B=d([]),we=d([]),D=d([]),K=d([]),he=d([]),{run:Te,loading:Ye,response:j}=te(),{run:Ze,loading:L,response:je}=te(),{run:et,loading:se,response:z}=te(),{run:Fe,loading:Pe,response:de}=te(),{visible:Ce,open:tt,close:oa}=Y(),{visible:qe,open:at,close:ia}=Y(),{visible:De,open:ot,close:la}=Y(),{visible:Ne,open:it,close:na}=Y(),{visible:xe,open:Se,close:lt}=Y();async function nt(){var i,e,n,W;try{c.editMode?(await Te(T.update((i=c.formData)==null?void 0:i.id,{worklist_id:f.worklist_id,description:f.description,survey_report_date:f.survey_report_date,consumables_attributes:[...J.value,...ke.value],job_descriptions_attributes:[...K.value,...he.value],materials_attributes:[...I.value,...be.value],working_tools_attributes:[...B.value,...we.value]})),(e=j.value)!=null&&e.success&&($e(),h.value=j.value.data.materials.map(a=>({id:a.id,product_id:a.product.id,product_code:a.product.code,product_name:a.product.name,qty:parseInt(a.qty,10),note:a.note})),C.value=j.value.data.consumables.map(a=>({id:a.id,product_id:a.product.id,product_code:a.product.code,product_name:a.product.name,qty:parseInt(a.qty,10),note:a.note})),q.value=j.value.data.working_tools.map(a=>({id:a.id,qty:parseInt(a.qty,10),working_tool_id:a.working_tool.id,working_tool_name:a.working_tool.name,working_tool_spec:a.working_tool.specification,note:a.note})),D.value=j.value.data.job_descriptions.map(a=>({id:a.id,qty:a.qty,title:a.title,unit_id:a.unit.id,unit_name:a.unit.name,note:a.note,specification:a.specification})))):(await Te(T.create({worklist_id:f.worklist_id,description:f.description,survey_report_date:f.survey_report_date,consumables_attributes:C.value.map(a=>({product_id:a.product_id,qty:a.qty,note:a.note})),job_descriptions_attributes:D.value.map(a=>({title:a.title,specification:a.specification,qty:a.qty,unit_id:a.unit_id,note:a.note})),materials_attributes:h.value.map(a=>({product_id:a.product_id,qty:a.qty,note:a.note})),working_tools_attributes:q.value.map(a=>({working_tool_id:a.working_tool_id,qty:a.qty,note:a.note}))})),(n=j.value)!=null&&n.success&&Oe()),(W=j.value)!=null&&W.success&&s("onSuccess")}catch{}}function Oe(){var i;if(c.editMode){for(const e in f)f[e]=void 0;s("cancelEdit")}else(i=oe.value)==null||i.resetFields();$e(),S.value=""}function Ue(){var e;const i={id:`new-${I.value.length+1}`,qty:v.qty,product_code:v.product_code,product_name:v.product_name,product_id:v.product_id,note:v.note};h.value=[...h.value,i],I.value.push({_id:i.id,product_id:v.product_id,qty:v.qty,note:v.note}),(e=ie.value)==null||e.resetFields(),O.value=""}function Ie(){var e;const i={id:`new-${J.value.length+1}`,qty:g.qty,product_code:g.product_code,product_name:g.product_name,product_id:g.product_id,note:g.note};C.value=[...C.value,i],J.value.push({_id:i.id,product_id:g.product_id,qty:g.qty,note:g.note}),(e=le.value)==null||e.resetFields(),fe.value=""}function Je(){var e;const i={id:`new-${B.value.length+1}`,qty:y.qty,working_tool_id:y.working_tool_id,working_tool_name:y.working_tool_name,working_tool_spec:y.working_tool_spec,note:y.note};q.value=[...q.value,i],B.value.push({_id:i.id,working_tool_id:y.working_tool_id,qty:y.qty,note:y.note}),(e=ne.value)==null||e.resetFields(),_e.value=""}function Be(){var e;const i={id:`new-${K.value.length+1}`,title:p.title,specification:p.specification,unit_name:p.unit_name,unit_id:p.unit_id,qty:p.qty,note:p.note};D.value=[...D.value,i],K.value.push({_id:i.id,qty:p.qty,note:p.note,specification:p.specification,title:p.title,unit_id:p.unit_id}),(e=re.value)==null||e.resetFields(),ve.value=""}async function rt(){var i,e;try{await et(T.show((i=c.formData)==null?void 0:i.id)),(e=z.value)!=null&&e.success&&(h.value=z.value.data.materials.map(n=>({id:n.id,product_id:n.product.id,product_code:n.product.code,product_name:n.product.name,qty:parseInt(n.qty,10),note:n.note})),C.value=z.value.data.consumables.map(n=>({id:n.id,product_id:n.product.id,product_code:n.product.code,product_name:n.product.name,qty:parseInt(n.qty,10),note:n.note})),q.value=z.value.data.working_tools.map(n=>({id:n.id,qty:parseInt(n.qty,10),working_tool_id:n.working_tool.id,working_tool_name:n.working_tool.name,working_tool_spec:n.working_tool.specification,note:n.note})),D.value=z.value.data.job_descriptions.map(n=>({id:n.id,qty:n.qty,title:n.title,unit_id:n.unit.id,unit_name:n.unit.name,note:n.note,specification:n.specification})))}catch{}}function $e(){h.value=[],I.value=[],be.value=[],C.value=[],J.value=[],ke.value=[],q.value=[],B.value=[],we.value=[],D.value=[],K.value=[],he.value=[]}He(()=>c.formData,()=>{var i;c.formData&&((i=oe.value)==null||i.clearValidate(),$e(),f.worklist_id=c.formData.worklist.id,f.survey_report_date=c.formData.survey_report_date,f.description=c.formData.description,S.value=`${c.formData.worklist.worklist_number} - ${c.formData.worklist.title}`,setTimeout(()=>{rt()},0))});async function st(){var i,e;try{await Fe(T.print((i=c.formData)==null?void 0:i.id)),(e=de.value)!=null&&e.success&&(ge.value="data:application/pdf;base64,"+de.value.data.base64,ye.value="Cetak Laporan Survey",Se())}catch{}}async function dt(){var i,e;try{await Fe(T.printMaterialRequest((i=c.formData)==null?void 0:i.id)),(e=de.value)!=null&&e.success&&(ge.value="data:application/pdf;base64,"+de.value.data.base64,ye.value="Cetak Permintaan Material",Se())}catch{}}return Ee(async()=>{try{(async()=>{var i;await Ze(T.formOptions()),(i=je.value)!=null&&i.success&&(U.value=je.value.data)})()}catch{}}),(i,e)=>{const n=yt,W=bt,a=kt,ut=ht,V=Ct,N=Ae,G=wt,ue=pt,X=qt;return Q(),pe("div",xt,[u("div",$t,[u("div",Mt,[Rt,_.editMode?(Q(),We(n,{key:0,color:"orange"},{default:l(()=>[b("Mode Edit")]),_:1})):(Q(),We(n,{key:1,color:"cyan"},{default:l(()=>[b("Mode Input")]),_:1}))])]),u("div",Tt,[o(G,{ref_key:"formRef",ref:oe,model:f,rules:Le,"label-col":{style:{width:"220px"}},colon:!1,"label-align":"left",onFinish:e[7]||(e[7]=t=>r(x)(oe.value,nt))},{default:l(()=>[u("div",jt,[u("div",Ft,[o(a,{label:"No. Laporan Survey"},{default:l(()=>{var t;return[o(W,{value:_.editMode?(t=_.formData)==null?void 0:t.survey_report_number:"",disabled:""},null,8,["value"])]}),_:1}),o(a,{label:"Projek",name:"worklist_id",ref:"worklist_id"},{default:l(()=>{var t;return[o(Z,{"column-defs":$,"grid-data":((t=U.value)==null?void 0:t.worklists)??[],loading:r(L),value:void 0,"value-display":S.value,onChange:e[0]||(e[0]=m=>{f.worklist_id=m.id,S.value=`${m.worklist_number} - ${m.title}`})},null,8,["grid-data","loading","value-display"])]}),_:1},512),o(a,{label:"Tgl Transaksi",name:"survey_report_date",ref:"survey_report_date"},{default:l(()=>[o(ut,{value:f.survey_report_date?r(ft)(f.survey_report_date):void 0,onChange:e[1]||(e[1]=(t,m)=>f.survey_report_date=m)},null,8,["value"])]),_:1},512),o(a,{label:"Deskripisi",name:"description",ref:"description"},{default:l(()=>[o(V,{value:f.description,"onUpdate:value":e[2]||(e[2]=t=>f.description=t)},null,8,["value"])]),_:1},512)]),u("div",Pt,[u("div",St,[Ot,o(N,{type:"primary",onClick:r(it)},{default:l(()=>[b(" Tambah Deskripsi Pekerjaan ")]),_:1},8,["onClick"])]),o(ae,{style:{height:"300px"},"row-data":D.value,"column-defs":H,loading:r(se),onRowClick:e[3]||(e[3]=()=>{})},null,8,["row-data","column-defs","loading"])]),u("div",Ut,[u("div",It,[Jt,o(N,{type:"primary",onClick:r(tt)},{default:l(()=>[b(" Tambah Material ")]),_:1},8,["onClick"])]),o(ae,{style:{height:"300px"},"row-data":h.value,"column-defs":M,loading:r(se),onRowClick:e[4]||(e[4]=()=>{})},null,8,["row-data","column-defs","loading"])]),u("div",Bt,[u("div",Kt,[Wt,o(N,{type:"primary",onClick:r(at)},{default:l(()=>[b(" Tambah Consumable ")]),_:1},8,["onClick"])]),o(ae,{style:{height:"300px"},"row-data":C.value,"column-defs":A,loading:r(se),onRowClick:e[5]||(e[5]=()=>{})},null,8,["row-data","column-defs","loading"])]),u("div",Qt,[u("div",At,[Ht,o(N,{type:"primary",onClick:r(ot)},{default:l(()=>[b(" Tambah Alat Kerja ")]),_:1},8,["onClick"])]),o(ae,{style:{height:"300px"},"row-data":q.value,"column-defs":P,loading:r(se),onRowClick:e[6]||(e[6]=()=>{})},null,8,["row-data","column-defs","loading"])]),u("div",Et,[o(N,{type:"primary","html-type":"submit",loading:r(Ye)},{default:l(()=>[Lt,u("span",null,Qe(_.editMode?"Edit":"Simpan"),1)]),_:1},8,["loading"]),o(N,{class:"mx-3",onClick:Oe},{default:l(()=>[b(Qe(_.editMode?"Batal Edit":"Bersihkan"),1)]),_:1}),_.editMode?(Q(),pe("div",zt,[o(N,{class:"ms-3",type:"primary",loading:r(Pe),onClick:st},{default:l(()=>[Vt]),_:1},8,["loading"]),o(N,{class:"ms-3",type:"primary",loading:r(Pe),onClick:dt},{default:l(()=>[Gt]),_:1},8,["loading"])])):vt("",!0)])])]),_:1},8,["model"])]),o(X,{visible:r(Ce),"onUpdate:visible":e[12]||(e[12]=t=>ee(Ce)?Ce.value=t:null),title:"Tambah Material","cancel-text":"Tutup",onOk:e[13]||(e[13]=t=>r(x)(ie.value,Ue))},{default:l(()=>[o(G,{ref_key:"formRefMaterial",ref:ie,model:v,rules:ze,"label-col":{style:{width:"80px"}},colon:!1,"label-align":"left",onFinish:e[11]||(e[11]=t=>r(x)(ie.value,Ue))},{default:l(()=>[o(a,{label:"Produk",name:"product_id",ref:"product_id"},{default:l(()=>{var t;return[o(Z,{"column-defs":k,"grid-data":((t=U.value)==null?void 0:t.material_products)??[],loading:r(L),value:void 0,"value-display":O.value,onChange:e[8]||(e[8]=m=>{v.product_id=m.id,v.product_code=m.code,v.product_name=m.name,O.value=`${m.code} - ${m.name}`})},null,8,["grid-data","loading","value-display"])]}),_:1},512),o(a,{label:"Qty",name:"qty",ref:"qty"},{default:l(()=>[o(ue,{value:v.qty,"onUpdate:value":e[9]||(e[9]=t=>v.qty=t),min:0,formatter:t=>`${t}`.replace(/\B(?=(\d{3})+(?!\d))/g,"."),parser:t=>t.replace(/\$\s?|(\.*)/g,"")},null,8,["value","formatter","parser"])]),_:1},512),o(a,{label:"Catatan",name:"note",ref:"note"},{default:l(()=>[o(V,{value:v.note,"onUpdate:value":e[10]||(e[10]=t=>v.note=t)},null,8,["value"])]),_:1},512)]),_:1},8,["model"])]),_:1},8,["visible"]),o(X,{visible:r(qe),"onUpdate:visible":e[18]||(e[18]=t=>ee(qe)?qe.value=t:null),title:"Tambah Consumable","cancel-text":"Tutup",onOk:e[19]||(e[19]=t=>r(x)(le.value,Ie))},{default:l(()=>[o(G,{ref_key:"formRefConsume",ref:le,model:g,rules:Ve,"label-col":{style:{width:"80px"}},colon:!1,"label-align":"left",onFinish:e[17]||(e[17]=t=>r(x)(le.value,Ie))},{default:l(()=>[o(a,{label:"Produk",name:"product_id",ref:"product_id"},{default:l(()=>{var t;return[o(Z,{"column-defs":R,"grid-data":((t=U.value)==null?void 0:t.consumable_products)??[],loading:r(L),value:void 0,"value-display":fe.value,onChange:e[14]||(e[14]=m=>{g.product_id=m.id,g.product_code=m.code,g.product_name=m.name,fe.value=`${m.code} - ${m.name}`})},null,8,["grid-data","loading","value-display"])]}),_:1},512),o(a,{label:"Qty",name:"qty",ref:"qty"},{default:l(()=>[o(ue,{value:g.qty,"onUpdate:value":e[15]||(e[15]=t=>g.qty=t),min:0,formatter:t=>`${t}`.replace(/\B(?=(\d{3})+(?!\d))/g,"."),parser:t=>t.replace(/\$\s?|(\.*)/g,"")},null,8,["value","formatter","parser"])]),_:1},512),o(a,{label:"Catatan",name:"note",ref:"note"},{default:l(()=>[o(V,{value:g.note,"onUpdate:value":e[16]||(e[16]=t=>g.note=t)},null,8,["value"])]),_:1},512)]),_:1},8,["model"])]),_:1},8,["visible"]),o(X,{visible:r(De),"onUpdate:visible":e[24]||(e[24]=t=>ee(De)?De.value=t:null),title:"Tambah Alat Kerja","cancel-text":"Tutup",onOk:e[25]||(e[25]=t=>r(x)(ne.value,Je))},{default:l(()=>[o(G,{ref_key:"formRefWorkingTool",ref:ne,model:y,rules:Ge,"label-col":{style:{width:"80px"}},colon:!1,"label-align":"left",onFinish:e[23]||(e[23]=t=>r(x)(ne.value,Je))},{default:l(()=>[o(a,{label:"Alat Kerja",name:"working_tool_id",ref:"working_tool_id"},{default:l(()=>{var t;return[o(Z,{"column-defs":w,"grid-data":((t=U.value)==null?void 0:t.working_tools)??[],loading:r(L),value:void 0,"value-display":_e.value,onChange:e[20]||(e[20]=m=>{y.working_tool_id=m.id,y.working_tool_name=m.name,y.working_tool_spec=m.specification,_e.value=`${m.name}`})},null,8,["grid-data","loading","value-display"])]}),_:1},512),o(a,{label:"Qty",name:"qty",ref:"qty"},{default:l(()=>[o(ue,{value:y.qty,"onUpdate:value":e[21]||(e[21]=t=>y.qty=t),min:0,formatter:t=>`${t}`.replace(/\B(?=(\d{3})+(?!\d))/g,"."),parser:t=>t.replace(/\$\s?|(\.*)/g,"")},null,8,["value","formatter","parser"])]),_:1},512),o(a,{label:"Catatan",name:"note",ref:"note"},{default:l(()=>[o(V,{value:y.note,"onUpdate:value":e[22]||(e[22]=t=>y.note=t)},null,8,["value"])]),_:1},512)]),_:1},8,["model"])]),_:1},8,["visible"]),o(X,{visible:r(Ne),"onUpdate:visible":e[32]||(e[32]=t=>ee(Ne)?Ne.value=t:null),title:"Tambah Deskripsi Pekerjaan","cancel-text":"Tutup",onOk:e[33]||(e[33]=t=>r(x)(re.value,Be))},{default:l(()=>[o(G,{ref_key:"formRefJobDesc",ref:re,model:p,rules:Xe,"label-col":{style:{width:"100px"}},colon:!1,"label-align":"left",onFinish:e[31]||(e[31]=t=>r(x)(re.value,Be))},{default:l(()=>[o(a,{label:"Judul",name:"title",ref:"title"},{default:l(()=>[o(W,{value:p.title,"onUpdate:value":e[26]||(e[26]=t=>p.title=t)},null,8,["value"])]),_:1},512),o(a,{label:"Spesifikasi",name:"specification",ref:"specification"},{default:l(()=>[o(W,{value:p.specification,"onUpdate:value":e[27]||(e[27]=t=>p.specification=t)},null,8,["value"])]),_:1},512),o(a,{label:"Qty",name:"qty",ref:"qty"},{default:l(()=>[o(ue,{value:p.qty,"onUpdate:value":e[28]||(e[28]=t=>p.qty=t),min:0,formatter:t=>`${t}`.replace(/\B(?=(\d{3})+(?!\d))/g,"."),parser:t=>t.replace(/\$\s?|(\.*)/g,"")},null,8,["value","formatter","parser"])]),_:1},512),o(a,{label:"Satuan",name:"unit_id",ref:"unit_id"},{default:l(()=>{var t;return[o(Z,{"column-defs":E,"grid-data":((t=U.value)==null?void 0:t.units)??[],loading:r(L),value:void 0,"value-display":ve.value,onChange:e[29]||(e[29]=m=>{p.unit_id=m.id,p.unit_name=m.name,ve.value=`${m.code} - ${m.name}`})},null,8,["grid-data","loading","value-display"])]}),_:1},512),o(a,{label:"Catatan",name:"note",ref:"note"},{default:l(()=>[o(V,{value:p.note,"onUpdate:value":e[30]||(e[30]=t=>p.note=t)},null,8,["value"])]),_:1},512)]),_:1},8,["model"])]),_:1},8,["visible"]),o(X,{visible:r(xe),"onUpdate:visible":e[34]||(e[34]=t=>ee(xe)?xe.value=t:null),title:ye.value,width:"80vw",centered:"","body-style":{height:"80vh"}},{footer:l(()=>[o(N,{key:"back",onClick:r(lt),type:"primary"},{default:l(()=>[b("Kembali")]),_:1},8,["onClick"])]),default:l(()=>[u("object",{data:ge.value,width:"100%",height:"100%"},null,8,Xt)]),_:1},8,["visible","title"])])}}}),Zt=Re({__name:"DataTable",props:{idx:null},emits:["rowClick"],setup(_,{emit:s}){const c=_,$=F({value:[{field:"survey_report_number",headerName:"No. Laporan Survey",width:150,flex:0,pinned:"left"},{field:"worklist.worklist_number",headerName:"No. Projek",width:120,flex:0},{field:"survey_report_date",headerName:"Tgl Laporan Survey",...Me},{field:"created_at",headerName:"Diinput Tgl",...Me},{field:"updated_at",headerName:"Diupdate Tgl",...Me},{field:"created_by_user_username",headerName:"Diinput Oleh",flex:0,width:120},{field:"updated_by_user_username",headerName:"Diupdate Oleh",flex:0,width:120}]}),M=F({value:null}),{run:A,response:P,loading:H}=te();async function k(){var w;try{await A(T.list()),(w=P.value)!=null&&w.success&&(M.value=P.value.data)}catch{}}function R(w){s("rowClick",w)}return Ee(()=>{k()}),He(()=>c.idx,()=>{k()}),(w,E)=>(Q(),pe("div",null,[o(ae,{"row-data":M.value,"column-defs":$.value,loading:r(H),onRowClick:R},null,8,["row-data","column-defs","loading"])]))}}),ea=u("span",null,[u("i",{class:"fe fe-edit-2 me-2"}),b(" Input ")],-1),ta=u("span",null,[u("i",{class:"fe fe-search me-2"}),b(" Browse ")],-1),aa=u("i",{class:"fe fe-refresh-cw me-2"},null,-1),Ia=Re({__name:"index",setup(_){const s=d("1"),c=d(),$=d(!1),M=d(1);function A(k){s.value="1",c.value={...k},$.value=!0}function P(){$.value=!1}function H(k){M.value+=1,k!==void 0&&($.value=k)}return(k,R)=>{const w=Nt,E=Ae,S=Dt;return Q(),pe("div",null,[o(S,{class:"input-browse-tab",activeKey:s.value,"onUpdate:activeKey":R[1]||(R[1]=O=>s.value=O),animated:""},gt({default:l(()=>[o(w,{key:"1"},{tab:l(()=>[ea]),default:l(()=>[o(Yt,{"form-data":c.value,"edit-mode":$.value,onCancelEdit:P,onOnSuccess:H},null,8,["form-data","edit-mode"])]),_:1}),o(w,{key:"2"},{tab:l(()=>[ta]),default:l(()=>[o(Zt,{idx:M.value,onRowClick:A},null,8,["idx"])]),_:1})]),_:2},[s.value==="2"?{name:"rightExtra",fn:l(()=>[o(E,{size:"small",class:"mt-3",onClick:R[0]||(R[0]=O=>M.value+=1)},{default:l(()=>[aa,b(" Refresh Data ")]),_:1})]),key:"0"}:void 0]),1032,["activeKey"])])}}});export{Ia as default};
