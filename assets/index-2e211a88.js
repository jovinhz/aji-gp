var oe=Object.defineProperty;var se=(n,i,s)=>i in n?oe(n,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[i]=s;var j=(n,i,s)=>(se(n,typeof i!="symbol"?i+"":i,s),s);import{B as L}from"./index-00a8ffd2.js";/* empty css              *//* empty css              */import"./index-97222043.js";import{S as ne,_ as ie}from"./index-0523e8d4.js";/* empty css              *//* empty css              */import{H as le,u as S}from"./HttpClient-64290c27.js";import{o as V,a as q}from"./index-f9e6a35e.js";import{_ as re}from"./InputDropdown.vue_vue_type_script_setup_true_lang-55961ea3.js";import{_ as de}from"./Password-6dae3765.js";import"./index-ddcd02d5.js";import{d as E,r as v,O as B,w as Y,a as z,e as c,a7 as N,ac as d,f as C,g as o,a9 as _,c as t,u as y,ae as P,aa as W,ak as ue}from"./_plugin-vue_export-helper-50c92bea.js";import{M as me}from"./Modal-5bd2bcee.js";import{_ as ce}from"./index-f9be8515.js";import{I as fe}from"./Input-97482d20.js";import{_ as _e,F as pe}from"./Form-2caee2e0.js";import{_ as we}from"./index-8dc18fc1.js";import{_ as ve}from"./AgGrid.vue_vue_type_script_setup_true_lang-d3dbb188.js";import{T as ge,_ as he}from"./TabPane-053c7c75.js";import"./pickAttrs-44b65975.js";import"./useMemo-6199d1b3.js";import"./useRefs-9f478e5b.js";import"./DownOutlined-dca0ecad.js";import"./CheckOutlined-e3d2d87e.js";import"./SearchOutlined-123fd7b0.js";import"./dayjs.min-2389bdff.js";import"./EyeOutlined-369659f4.js";import"./debounce-52dc8683.js";import"./isSymbol-5a6ec0b4.js";import"./TextArea-afcadf10.js";import"./_flatRest-6ef3b5aa.js";class D{static list(){return this.HttpClient.axiosInstance.get("/users")}static create(i){return this.HttpClient.withOptions({showSuccessFeedback:!0,successFeedbackMessage:"User berhasil ditambah"}).axiosInstance.post("/users",i)}static update(i,s){return this.HttpClient.withOptions({showSuccessFeedback:!0,successFeedbackMessage:"User berhasil diupdate"}).axiosInstance.put(`/users/${i}`,s)}static formOptions(){return this.HttpClient.axiosInstance.get("/users/form_options")}}j(D,"HttpClient",new le);const ye={class:"card card-custom card-dense"},be={class:"card-header"},ke={class:"card-title w-100 d-flex justify-content-between"},De=d("h4",{class:"card-label"},"Form User",-1),xe={class:"card-body"},Me={class:"row"},Ce={class:"col-lg-6"},Pe=d("i",{class:"fe fe-save me-2"},null,-1),Ne={key:0},$e=d("h6",{class:"mb-3"},"Ubah Password",-1),Fe=d("i",{class:"fe fe-save me-2"},null,-1),Oe=d("span",null,"Simpan",-1),Se={key:0,class:"col-lg-6 ps-5"},Ue=E({__name:"Form",props:{formData:null,editMode:{type:Boolean}},emits:["cancelEdit","onSuccess"],setup(n,{emit:i}){const s=n,p=[{field:"employee_id_number",headerName:"NIP"},{field:"full_name",headerName:"Nama"}],m=v(""),b=v(),f=v(),k=v(),e=B({is_allow_to_login:!0}),w={username:[{required:!0,message:"Username wajib diisi",trigger:"change"}],staff_id:[{required:!0,message:"Pegawai wajib dipilih",trigger:"change"}]},u={password:[{required:!0,message:"Password wajib diisi",trigger:"change"}],password_confirmation:[{required:!0,message:"Konfirmasi password wajib diisi",trigger:"change"},{validator:async(l,a)=>a!==e.password?Promise.reject("Password dan Konfirmasi password harus sama."):Promise.resolve()}]},{run:g,loading:$,response:x}=S(),{run:A,loading:G,response:H}=S(),{run:Re,loading:J,response:Te}=S();async function Q(){var l,a,M;try{s.editMode?await g(D.update((l=s.formData)==null?void 0:l.id,{staff_id:e.staff_id,is_allow_to_login:e.is_allow_to_login})):(await g(D.create({username:e.username,password:e.password,password_confirmation:e.password_confirmation,staff_id:e.staff_id,is_allow_to_login:e.is_allow_to_login})),(a=x.value)!=null&&a.success&&I()),(M=x.value)!=null&&M.success&&i("onSuccess")}catch{}}async function X(){var l;try{await g(D.update((l=s.formData)==null?void 0:l.id,{password:e.password,password_confirmation:e.password_confirmation}))}catch{}}async function Z(){}function I(){var l;if(s.editMode){for(const a in e)e[a]=void 0;e.is_allow_to_login=!0,i("cancelEdit")}else(l=f.value)==null||l.resetFields();m.value=""}function ee(){me.confirm({title:"Konfirmasi Hapus User",content:"Apakah kamu sudah yakin ingin menghapus data [Edit Here]",cancelText:"Batal",onOk:Z})}return Y(()=>s.formData,()=>{var l;s.formData&&((l=f.value)==null||l.clearValidate(),e.username=s.formData.username,e.staff_id=s.formData.staff.id,e.is_allow_to_login=s.formData.is_allow_to_login,m.value=`${s.formData.staff.employee_id_number} - ${s.formData.staff.full_name}`)}),z(async()=>{var l;try{await A(D.formOptions()),(l=H.value)!=null&&l.success&&(b.value=H.value.data)}catch{}}),(l,a)=>{const M=ce,R=fe,h=_e,F=de,T=ne,ae=ie,O=L,K=pe,te=we;return c(),N("div",ye,[d("div",be,[d("div",ke,[De,n.editMode?(c(),C(M,{key:0,color:"orange"},{default:o(()=>[_("Mode Edit")]),_:1})):(c(),C(M,{key:1,color:"cyan"},{default:o(()=>[_("Mode Input")]),_:1}))])]),d("div",xe,[d("div",Me,[d("div",Ce,[t(K,{ref_key:"formRef",ref:f,model:e,rules:{...w,...!n.editMode&&u},"label-col":{style:{width:"220px"}},colon:!1,"label-align":"left",onFinish:a[5]||(a[5]=r=>y(V)(f.value,Q))},{default:o(()=>[t(h,{label:"Username",name:"username",ref:"username"},{default:o(()=>[t(R,{value:e.username,"onUpdate:value":a[0]||(a[0]=r=>e.username=r),valueModifiers:{trim:!0},disabled:n.editMode},null,8,["value","disabled"])]),_:1},512),t(h,{label:"Pegawai",name:"staff_id",ref:"staff_id"},{default:o(()=>{var r;return[t(re,{"column-defs":p,"grid-data":((r=b.value)==null?void 0:r.staffs)??[],loading:y(G),value:void 0,"value-display":m.value,onChange:a[1]||(a[1]=U=>{e.staff_id=U.id,m.value=`${U.employee_id_number} - ${U.full_name}`})},null,8,["grid-data","loading","value-display"])]}),_:1},512),n.editMode?P("",!0):(c(),C(h,{key:0,label:"Password",name:"password",ref:"password"},{default:o(()=>[t(F,{value:e.password,"onUpdate:value":a[2]||(a[2]=r=>e.password=r)},null,8,["value"])]),_:1},512)),n.editMode?P("",!0):(c(),C(h,{key:1,label:"Konfirmasi Password",name:"password_confirmation",ref:"password_confirmation"},{default:o(()=>[t(F,{value:e.password_confirmation,"onUpdate:value":a[3]||(a[3]=r=>e.password_confirmation=r)},null,8,["value"])]),_:1},512)),t(h,{label:"Boleh Login",name:"is_allow_to_login",ref:"is_allow_to_login"},{default:o(()=>[t(ae,{value:+(e.is_allow_to_login??!0),onChange:a[4]||(a[4]=r=>e.is_allow_to_login=!!r)},{default:o(()=>[t(T,{value:1},{default:o(()=>[_(" Ya ")]),_:1}),t(T,{value:0},{default:o(()=>[_(" Tidak ")]),_:1})]),_:1},8,["value"])]),_:1},512),t(O,{type:"primary","html-type":"submit",loading:y($)},{default:o(()=>[Pe,d("span",null,W(n.editMode?"Edit":"Simpan"),1)]),_:1},8,["loading"]),t(O,{class:"mx-3",onClick:I},{default:o(()=>[_(W(n.editMode?"Batal Edit":"Bersihkan"),1)]),_:1}),n.editMode?(c(),C(O,{key:2,danger:"",type:"primary",onClick:ee,loading:y(J)},{default:o(()=>[_(" Hapus ")]),_:1},8,["loading"])):P("",!0)]),_:1},8,["model","rules"]),t(te),n.editMode?(c(),N("div",Ne,[$e,t(K,{ref_key:"formRefPassword",ref:k,model:e,rules:u,colon:!1,layout:"vertical",onFinish:a[8]||(a[8]=r=>y(V)(k.value,X))},{default:o(()=>[t(h,{label:"Password",name:"password",ref:"password"},{default:o(()=>[t(F,{value:e.password,"onUpdate:value":a[6]||(a[6]=r=>e.password=r)},null,8,["value"])]),_:1},512),t(h,{label:"Konfirmasi Password",name:"password_confirmation",ref:"password_confirmation"},{default:o(()=>[t(F,{value:e.password_confirmation,"onUpdate:value":a[7]||(a[7]=r=>e.password_confirmation=r)},null,8,["value"])]),_:1},512),t(O,{type:"primary","html-type":"submit",loading:y($)},{default:o(()=>[Fe,Oe]),_:1},8,["loading"])]),_:1},8,["model"])])):P("",!0)]),n.editMode?(c(),N("div",Se)):P("",!0)])])])}}}),Be=E({__name:"DataTable",props:{idx:null},emits:["rowClick"],setup(n,{emit:i}){const s=n,p=B({value:[{field:"username",headerName:"Username",pinned:"left",minWidth:100},{field:"staff.employee_id_number",headerName:"NIP Pegawai",minWidth:120},{field:"staff.full_name",headerName:"Nama Pegawai",minWidth:100},{field:"is_allow_to_login",headerName:"Bisa Login",flex:0,width:100,valueFormatter:u=>u.value?"Ya":"Tidak"},{field:"created_at",headerName:"Diinput Tgl",...q},{field:"updated_at",headerName:"Diupdate Tgl",...q},{field:"created_by_user_username",headerName:"Diinput Oleh",flex:0,width:120},{field:"updated_by_user_username",headerName:"Diupdate Oleh",flex:0,width:120}]}),m=B({value:null}),{run:b,response:f,loading:k}=S();async function e(){var u;try{await b(D.list()),(u=f.value)!=null&&u.success&&(m.value=f.value.data)}catch{}}function w(u){i("rowClick",u)}return z(()=>{e()}),Y(()=>s.idx,()=>{e()}),(u,g)=>(c(),N("div",null,[t(ve,{"row-data":m.value,"column-defs":p.value,loading:y(k),onRowClick:w},null,8,["row-data","column-defs","loading"])]))}}),Ee=d("span",null,[d("i",{class:"fe fe-edit-2 me-2"}),_(" Input ")],-1),He=d("span",null,[d("i",{class:"fe fe-search me-2"}),_(" Browse ")],-1),Ie=d("i",{class:"fe fe-refresh-cw me-2"},null,-1),ha=E({__name:"index",setup(n){const i=v("1"),s=v(),p=v(!1),m=v(1);function b(e){i.value="1",s.value={...e},p.value=!0}function f(){p.value=!1}function k(e){m.value+=1,e!==void 0&&(p.value=e)}return(e,w)=>{const u=he,g=L,$=ge;return c(),N("div",null,[t($,{class:"input-browse-tab",activeKey:i.value,"onUpdate:activeKey":w[1]||(w[1]=x=>i.value=x),animated:""},ue({default:o(()=>[t(u,{key:"1"},{tab:o(()=>[Ee]),default:o(()=>[t(Ue,{"form-data":s.value,"edit-mode":p.value,onCancelEdit:f,onOnSuccess:k},null,8,["form-data","edit-mode"])]),_:1}),t(u,{key:"2"},{tab:o(()=>[He]),default:o(()=>[t(Be,{idx:m.value,onRowClick:b},null,8,["idx"])]),_:1})]),_:2},[i.value==="2"?{name:"rightExtra",fn:o(()=>[t(g,{size:"small",class:"mt-3",onClick:w[0]||(w[0]=x=>m.value+=1)},{default:o(()=>[Ie,_(" Refresh Data ")]),_:1})]),key:"0"}:void 0]),1032,["activeKey"])])}}});export{ha as default};
