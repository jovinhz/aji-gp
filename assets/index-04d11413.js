var Xe=Object.defineProperty;var Ze=(_,t,a)=>t in _?Xe(_,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):_[t]=a;var oe=(_,t,a)=>(Ze(_,typeof t!="symbol"?t+"":t,a),a);import{B as ue,k as Re}from"./index-153eefc2.js";import{_ as be}from"./AgGrid.vuevuetypescriptsetuptruelang-ab13ecb9.js";import{o as ie,r as Ae,a as Z,b as Me,t as He}from"./index-8f77c718.js";import"./index-516ff1a6.js";import{S as Ne,_ as Oe}from"./index-6857fb4e.js";/* empty css              *//* empty css              */import{a as se,_ as fe,F as he,I as Pe}from"./Input-bda0940e.js";import{H as ve,u as M}from"./HttpClient-7fc79ba3.js";import{_ as ye}from"./InputDropdown.vuevuetypescriptsetuptruelang-59e1ec1d.js";import{u as et}from"./modal-e8545dd0.js";import{_ as Ie}from"./index-1776abb9.js";import{d as ne,O as V,r as p,a as de,e as F,a7 as H,c as e,u as h,ac as f,aa as Y,g as n,a9 as I,f as Ce,ae as qe,X as tt,w as Te,F as at,ab as st,ak as it}from"./plugin-vueexport-helper-0ef99882.js";import{M as Fe}from"./Modal-79dc3d32.js";import{D as $e}from"./dayjs-ec520615.js";import{_ as Be}from"./TextArea-17c42df7.js";import{_ as Ue}from"./UploadImage-10f49cd8.js";import{S as Ke}from"./Spin-f3560dc3.js";import{_ as Ee,T as Ge}from"./TabPane-9c8435b0.js";import"./pickAttrs-596f35c3.js";import"./useMemo-49158cc8.js";import"./DownOutlined-80526c88.js";import"./CheckOutlined-94b1a800.js";import"./SearchOutlined-1764655a.js";import"./index-0437c30a.js";import"./index-7cd2b3cb.js";import"./EyeOutlined-308ec9ea.js";import"./index-17b77924.js";class le{static list(){return this.HttpClient.axiosInstance.get("/worklists")}static create(t){return this.HttpClient.withOptions({showSuccessFeedback:!0,successFeedbackMessage:"Projek berhasil ditambah"}).axiosInstance.post("/worklists",t)}static update(t,a){return this.HttpClient.withOptions({showSuccessFeedback:!0,successFeedbackMessage:"Projek berhasil diupdate"}).axiosInstance.put(`/worklists/${t}`,a)}static formOptions(t){return this.HttpClient.axiosInstance.get("/worklists/form_options",{params:{customer_id:t}})}}oe(le,"HttpClient",new ve);class X{static list(t){return this.HttpClient.axiosInstance.get(`/worklists/${t}/worklist_workers`)}static create(t,a){return this.HttpClient.withOptions({showSuccessFeedback:!0,successFeedbackMessage:"Pekerja berhasil ditambah"}).axiosInstance.post(`/worklists/${t}/worklist_workers`,a)}static update(t,a,k){return this.HttpClient.withOptions({showSuccessFeedback:!0,successFeedbackMessage:"Pekerja berhasil diupdate"}).axiosInstance.put(`/worklists/${t}/worklist_workers/${a}`,k)}static delete(t,a){return this.HttpClient.withOptions({showSuccessFeedback:!0,successFeedbackMessage:"Pekerja berhasil dihapus"}).axiosInstance.delete(`/worklists/${t}/worklist_workers/${a}`)}static formOptions(){return this.HttpClient.axiosInstance.get("/worklists/current/worklist_workers/form_options")}static listAttendances(t,a){return this.HttpClient.axiosInstance.get(`/worklists/${t}/worklist_workers/${a}/worklist_worker_attendances`)}static createAttendances(t,a,k){return this.HttpClient.withOptions({showSuccessFeedback:!0,successFeedbackMessage:"Absensi berhasil ditambah"}).axiosInstance.post(`/worklists/${t}/worklist_workers/${a}/worklist_worker_attendances`,k)}static updateAttendances(t,a,k,x){return this.HttpClient.withOptions({showSuccessFeedback:!0,successFeedbackMessage:"Absensi berhasil diupdate"}).axiosInstance.put(`/worklists/${t}/worklist_workers/${a}/worklist_worker_attendances/${k}`,x)}}oe(X,"HttpClient",new ve);const nt={class:"card m-2 p-4"},ot={class:"mb-4"},rt={class:"row"},lt={class:"col-lg-6"},ut=f("i",{class:"fe fe-save me-2"},null,-1),dt={key:0,class:"card m-2 p-4"},ct={class:"d-flex justify-content-between mb-4"},mt=f("h5",{class:"m-0"},"Absensi",-1),_t=ne({__name:"PekerjaTab",props:{worklist_id:null},setup(_){const t=_,a=[{field:"worker.code",headerName:"Kode Pekerja",minWidth:120},{field:"worker.name",headerName:"Nama Pekerja",minWidth:120},{field:"salary",headerName:"Gaji",filter:"agNumberColumnFilter",type:"numericColumn",minWidth:120,valueGetter:l=>parseFloat(l.data.salary),valueFormatter:l=>Ae(l.value)},{field:"created_at",headerName:"Diinput Tgl",...Z},{field:"updated_at",headerName:"Diupdate Tgl",...Z},{field:"created_by_user_username",headerName:"Diinput Oleh",flex:0,width:120},{field:"updated_by_user_username",headerName:"Diupdate Oleh",flex:0,width:120}],k=[{field:"checkin_timestamp",headerName:"Tgl Check In",...Me},{field:"checkout_timestamp",headerName:"Tgl Check Out",...Me},{field:"working_hours",headerName:"Jam Kerja",filter:"agNumberColumnFilter",type:"numericColumn",width:150,flex:0,valueGetter:l=>parseFloat(l.data.working_hours).toPrecision(2)},{field:"salary_attendance",headerName:"Gaji",filter:"agNumberColumnFilter",type:"numericColumn",width:150,flex:0,valueGetter:l=>parseFloat(l.data.salary_attendance),valueFormatter:l=>Ae(l.value)},{field:"extratime_working_hours",headerName:"Lembur (Jam)",filter:"agNumberColumnFilter",type:"numericColumn",width:150,flex:0,valueGetter:l=>parseFloat(l.data.extratime_working_hours).toPrecision(2)},{field:"created_at",headerName:"Diinput Tgl",...Z},{field:"updated_at",headerName:"Diupdate Tgl",...Z},{field:"created_by_user_username",headerName:"Diinput Oleh",flex:0,width:120},{field:"updated_by_user_username",headerName:"Diupdate Oleh",flex:0,width:120}],x=[{field:"code",headerName:"Kode Pekerja"},{field:"name",headerName:"Nama Pekerja"}],w=V({value:null}),y=V({value:null}),i=p(!1),v=p(!1),g=p(),r=p(),S=p(),o=p(""),R=p(),q=V({}),z={worker_id:[{required:!0,message:"Pekerja wajib dipilih",trigger:"change"}],salary:[{required:!0,message:"Gaji wajib diisi",trigger:"change"}]},T=p(),C=V({}),$={checkin_timestamp:[{required:!0,message:"Waktu check-in wajib diisi",trigger:"change"}],checkout_timestamp:[{required:!0,message:"Waktu check-out wajib diisi",trigger:"change"}]},{run:s,response:P,loading:J}=M(),{run:E,response:D,loading:u}=M(),{run:N,response:A,loading:W}=M(),{run:Q,loading:O,response:L}=M(),{run:m,response:b,loading:B}=M(),{run:ee,response:d,loading:U}=M(),{visible:ce,open:K,close:me}=et();async function We(){var l,c,G;try{i.value?(await N(X.update(t.worklist_id,(l=g.value)==null?void 0:l.id,{worker_id:q.worker_id,salary:q.salary})),(c=A.value)!=null&&c.success&&ke()):(await N(X.create(t.worklist_id,{workers:[{worker_id:q.worker_id,salary:q.salary}]})),(G=A.value)!=null&&G.success&&(De(),ke()))}catch{}}async function ke(){var l;try{await s(X.list(t.worklist_id)),(l=P.value)!=null&&l.success&&(w.value=P.value.data)}catch{}}async function Ve(){var l;try{await E(X.formOptions()),(l=D.value)!=null&&l.success&&(S.value=D.value.data)}catch{}}function De(){var l;if(i.value)for(const c in q)q[c]=void 0;else(l=R.value)==null||l.resetFields();o.value="",i.value=!1,g.value=void 0}function Ye(l){var c;(c=R.value)==null||c.clearValidate(),q.worker_id=l.worker.id,q.salary=parseInt(l.salary,10),o.value=`${l.worker.code} - ${l.worker.name}`,i.value=!0,g.value=l,je(l.id)}async function Je(){var l,c;try{await Q(X.delete(t.worklist_id,(l=g.value)==null?void 0:l.id)),(c=L.value)!=null&&c.success&&(De(),ke())}catch{}}function ze(){Fe.confirm({title:"Konfirmasi Hapus Pekerja",content:"Apakah kamu sudah yakin ingin menghapus data "+o.value+" ?",cancelText:"Batal",onOk:Je})}async function je(l){var c;try{await m(X.listAttendances(t.worklist_id,l)),(c=b.value)!=null&&c.success&&(y.value=b.value.data)}catch{}}async function Se(){var l,c,G,_e,te,pe;try{v.value?(await ee(X.updateAttendances(t.worklist_id,(l=g.value)==null?void 0:l.id,(c=r.value)==null?void 0:c.id,{checkin_timestamp:C.checkin_timestamp+" +0700",checkout_timestamp:C.checkout_timestamp+" +0700"})),me()):await ee(X.createAttendances(t.worklist_id,(G=g.value)==null?void 0:G.id,{checkin_timestamp:C.checkin_timestamp+" +0700",checkout_timestamp:C.checkout_timestamp+" +0700"})),(_e=d.value)!=null&&_e.success&&((te=T.value)==null||te.resetFields(),je((pe=g.value)==null?void 0:pe.id))}catch{}}function Qe(l){v.value=!0,r.value=l,C.checkin_timestamp=se(r.value.checkin_timestamp).format("YYYY-MM-DD HH:mm:ss"),C.checkout_timestamp=se(r.value.checkout_timestamp).format("YYYY-MM-DD HH:mm:ss"),K()}return de(()=>{ke(),Ve()}),(l,c)=>{const G=fe,_e=Ie,te=ue,pe=he,xe=$e,Le=Fe;return F(),H("div",null,[e(be,{style:{height:"250px"},"row-data":w.value,"column-defs":a,loading:h(J),onRowClick:Ye},null,8,["row-data","column-defs","loading"]),f("div",nt,[f("h5",ot,Y(i.value?"Update":"Tambah")+" Pekerja",1),e(pe,{ref_key:"formRef",ref:R,model:q,rules:z,"label-col":{style:{width:"220px"}},colon:!1,"label-align":"left",onFinish:c[2]||(c[2]=j=>h(ie)(R.value,We))},{default:n(()=>[f("div",rt,[f("div",lt,[e(G,{label:"Pekerja",name:"worker_id",ref:"worker_id"},{default:n(()=>{var j;return[e(ye,{"column-defs":x,"grid-data":((j=S.value)==null?void 0:j.workers)??[],loading:h(u),value:void 0,"value-display":o.value,onChange:c[0]||(c[0]=ae=>{q.worker_id=ae.id,o.value=`${ae.code} - ${ae.name}`})},null,8,["grid-data","loading","value-display"])]}),_:1},512),e(G,{label:"Gaji",name:"salary",ref:"salary"},{default:n(()=>[e(_e,{value:q.salary,"onUpdate:value":c[1]||(c[1]=j=>q.salary=j),min:0,formatter:j=>`${j}`.replace(/\B(?=(\d{3})+(?!\d))/g,"."),parser:j=>j.replace(/\$\s?|(\.*)/g,"")},null,8,["value","formatter","parser"])]),_:1},512),e(te,{type:"primary","html-type":"submit",loading:h(W)},{default:n(()=>[ut,f("span",null,Y(i.value?"Edit":"Simpan"),1)]),_:1},8,["loading"]),e(te,{class:"mx-3",onClick:De},{default:n(()=>[I(Y(i.value?"Batal Edit":"Bersihkan"),1)]),_:1}),i.value?(F(),Ce(te,{key:0,danger:"",type:"primary",onClick:ze,loading:h(O)},{default:n(()=>[I(" Hapus ")]),_:1},8,["loading"])):qe("",!0)])])]),_:1},8,["model"])]),g.value?(F(),H("div",dt,[f("div",ct,[mt,e(te,{type:"primary",onClick:c[3]||(c[3]=()=>{var j;v.value=!1,C.checkin_timestamp=void 0,C.checkout_timestamp=void 0,(j=T.value)==null||j.clearValidate(),h(K)()})},{default:n(()=>[I(" Tambah ")]),_:1})]),e(be,{style:{height:"250px"},"row-data":y.value,"column-defs":k,loading:h(B),onRowClick:Qe},null,8,["row-data","column-defs","loading"])])):qe("",!0),e(Le,{visible:h(ce),"onUpdate:visible":c[7]||(c[7]=j=>tt(ce)?ce.value=j:null),title:v.value?"Update Absensi":"Tambah Absensi","cancel-text":"Tutup",onOk:c[8]||(c[8]=j=>h(ie)(T.value,Se))},{default:n(()=>[e(pe,{ref_key:"formRefAttendance",ref:T,model:C,rules:$,"label-col":{style:{width:"110px"}},colon:!1,"label-align":"left",onFinish:c[6]||(c[6]=j=>h(ie)(T.value,Se))},{default:n(()=>[e(G,{label:"Check In",ref:"checkin_timestamp",name:"checkin_timestamp"},{default:n(()=>[e(xe,{"show-time":"",value:C.checkin_timestamp?h(se)(C.checkin_timestamp):void 0,onChange:c[4]||(c[4]=(j,ae)=>C.checkin_timestamp=ae)},null,8,["value"])]),_:1},512),e(G,{label:"Check Out",ref:"checkin_timestamp",name:"checkin_timestamp"},{default:n(()=>[e(xe,{"show-time":"",value:C.checkout_timestamp?h(se)(C.checkout_timestamp):void 0,onChange:c[5]||(c[5]=(j,ae)=>C.checkout_timestamp=ae)},null,8,["value"])]),_:1},512)]),_:1},8,["model"])]),_:1},8,["visible","title"])])}}});class re{static list(t){return this.HttpClient.axiosInstance.get(`/worklists/${t}/worklist_products`)}static create(t,a){return this.HttpClient.withOptions({showSuccessFeedback:!0,successFeedbackMessage:"Produk berhasil ditambah"}).axiosInstance.post(`/worklists/${t}/worklist_products`,a)}static update(t,a,k){return this.HttpClient.withOptions({showSuccessFeedback:!0,successFeedbackMessage:"Produk berhasil diupdate"}).axiosInstance.put(`/worklists/${t}/worklist_products/${a}`,k)}static delete(t,a){return this.HttpClient.withOptions({showSuccessFeedback:!0,successFeedbackMessage:"Produk berhasil dihapus"}).axiosInstance.delete(`/worklists/${t}/worklist_products/${a}`)}static formOptions(){return this.HttpClient.axiosInstance.get("/worklists/current/worklist_products/form_options")}}oe(re,"HttpClient",new ve);const pt={class:"m-2 p-4 card"},ft={class:"mb-4"},ht={class:"row"},vt={class:"col-lg-6"},kt=f("i",{class:"fe fe-save me-2"},null,-1),wt=ne({__name:"ProdukTab",props:{worklist_id:null},setup(_){const t=_,a=[{field:"product.code",headerName:"Kode Produk",minWidth:120},{field:"product.name",headerName:"Nama Produk",minWidth:120},{field:"qty_request",headerName:"Qty Request",filter:"agNumberColumnFilter",type:"numericColumn",minWidth:120,valueGetter:m=>parseInt(m.data.qty_request,10),valueFormatter:m=>He(m.value)},{field:"qty_realization",headerName:"Qty Realisasi",filter:"agNumberColumnFilter",type:"numericColumn",minWidth:120,valueGetter:m=>m.data.qty_realization!==null?parseInt(m.data.qty_realization,10):null,valueFormatter:m=>He(m.value)},{field:"note",headerName:"Keterangan",minWidth:120},{field:"created_at",headerName:"Diinput Tgl",...Z},{field:"updated_at",headerName:"Diupdate Tgl",...Z},{field:"created_by_user_username",headerName:"Diinput Oleh",flex:0,width:120},{field:"updated_by_user_username",headerName:"Diupdate Oleh",flex:0,width:120}],k=[{field:"code",headerName:"Kode Produk"},{field:"name",headerName:"Nama Produk"}],x=V({value:null}),w=p(!1),y=p(),i=p(),v=p(""),g=p(),r=V({}),S={product_id:[{required:!0,message:"Pekerja wajib dipilih",trigger:"change"}],qty_request:[{required:!0,message:"Qty request wajib diisi",trigger:"change"}],note:[{required:!0,message:"Catatan wajib diisi",trigger:"change"}]},{run:o,response:R,loading:q}=M(),{run:z,response:T,loading:C}=M(),{run:$,response:s,loading:P}=M(),{run:J,loading:E,response:D}=M();async function u(){var m,b,B;try{w.value?(await $(re.update(t.worklist_id,(m=y.value)==null?void 0:m.id,{product_id:r.product_id,qty_request:r.qty_request,note:r.note})),(b=s.value)!=null&&b.success&&N()):(await $(re.create(t.worklist_id,{products:[{product_id:r.product_id,qty_request:r.qty_request,note:r.note}]})),(B=s.value)!=null&&B.success&&(W(),N()))}catch{}}async function N(){var m;try{await o(re.list(t.worklist_id)),(m=R.value)!=null&&m.success&&(x.value=R.value.data)}catch{}}async function A(){var m;try{await z(re.formOptions()),(m=T.value)!=null&&m.success&&(i.value=T.value.data)}catch{}}function W(){var m;if(w)for(const b in r)r[b]=void 0;else(m=g.value)==null||m.resetFields();v.value="",w.value=!1,y.value=void 0}function Q(m){var b;(b=g.value)==null||b.clearValidate(),r.product_id=m.product.id,r.qty_request=parseInt(m.qty_request,10),r.note=m.note,v.value=`${m.product.code} - ${m.product.name}`,w.value=!0,y.value=m}async function O(){var m,b;try{await J(re.delete(t.worklist_id,(m=y.value)==null?void 0:m.id)),(b=D.value)!=null&&b.success&&(W(),N())}catch{}}function L(){Fe.confirm({title:"Konfirmasi Hapus Pekerja",content:"Apakah kamu sudah yakin ingin menghapus data "+v.value+" ?",cancelText:"Batal",onOk:O})}return de(()=>{N(),A()}),(m,b)=>{const B=fe,ee=Ie,d=Be,U=ue,ce=he;return F(),H("div",null,[e(be,{style:{height:"250px"},"row-data":x.value,"column-defs":a,loading:h(q),onRowClick:Q},null,8,["row-data","column-defs","loading"]),f("div",pt,[f("h5",ft,Y(w.value?"Update":"Tambah")+" Produk",1),e(ce,{ref_key:"formRef",ref:g,model:r,rules:S,"label-col":{style:{width:"220px"}},colon:!1,"label-align":"left",onFinish:b[3]||(b[3]=K=>h(ie)(g.value,u))},{default:n(()=>[f("div",ht,[f("div",vt,[e(B,{label:"Produk",name:"product_id",ref:"product_id"},{default:n(()=>{var K;return[e(ye,{"column-defs":k,"grid-data":((K=i.value)==null?void 0:K.products)??[],loading:h(C),value:void 0,"value-display":v.value,onChange:b[0]||(b[0]=me=>{r.product_id=me.id,v.value=`${me.code} - ${me.name}`})},null,8,["grid-data","loading","value-display"])]}),_:1},512),e(B,{label:"Qty",name:"qty_request",ref:"qty_request"},{default:n(()=>[e(ee,{value:r.qty_request,"onUpdate:value":b[1]||(b[1]=K=>r.qty_request=K),min:0,formatter:K=>`${K}`.replace(/\B(?=(\d{3})+(?!\d))/g,"."),parser:K=>K.replace(/\$\s?|(\.*)/g,"")},null,8,["value","formatter","parser"])]),_:1},512),e(B,{label:"Catatan",name:"note",ref:"note"},{default:n(()=>[e(d,{value:r.note,"onUpdate:value":b[2]||(b[2]=K=>r.note=K)},null,8,["value"])]),_:1},512),e(U,{type:"primary","html-type":"submit",loading:h(P)},{default:n(()=>[kt,f("span",null,Y(w.value?"Edit":"Simpan"),1)]),_:1},8,["loading"]),e(U,{class:"mx-3",onClick:W},{default:n(()=>[I(Y(w.value?"Batal Edit":"Bersihkan"),1)]),_:1}),w.value?(F(),Ce(U,{key:0,danger:"",type:"primary",onClick:L,loading:h(E)},{default:n(()=>[I(" Hapus ")]),_:1},8,["loading"])):qe("",!0)])])]),_:1},8,["model"])])])}}});class we{static show(t){return this.HttpClient.withOptions({showSuccessFeedback:!1,showErrorFeedback:!1}).axiosInstance.get(`/worklists/${t}/worklist_purchase_requisition`)}static create(t,a){return this.HttpClient.withOptions({showSuccessFeedback:!0,successFeedbackMessage:"PR berhasil ditambah"}).axiosInstance.post(`/worklists/${t}/worklist_purchase_requisition`,a)}static update(t,a){return this.HttpClient.withOptions({showSuccessFeedback:!0,successFeedbackMessage:"PR berhasil diupdate"}).axiosInstance.put(`/worklists/${t}/worklist_purchase_requisition`,a)}}oe(we,"HttpClient",new ve);const gt={key:0,class:"p-4 text-center"},bt={key:1,class:"p-4"},yt={key:0,class:"text-center"},Ct={key:1},$t={class:"row"},Dt={class:"col-lg-6"},xt=f("i",{class:"fe fe-save me-2"},null,-1),qt=ne({__name:"PrTab",props:{worklist_id:null},setup(_){const t=_,a=p(!1),k=p(!1),x=p(!1),w=p(""),y=p(),i=V({}),v={purchase_requisition_number:[{required:!0,message:"No PR wajib diisi",trigger:"change"}],status_id:[{required:!0,message:"Status wajib dipilih",trigger:"change"}],purchase_requisition_date:[{required:!0,message:"Tgl PR wajib diisi",trigger:"change"}],attachment:[{required:!0,message:"Dokumen PR wajib diupload",trigger:"change"}]},{run:g,response:r,loading:S}=M(),{run:o,response:R,loading:q}=M();async function z(){var $;try{if(a.value){const s=new FormData;s.set("purchase_requisition_number",i.purchase_requisition_number),s.set("purchase_requisition_date",i.purchase_requisition_date),s.set("status_id",i.status_id.toString()),i.attachment!==w.value&&s.set("attachment",i.attachment),await o(we.update(t.worklist_id,s))}else{const s=new FormData;s.set("purchase_requisition_number",i.purchase_requisition_number),s.set("purchase_requisition_date",i.purchase_requisition_date),s.set("status_id",i.status_id.toString()),s.set("attachment",i.attachment),await o(we.create(t.worklist_id,s)),($=R.value)!=null&&$.success&&(a.value=!0,k.value=!1)}}catch{}}async function T(){var $,s;try{await g(we.show(t.worklist_id)),($=r.value)!=null&&$.success?(i.purchase_requisition_number=r.value.data.purchase_requisition_number,i.purchase_requisition_date=r.value.data.purchase_requisition_date,i.status_id=r.value.data.status_id,i.attachment=r.value.data.attachment_url,w.value=r.value.data.attachment_url,a.value=!0):((s=r.value)==null?void 0:s.status)===404&&(k.value=!0)}catch{}}function C($,s){var P;w.value=$,i.attachment=s,(P=y.value)==null||P.validateFields("attachment")}return de(()=>{T()}),($,s)=>{const P=Ke,J=Re,E=ue,D=Pe,u=fe,N=Ne,A=Oe,W=$e,Q=he;return F(),H("div",null,[h(S)?(F(),H("div",gt,[e(P)])):(F(),H("div",bt,[k.value&&!x.value?(F(),H("div",yt,[e(J,{description:"Belum ada PR"}),e(E,{type:"primary",onClick:s[0]||(s[0]=O=>x.value=!0)},{default:n(()=>[I(" Buat PR ")]),_:1})])):(F(),H("div",Ct,[e(Q,{ref_key:"formRef",ref:y,model:i,rules:v,"label-col":{style:{width:"220px"}},colon:!1,"label-align":"left",onFinish:s[4]||(s[4]=O=>h(ie)(y.value,z))},{default:n(()=>[f("div",$t,[f("div",Dt,[e(u,{label:"No PR",ref:"purchase_requisition_number",name:"purchase_requisition_number"},{default:n(()=>[e(D,{value:i.purchase_requisition_number,"onUpdate:value":s[1]||(s[1]=O=>i.purchase_requisition_number=O)},null,8,["value"])]),_:1},512),e(u,{label:"Status",ref:"status_id",name:"status_id"},{default:n(()=>[e(A,{value:i.status_id,"onUpdate:value":s[2]||(s[2]=O=>i.status_id=O)},{default:n(()=>[e(N,{value:1},{default:n(()=>[I(" Aktif ")]),_:1}),e(N,{value:2},{default:n(()=>[I(" Batal ")]),_:1})]),_:1},8,["value"])]),_:1},512),e(u,{label:"Tgl PR",name:"purchase_requisition_date",ref:"purchase_requisition_date"},{default:n(()=>[e(W,{value:i.purchase_requisition_date?h(se)(i.purchase_requisition_date):void 0,onChange:s[3]||(s[3]=(O,L)=>i.purchase_requisition_date=L)},null,8,["value"])]),_:1},512),e(u,{label:"Attachment",ref:"attachment",name:"attachment"},{default:n(()=>[e(Ue,{"img-url":w.value,onChange:C},null,8,["img-url"])]),_:1},512),e(E,{type:"primary","html-type":"submit",loading:h(q)},{default:n(()=>[xt,f("span",null,Y(a.value?"Edit":"Simpan"),1)]),_:1},8,["loading"])])])]),_:1},8,["model"])]))]))])}}});class ge{static show(t){return this.HttpClient.withOptions({showSuccessFeedback:!1,showErrorFeedback:!1}).axiosInstance.get(`/worklists/${t}/worklist_purchase_order`)}static create(t,a){return this.HttpClient.withOptions({showSuccessFeedback:!0,successFeedbackMessage:"PO berhasil ditambah"}).axiosInstance.post(`/worklists/${t}/worklist_purchase_order`,a)}static update(t,a){return this.HttpClient.withOptions({showSuccessFeedback:!0,successFeedbackMessage:"PO berhasil diupdate"}).axiosInstance.put(`/worklists/${t}/worklist_purchase_order`,a)}}oe(ge,"HttpClient",new ve);const Ft={key:0,class:"p-4 text-center"},Nt={key:1,class:"p-4"},Ot={key:0,class:"text-center"},Pt={key:1},jt={class:"row"},St={class:"col-lg-6"},At=f("i",{class:"fe fe-save me-2"},null,-1),Mt=ne({__name:"PoTab",props:{worklist_id:null},setup(_){const t=_,a=p(!1),k=p(!1),x=p(!1),w=p(""),y=p(),i=V({}),v={purchase_order_number:[{required:!0,message:"No PO wajib diisi",trigger:"change"}],status_id:[{required:!0,message:"Status wajib dipilih",trigger:"change"}],purchase_order_date:[{required:!0,message:"Tgl PO wajib diisi",trigger:"change"}],attachment:[{required:!0,message:"Dokumen PO wajib diupload",trigger:"change"}]},{run:g,response:r,loading:S}=M(),{run:o,response:R,loading:q}=M();async function z(){var $;try{if(a.value){const s=new FormData;s.set("purchase_order_number",i.purchase_order_number),s.set("purchase_order_date",i.purchase_order_date),s.set("status_id",i.status_id.toString()),i.attachment!==w.value&&s.set("attachment",i.attachment),await o(ge.update(t.worklist_id,s))}else{const s=new FormData;s.set("purchase_order_number",i.purchase_order_number),s.set("purchase_order_date",i.purchase_order_date),s.set("status_id",i.status_id.toString()),s.set("attachment",i.attachment),await o(ge.create(t.worklist_id,s)),($=R.value)!=null&&$.success&&(a.value=!0,k.value=!1)}}catch{}}async function T(){var $,s;try{await g(ge.show(t.worklist_id)),($=r.value)!=null&&$.success?(i.purchase_order_number=r.value.data.purchase_order_number,i.purchase_order_date=r.value.data.purchase_order_date,i.status_id=r.value.data.status_id,i.attachment=r.value.data.attachment_url,w.value=r.value.data.attachment_url,a.value=!0):((s=r.value)==null?void 0:s.status)===404&&(k.value=!0)}catch{}}function C($,s){var P;w.value=$,i.attachment=s,(P=y.value)==null||P.validateFields("attachment")}return de(()=>{T()}),($,s)=>{const P=Ke,J=Re,E=ue,D=Pe,u=fe,N=Ne,A=Oe,W=$e,Q=he;return F(),H("div",null,[h(S)?(F(),H("div",Ft,[e(P)])):(F(),H("div",Nt,[k.value&&!x.value?(F(),H("div",Ot,[e(J,{description:"Belum ada PO"}),e(E,{type:"primary",onClick:s[0]||(s[0]=O=>x.value=!0)},{default:n(()=>[I(" Buat PO ")]),_:1})])):(F(),H("div",Pt,[e(Q,{ref_key:"formRef",ref:y,model:i,rules:v,"label-col":{style:{width:"220px"}},colon:!1,"label-align":"left",onFinish:s[4]||(s[4]=O=>h(ie)(y.value,z))},{default:n(()=>[f("div",jt,[f("div",St,[e(u,{label:"No PO",ref:"purchase_order_number",name:"purchase_order_number"},{default:n(()=>[e(D,{value:i.purchase_order_number,"onUpdate:value":s[1]||(s[1]=O=>i.purchase_order_number=O)},null,8,["value"])]),_:1},512),e(u,{label:"Status",ref:"status_id",name:"status_id"},{default:n(()=>[e(A,{value:i.status_id,"onUpdate:value":s[2]||(s[2]=O=>i.status_id=O)},{default:n(()=>[e(N,{value:1},{default:n(()=>[I(" Aktif ")]),_:1}),e(N,{value:2},{default:n(()=>[I(" Batal ")]),_:1})]),_:1},8,["value"])]),_:1},512),e(u,{label:"Tgl PO",name:"purchase_order_date",ref:"purchase_order_date"},{default:n(()=>[e(W,{value:i.purchase_order_date?h(se)(i.purchase_order_date):void 0,onChange:s[3]||(s[3]=(O,L)=>i.purchase_order_date=L)},null,8,["value"])]),_:1},512),e(u,{label:"Attachment",ref:"attachment",name:"attachment"},{default:n(()=>[e(Ue,{"img-url":w.value,onChange:C},null,8,["img-url"])]),_:1},512),e(E,{type:"primary","html-type":"submit",loading:h(q)},{default:n(()=>[At,f("span",null,Y(a.value?"Edit":"Simpan"),1)]),_:1},8,["loading"])])])]),_:1},8,["model"])]))]))])}}}),Ht={class:"card card-custom card-dense"},Rt={class:"card-body"},It={class:"row"},Tt={class:"col-lg-6"},Bt=f("i",{class:"fe fe-save me-2"},null,-1),Ut=ne({__name:"Form",props:{formData:null,editMode:{type:Boolean}},emits:["cancelEdit","onSuccess"],setup(_,{emit:t}){const a=_,k=[{field:"code",headerName:"Kode Customer"},{field:"name",headerName:"Nama Customer"},{field:"customer_group.name",headerName:"Grup Customer"},{field:"address",headerName:"Alamat"},{field:"note",headerName:"Keterangan"}],x=[{field:"code",headerName:"Kode Unit"},{field:"name",headerName:"Nama Unit"}],w=p(0),y=p("1"),i=p(""),v=p(""),g=p(),r=p(),S=p(),o=V({}),R={customer_id:[{required:!0,message:"Customer wajib dipilih",trigger:"change"}],customer_unit_id:[{required:!0,message:"Customer unit wajib dipilih",trigger:"change"}],worklist_date:[{required:!0,message:"Tanggal projek wajib diisi",trigger:"change"}],type_id:[{required:!0,message:"Tipe projek wajib dipilih",trigger:"change"}],title:[{required:!0,message:"Judul projek wajib diisi",trigger:"change"}]},{run:q,loading:z,response:T}=M(),{run:C,loading:$,response:s}=M();async function P(){var D,u,N;try{a.editMode?await q(le.update((D=a.formData)==null?void 0:D.id,{customer_id:o.customer_id,customer_unit_id:o.customer_unit_id,title:o.title,type_id:o.type_id,worklist_date:o.worklist_date,note:o.note})):(await q(le.create({customer_id:o.customer_id,customer_unit_id:o.customer_unit_id,type_id:o.type_id,title:o.title,worklist_date:o.worklist_date,note:o.note})),(u=T.value)!=null&&u.success&&J()),(N=T.value)!=null&&N.success&&t("onSuccess")}catch{}}function J(){var D;if(a.editMode){for(const u in o)o[u]=void 0;t("cancelEdit")}else{(D=S.value)==null||D.resetFields();for(const u in o)o[u]=void 0}v.value="",i.value=""}async function E(){var D;try{await C(le.formOptions(o.customer_id)),(D=s.value)!=null&&D.success&&(r.value=s.value.data.customer_units)}catch{}}return Te(()=>a.formData,()=>{var D;a.formData&&(y.value="1",w.value+=1,(D=S.value)==null||D.clearValidate(),o.customer_id=a.formData.customer.id,o.customer_unit_id=a.formData.customer_unit.id,o.title=a.formData.title,o.note=a.formData.note,o.type_id=a.formData.type_id,o.worklist_date=a.formData.worklist_date,v.value=`${a.formData.customer_unit.code} - ${a.formData.customer_unit.name}`,i.value=`${a.formData.customer.code} - ${a.formData.customer.name}`,E())}),de(async()=>{var D;try{await C(le.formOptions()),(D=s.value)!=null&&D.success&&(g.value=s.value.data)}catch{}}),(D,u)=>{const N=Pe,A=fe,W=$e,Q=Ne,O=Oe,L=Be,m=ue,b=he,B=Ee,ee=Ge;return F(),H("div",Ht,[(F(),Ce(ee,{activeKey:y.value,"onUpdate:activeKey":u[7]||(u[7]=d=>y.value=d),type:"card","destroy-inactive-tab-pane":!1,key:`${w.value}`},{default:n(()=>[e(B,{key:"1",tab:"Projek"},{default:n(()=>[f("div",Rt,[e(b,{ref_key:"formRef",ref:S,model:o,rules:R,"label-col":{style:{width:"220px"}},colon:!1,"label-align":"left",onFinish:u[6]||(u[6]=d=>h(ie)(S.value,P))},{default:n(()=>[f("div",It,[f("div",Tt,[e(A,{label:"No Projek"},{default:n(()=>{var d;return[e(N,{value:_.editMode?(d=a.formData)==null?void 0:d.worklist_number:"",disabled:""},null,8,["value"])]}),_:1}),e(A,{label:"Customer",name:"customer_id",ref:"customer_id"},{default:n(()=>{var d;return[e(ye,{"column-defs":k,"grid-data":((d=g.value)==null?void 0:d.customers)??[],loading:h($),value:void 0,"value-display":i.value,onChange:u[0]||(u[0]=U=>{U.id!==o.customer_id&&(o.customer_unit_id=void 0,v.value=""),o.customer_id=U.id,i.value=`${U.code} - ${U.name}`,E()})},null,8,["grid-data","loading","value-display"])]}),_:1},512),e(A,{label:"Unit",name:"customer_unit_id",ref:"customer_unit_id"},{default:n(()=>[e(ye,{"column-defs":x,"grid-data":r.value??[],loading:r.value===null,value:void 0,"value-display":v.value,disabled:!o.customer_id,onChange:u[1]||(u[1]=d=>{o.customer_unit_id=d.id,v.value=`${d.code} - ${d.name}`})},null,8,["grid-data","loading","value-display","disabled"])]),_:1},512),e(A,{label:"Tgl Projek",name:"worklist_date",ref:"worklist_date"},{default:n(()=>[e(W,{value:o.worklist_date?h(se)(o.worklist_date):void 0,onChange:u[2]||(u[2]=(d,U)=>o.worklist_date=U)},null,8,["value"])]),_:1},512),e(A,{label:"Judul",name:"title",ref:"title"},{default:n(()=>[e(N,{value:o.title,"onUpdate:value":u[3]||(u[3]=d=>o.title=d)},null,8,["value"])]),_:1},512),e(A,{label:"Jenis Projek",name:"type_id",ref:"type_id"},{default:n(()=>[e(O,{value:o.type_id,"onUpdate:value":u[4]||(u[4]=d=>o.type_id=d)},{default:n(()=>{var d;return[(F(!0),H(at,null,st((d=g.value)==null?void 0:d.types,U=>(F(),Ce(Q,{value:U.id},{default:n(()=>[I(Y(U.title),1)]),_:2},1032,["value"]))),256))]}),_:1},8,["value"])]),_:1},512),e(A,{label:"Keterangan",name:"note",ref:"note"},{default:n(()=>[e(L,{value:o.note,"onUpdate:value":u[5]||(u[5]=d=>o.note=d)},null,8,["value"])]),_:1},512),e(m,{type:"primary","html-type":"submit",loading:h(z)},{default:n(()=>[Bt,f("span",null,Y(_.editMode?"Edit":"Simpan"),1)]),_:1},8,["loading"]),e(m,{class:"mx-3",onClick:J},{default:n(()=>[I(Y(_.editMode?"Batal Edit":"Bersihkan"),1)]),_:1})])])]),_:1},8,["model"])])]),_:1}),e(B,{disabled:!_.editMode,key:"2",tab:"Pekerja"},{default:n(()=>{var d;return[e(_t,{worklist_id:(d=_.formData)==null?void 0:d.id},null,8,["worklist_id"])]}),_:1},8,["disabled"]),e(B,{disabled:!_.editMode,key:"3",tab:"Produk & Material"},{default:n(()=>{var d;return[e(wt,{worklist_id:(d=_.formData)==null?void 0:d.id},null,8,["worklist_id"])]}),_:1},8,["disabled"]),e(B,{disabled:!_.editMode,key:"4",tab:"PR"},{default:n(()=>{var d;return[e(qt,{worklist_id:(d=_.formData)==null?void 0:d.id},null,8,["worklist_id"])]}),_:1},8,["disabled"]),e(B,{disabled:!_.editMode,key:"5",tab:"PO"},{default:n(()=>{var d;return[e(Mt,{worklist_id:(d=_.formData)==null?void 0:d.id},null,8,["worklist_id"])]}),_:1},8,["disabled"])]),_:1},8,["activeKey"]))])}}}),Kt=ne({__name:"DataTable",props:{idx:null},emits:["rowClick"],setup(_,{emit:t}){const a=_,k=V({value:[{field:"worklist_number",headerName:"No Projek",width:120,flex:0,pinned:"left"},{field:"title",headerName:"Judul",width:150,flex:0,autoHeight:!0,wrapText:!0},{field:"worklist_date_caption",headerName:"Tgl Projek",width:150,flex:0},{field:"customer.name",headerName:"Customer",width:150,flex:0},{field:"customer_unit.name",headerName:"Customer Unit",width:150,flex:0},{field:"type_caption",headerName:"Jenis Projek",width:110,flex:0},{field:"status_caption",headerName:"Status",width:150,flex:0},{field:"note",headerName:"Keterangan",width:150,flex:0},{field:"created_at",headerName:"Diinput Tgl",...Z},{field:"updated_at",headerName:"Diupdate Tgl",...Z},{field:"created_by_user_username",headerName:"Diinput Oleh",flex:0,width:120},{field:"updated_by_user_username",headerName:"Diupdate Oleh",flex:0,width:120}]}),x=V({value:null}),{run:w,response:y,loading:i}=M();async function v(){var r;try{await w(le.list()),(r=y.value)!=null&&r.success&&(x.value=y.value.data)}catch{}}function g(r){t("rowClick",r)}return de(()=>{v()}),Te(()=>a.idx,()=>{v()}),(r,S)=>(F(),H("div",null,[e(be,{"row-data":x.value,"column-defs":k.value,loading:h(i),onRowClick:g},null,8,["row-data","column-defs","loading"])]))}}),Et=f("span",null,[f("i",{class:"fe fe-edit-2 me-2"}),I(" Input ")],-1),Gt=f("span",null,[f("i",{class:"fe fe-search me-2"}),I(" Browse ")],-1),Wt=f("i",{class:"fe fe-refresh-cw me-2"},null,-1),ba=ne({__name:"index",setup(_){const t=p("1"),a=p(),k=p(!1),x=p(1);function w(v){t.value="1",a.value={...v},k.value=!0}function y(){k.value=!1}function i(v){x.value+=1,v!==void 0&&(k.value=v)}return(v,g)=>{const r=Ee,S=ue,o=Ge;return F(),H("div",null,[e(o,{class:"input-browse-tab",activeKey:t.value,"onUpdate:activeKey":g[1]||(g[1]=R=>t.value=R),animated:""},it({default:n(()=>[e(r,{key:"1"},{tab:n(()=>[Et]),default:n(()=>[e(Ut,{"form-data":a.value,"edit-mode":k.value,onCancelEdit:y,onOnSuccess:i},null,8,["form-data","edit-mode"])]),_:1}),e(r,{key:"2"},{tab:n(()=>[Gt]),default:n(()=>[e(Kt,{idx:x.value,onRowClick:w},null,8,["idx"])]),_:1})]),_:2},[t.value==="2"?{name:"rightExtra",fn:n(()=>[e(S,{size:"small",class:"mt-3",onClick:g[0]||(g[0]=R=>x.value+=1)},{default:n(()=>[Wt,I(" Refresh Data ")]),_:1})]),key:"0"}:void 0]),1032,["activeKey"])])}}});export{ba as default};
