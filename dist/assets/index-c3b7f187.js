import{B as W}from"./index-90b0ce28.js";/* empty css              *//* empty css              */import"./index-3c58d5d9.js";/* empty css              *//* empty css              */import{u as S}from"./HttpClient-042fc245.js";import{o as Q,a as R}from"./index-4821d3fa.js";import{_ as X}from"./InputDropdown.vuevuetypescriptsetuptruelang-fe3480c6.js";import{W as w}from"./WorkingToolService-d5130edd.js";import{d as F,r as v,O as E,w as I,a as U,e as D,a7 as T,ac as s,f as O,g as i,a9 as g,c as o,u as b,aa as V,ae as Y,ak as Z}from"./plugin-vueexport-helper-50c92bea.js";import{M as ee}from"./Modal-01017087.js";import{_ as ae}from"./index-4c8ffcc7.js";import{I as te}from"./Input-171d1ec7.js";import{_ as ne,F as ie}from"./Form-d1b3d589.js";import{_ as oe}from"./TextArea-bf7cacd1.js";import{_ as se}from"./AgGrid.vuevuetypescriptsetuptruelang-ab623fe9.js";import{T as le,_ as re}from"./TabPane-0e361ed2.js";import"./dayjs.min-78ae9b26.js";import"./pickAttrs-efa5632c.js";import"./_flatRest-ec52f6ad.js";import"./isSymbol-9d3d42e9.js";import"./debounce-59d4e949.js";import"./useRefs-c0f8034e.js";const ce={class:"card card-custom card-dense"},de={class:"card-header"},ue={class:"card-title w-100 d-flex justify-content-between"},me=s("h4",{class:"card-label"},"Form Master Alat Kerja",-1),fe={class:"card-body"},pe={class:"row"},_e={class:"col-lg-6"},ve=s("i",{class:"fe fe-save me-2"},null,-1),ge=F({__name:"Form",props:{formData:null,editMode:{type:Boolean}},emits:["cancelEdit","onSuccess"],setup(m,{emit:c}){const t=m,f=[{field:"code",headerName:"Kode Satuan"},{field:"name",headerName:"Nama Satuan"}],l=v(""),p=v(),e=E({}),k={name:[{required:!0,message:"Nama alat kerja wajib diisi",trigger:"change"}],unit_id:[{required:!0,message:"Satuan wajib dipilih",trigger:"change"}],specification:[{required:!0,message:"Spesifikasi wajib diisi",trigger:"change"}]},r=v(),{run:u,loading:d,response:h}=S(),{run:N,loading:x,response:K}=S(),{run:q,loading:A,response:H}=S();async function z(){var a,n,y;try{t.editMode?await u(w.update((a=t.formData)==null?void 0:a.id,{name:e.name,unit_id:e.unit_id,specification:e.specification})):(await u(w.create({name:e.name,unit_id:e.unit_id,specification:e.specification})),(n=h.value)!=null&&n.success&&C()),(y=h.value)!=null&&y.success&&c("onSuccess")}catch{}}async function G(){var a,n;try{await q(w.delete((a=t.formData)==null?void 0:a.id)),(n=H.value)!=null&&n.success&&(C(),c("onSuccess"))}catch{}}function C(){var a;if(t.editMode){for(const n in e)e[n]=void 0;l.value="",c("cancelEdit")}else(a=p.value)==null||a.resetFields(),l.value=""}function J(){var a;ee.confirm({title:"Konfirmasi Hapus Alat Kerja",content:`Apakah kamu sudah yakin ingin menghapus data ${(a=t.formData)==null?void 0:a.name} ?`,cancelText:"Batal",onOk:G})}return I(()=>t.formData,()=>{var a;t.formData&&((a=p.value)==null||a.clearValidate(),e.name=t.formData.name,e.specification=t.formData.specification,e.unit_id=t.formData.unit.id,l.value=`${t.formData.unit.code} - ${t.formData.unit.name}`)}),U(async()=>{var a;try{await N(w.formOptions()),(a=K.value)!=null&&a.success&&(r.value=K.value.data)}catch{}}),(a,n)=>{const y=ae,j=te,M=ne,L=oe,$=W,P=ie;return D(),T("div",ce,[s("div",de,[s("div",ue,[me,m.editMode?(D(),O(y,{key:0,color:"orange"},{default:i(()=>[g("Mode Edit")]),_:1})):(D(),O(y,{key:1,color:"cyan"},{default:i(()=>[g("Mode Input")]),_:1}))])]),s("div",fe,[o(P,{ref_key:"formRef",ref:p,model:e,rules:k,"label-col":{style:{width:"220px"}},colon:!1,"label-align":"left",onFinish:n[3]||(n[3]=_=>b(Q)(p.value,z))},{default:i(()=>[s("div",pe,[s("div",_e,[o(M,{label:"Nama",name:"name",ref:"name"},{default:i(()=>[o(j,{value:e.name,"onUpdate:value":n[0]||(n[0]=_=>e.name=_)},null,8,["value"])]),_:1},512),o(M,{label:"Satuan",name:"unit_id",ref:"unit_id"},{default:i(()=>{var _;return[o(X,{"column-defs":f,"grid-data":((_=r.value)==null?void 0:_.units)??[],loading:b(x),value:void 0,"value-display":l.value,onChange:n[1]||(n[1]=B=>{e.unit_id=B.id,l.value=`${B.code} - ${B.name}`})},null,8,["grid-data","loading","value-display"])]}),_:1},512),o(M,{label:"Spesifikasi",name:"specification",ref:"specification"},{default:i(()=>[o(L,{value:e.specification,"onUpdate:value":n[2]||(n[2]=_=>e.specification=_)},null,8,["value"])]),_:1},512),o($,{type:"primary","html-type":"submit",loading:b(d)},{default:i(()=>[ve,s("span",null,V(m.editMode?"Edit":"Simpan"),1)]),_:1},8,["loading"]),o($,{class:"mx-3",onClick:C},{default:i(()=>[g(V(m.editMode?"Batal Edit":"Bersihkan"),1)]),_:1}),m.editMode?(D(),O($,{key:0,danger:"",type:"primary",onClick:J,loading:b(A)},{default:i(()=>[g(" Hapus ")]),_:1},8,["loading"])):Y("",!0)])])]),_:1},8,["model"])])])}}}),he=F({__name:"DataTable",props:{idx:null},emits:["rowClick"],setup(m,{emit:c}){const t=m,f=E({value:[{field:"name",headerName:"Nama",pinned:"left",minWidth:120},{field:"specification",headerName:"Spesifikasi",minWidth:100},{field:"unit.name",headerName:"Satuan",minWidth:100},{field:"created_at",headerName:"Diinput Tgl",...R},{field:"updated_at",headerName:"Diupdate Tgl",...R},{field:"created_by_user_username",headerName:"Diinput Oleh",flex:0,width:120},{field:"updated_by_user_username",headerName:"Diupdate Oleh",flex:0,width:120}]}),l=E({value:null}),{run:p,response:e,loading:k}=S();async function r(){var d;try{await p(w.list()),(d=e.value)!=null&&d.success&&(l.value=e.value.data)}catch{}}function u(d){c("rowClick",d)}return U(()=>{r()}),I(()=>t.idx,()=>{r()}),(d,h)=>(D(),T("div",null,[o(se,{"row-data":l.value,"column-defs":f.value,loading:b(k),onRowClick:u},null,8,["row-data","column-defs","loading"])]))}}),ye=s("span",null,[s("i",{class:"fe fe-edit-2 me-2"}),g(" Input ")],-1),De=s("span",null,[s("i",{class:"fe fe-search me-2"}),g(" Browse ")],-1),ke=s("i",{class:"fe fe-refresh-cw me-2"},null,-1),Ge=F({__name:"index",setup(m){const c=v("1"),t=v(),f=v(!1),l=v(1);function p(r){c.value="1",t.value={...r},f.value=!0}function e(){f.value=!1}function k(r){l.value+=1,r!==void 0&&(f.value=r)}return(r,u)=>{const d=re,h=W,N=le;return D(),T("div",null,[o(N,{class:"input-browse-tab",activeKey:c.value,"onUpdate:activeKey":u[1]||(u[1]=x=>c.value=x),animated:""},Z({default:i(()=>[o(d,{key:"1"},{tab:i(()=>[ye]),default:i(()=>[o(ge,{"form-data":t.value,"edit-mode":f.value,onCancelEdit:e,onOnSuccess:k},null,8,["form-data","edit-mode"])]),_:1}),o(d,{key:"2"},{tab:i(()=>[De]),default:i(()=>[o(he,{idx:l.value,onRowClick:p},null,8,["idx"])]),_:1})]),_:2},[c.value==="2"?{name:"rightExtra",fn:i(()=>[o(h,{size:"small",class:"mt-3",onClick:u[0]||(u[0]=x=>l.value+=1)},{default:i(()=>[ke,g(" Refresh Data ")]),_:1})]),key:"0"}:void 0]),1032,["activeKey"])])}}});export{Ge as default};
