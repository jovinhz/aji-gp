var ae=Object.defineProperty;var oe=(d,a,o)=>a in d?ae(d,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):d[a]=o;var A=(d,a,o)=>(oe(d,typeof a!="symbol"?a+"":a,o),o);import{B as L}from"./index-153eefc2.js";import{_ as q}from"./AgGrid.vuevuetypescriptsetuptruelang-ab13ecb9.js";import{u as ne}from"./modal-e8545dd0.js";import{a as O,o as V}from"./index-8f77c718.js";import"./index-516ff1a6.js";import{_ as ie,S as se}from"./index-6857fb4e.js";import{H as le,u as y}from"./HttpClient-7fc79ba3.js";import{d as E,O as C,r as v,w as z,a as G,e as x,a7 as K,c as i,g as s,a9 as S,u as _,F as re,ab as de,X as ue,f as ce,aa as me,ak as fe,ac as N}from"./plugin-vueexport-helper-0ef99882.js";import{I as pe,_ as _e,F as ve}from"./Input-bda0940e.js";import{_ as be}from"./TextArea-17c42df7.js";import{M as ge}from"./Modal-79dc3d32.js";import{W as he}from"./WorkingToolService-97901f25.js";import{T as ke,_ as we}from"./TabPane-9c8435b0.js";import"./pickAttrs-596f35c3.js";import"./useMemo-49158cc8.js";import"./DownOutlined-80526c88.js";import"./CheckOutlined-94b1a800.js";import"./SearchOutlined-1764655a.js";class D{static list(a){return this.HttpClient.axiosInstance.get(`/working_tools/${a}/working_tool_items`)}static create(a,o){return this.HttpClient.withOptions({showSuccessFeedback:!0,successFeedbackMessage:"Stok Alat Kerja berhasil ditambah"}).axiosInstance.post(`/working_tools/${a}/working_tool_items`,o)}static update(a,o,u){return this.HttpClient.withOptions({showSuccessFeedback:!0,successFeedbackMessage:"Stok Alat Kerja berhasil diupdate"}).axiosInstance.put(`/working_tools/${a}/working_tool_items/${o}`,u)}static formOptions(){return this.HttpClient.axiosInstance.get("/working_tools/current/working_tool_items/form_options")}}A(D,"HttpClient",new le);const ye=E({__name:"Form",props:{formData:null,editMode:{type:Boolean}},emits:["cancelEdit","openEdit","onSuccess"],setup(d,{emit:a}){const o=d,u=C({value:[{field:"code",headerName:"Kode",pinned:"left",minWidth:100},{field:"condition_caption",headerName:"Kondisi",minWidth:100},{field:"brand",headerName:"Merk",minWidth:100},{field:"note",headerName:"Catatan",minWidth:100},{field:"created_at",headerName:"Diinput Tgl",...O},{field:"updated_at",headerName:"Diupdate Tgl",...O},{field:"created_by_user_username",headerName:"Diinput Oleh",flex:0,width:120},{field:"updated_by_user_username",headerName:"Diupdate Oleh",flex:0,width:120}]}),m=C({value:null}),b=v(),f=v(),c=v(),e=C({}),p={code:[{required:!0,message:"Kode stok alat kerja wajib diisi",trigger:"change"}],condition_id:[{required:!0,message:"Kondisi wajib dipilih",trigger:"change"}]},{run:r,loading:g,response:M}=y(),{run:F,loading:$,response:R}=y(),{run:X,loading:J,response:U}=y();y();const{open:W,close:Ne,visible:T}=ne();async function j(){var n,t,h,k;try{o.editMode?await r(D.update((n=o.formData)==null?void 0:n.id,f.value,{code:e.code.toUpperCase(),condition_id:e.condition_id,brand:e.brand,note:e.note})):(await r(D.create((t=o.formData)==null?void 0:t.id,{code:e.code.toUpperCase(),condition_id:e.condition_id,brand:e.brand,note:e.note})),(h=M.value)!=null&&h.success&&B()),(k=M.value)!=null&&k.success&&I()}catch{}}function B(){var n;if(o.editMode){for(const t in e)e[t]=void 0;a("cancelEdit")}else(n=c.value)==null||n.resetFields()}async function I(){var n,t;try{await X(D.list((n=o.formData)==null?void 0:n.id)),(t=U.value)!=null&&t.success&&(m.value=U.value.data)}catch{}}function P(n){e.code=n.code,e.brand=n.brand,e.condition_id=n.condition_id,e.note=n.note,f.value=n.id,a("openEdit"),W()}return z(()=>o.formData,()=>{var n;o.formData&&((n=c.value)==null||n.clearValidate(),I())}),G(async()=>{var n;try{await F(D.formOptions()),(n=R.value)!=null&&n.success&&(b.value=R.value.data)}catch{}}),(n,t)=>{const h=L,k=pe,w=_e,Q=se,Y=ie,Z=be,ee=ve,te=ge;return x(),K("div",null,[i(h,{type:"primary",class:"mb-3",onClick:_(W)},{default:s(()=>[S(" Tambah ")]),_:1},8,["onClick"]),i(q,{"row-data":m.value,"column-defs":u.value,loading:_(J),onRowClick:P},null,8,["row-data","column-defs","loading"]),i(te,{visible:_(T),"onUpdate:visible":t[5]||(t[5]=l=>ue(T)?T.value=l:null),title:d.editMode?"Update Stok Alat Kerja":"Input Stok Alat Kerja","confirm-loading":_(g),onOk:t[6]||(t[6]=l=>_(V)(c.value,j)),onCancel:t[7]||(t[7]=l=>B())},{default:s(()=>[i(ee,{ref_key:"formRef",ref:c,model:e,rules:p,"label-col":{style:{width:"120px"}},colon:!1,"label-align":"left",onFinish:t[4]||(t[4]=l=>_(V)(c.value,j))},{default:s(()=>[i(w,{label:"Kode",name:"code",ref:"code"},{default:s(()=>[i(k,{value:e.code,"onUpdate:value":t[0]||(t[0]=l=>e.code=l),valueModifiers:{trim:!0},style:{"text-transform":"uppercase"}},null,8,["value"])]),_:1},512),i(w,{label:"Kondisi",name:"condition_id",ref:"condition_id"},{default:s(()=>[i(Y,{value:e.condition_id,"onUpdate:value":t[1]||(t[1]=l=>e.condition_id=l)},{default:s(()=>{var l;return[(x(!0),K(re,null,de((l=b.value)==null?void 0:l.conditions,H=>(x(),ce(Q,{value:H.id},{default:s(()=>[S(me(H.title),1)]),_:2},1032,["value"]))),256))]}),_:1},8,["value"])]),_:1},512),i(w,{label:"Merk",name:"brand",ref:"brand"},{default:s(()=>[i(k,{value:e.brand,"onUpdate:value":t[2]||(t[2]=l=>e.brand=l),valueModifiers:{trim:!0}},null,8,["value"])]),_:1},512),i(w,{label:"Keterangan",name:"note",ref:"note"},{default:s(()=>[i(Z,{value:e.note,"onUpdate:value":t[3]||(t[3]=l=>e.note=l),valueModifiers:{trim:!0}},null,8,["value"])]),_:1},512)]),_:1},8,["model"])]),_:1},8,["visible","title","confirm-loading"])])}}}),De=E({__name:"DataTable",props:{idx:null},emits:["rowClick"],setup(d,{emit:a}){const o=d,u=C({value:[{field:"name",headerName:"Nama",pinned:"left",minWidth:100},{field:"specification",headerName:"Spesifikasi",minWidth:100},{field:"unit.name",headerName:"Satuan",minWidth:100},{field:"created_at",headerName:"Diinput Tgl",...O},{field:"updated_at",headerName:"Diupdate Tgl",...O},{field:"created_by_user_username",headerName:"Diinput Oleh",flex:0,width:120},{field:"updated_by_user_username",headerName:"Diupdate Oleh",flex:0,width:120}]}),m=C({value:null}),{run:b,response:f,loading:c}=y();async function e(){var r;try{await b(he.list()),(r=f.value)!=null&&r.success&&(m.value=f.value.data)}catch{}}function p(r){a("rowClick",r)}return G(()=>{e()}),z(()=>o.idx,()=>{e()}),(r,g)=>(x(),K("div",null,[i(q,{"row-data":m.value,"column-defs":u.value,loading:_(c),onRowClick:p},null,8,["row-data","column-defs","loading"])]))}}),Ce=N("span",null,[N("i",{class:"fe fe-search me-2"}),S(" Browse ")],-1),xe=N("span",null,[N("i",{class:"fe fe-eye me-2"}),S(" View Stok Alat Kerja ")],-1),Se=N("i",{class:"fe fe-refresh-cw me-2"},null,-1),Ge=E({__name:"index",setup(d){const a=v("2"),o=v(),u=v(!1),m=v(1);function b(p){a.value="1",o.value={...p},u.value=!1}function f(){u.value=!1}function c(){u.value=!0}function e(p){}return(p,r)=>{const g=we,M=L,F=ke;return x(),K("div",null,[i(F,{class:"input-browse-tab",activeKey:a.value,"onUpdate:activeKey":r[1]||(r[1]=$=>a.value=$),animated:""},fe({default:s(()=>[i(g,{key:"2"},{tab:s(()=>[Ce]),default:s(()=>[i(De,{idx:m.value,onRowClick:b},null,8,["idx"])]),_:1}),i(g,{key:"1","force-render":!0,disabled:""},{tab:s(()=>[xe]),default:s(()=>[i(ye,{"form-data":o.value,"edit-mode":u.value,onOpenEdit:c,onCancelEdit:f,onOnSuccess:e},null,8,["form-data","edit-mode"])]),_:1})]),_:2},[a.value==="2"?{name:"rightExtra",fn:s(()=>[i(M,{size:"small",class:"mt-3",onClick:r[0]||(r[0]=$=>m.value+=1)},{default:s(()=>[Se,S(" Refresh Data ")]),_:1})]),key:"0"}:void 0]),1032,["activeKey"])])}}});export{Ge as default};
