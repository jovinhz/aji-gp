import{B as I}from"./index-0bb8ea7a.js";import{_ as J}from"./AgGrid.vuevuetypescriptsetuptruelang-7e3c6181.js";import{o as L,a as R}from"./index-a69e05bf.js";import"./index-db653870.js";/* empty css              */import{u as x}from"./HttpClient-a8d470b1.js";import{_ as P}from"./InputDropdown.vuevuetypescriptsetuptruelang-94aa0dee.js";import{W as N}from"./WorkingToolService-f3ad13c7.js";import{d as O,r as v,Q as E,w as U,e as q,g as y,a7 as F,ac as i,j as B,k as a,a9 as g,b as t,u as b,aa as V,ae as X,ak as Y}from"./plugin-vueexport-helper-23a171d5.js";import{M as Z}from"./Modal-5e5e8906.js";import{_ as ee}from"./index-2b5a45ec.js";import{I as ae,_ as te,F as ne}from"./Input-6750102f.js";import{_ as oe}from"./TextArea-fa00ec12.js";import{T as ie,_ as se}from"./TabPane-6246fdd8.js";import"./pickAttrs-349b6a5f.js";const le={class:"card card-custom card-dense"},ce={class:"card-header"},de={class:"card-title w-100 d-flex justify-content-between"},re=i("h4",{class:"card-label"},"Form Master Alat Kerja",-1),ue={class:"card-body"},me={class:"row"},fe={class:"col-lg-6"},_e=i("i",{class:"fe fe-save me-2"},null,-1),pe=O({__name:"Form",props:{formData:null,editMode:{type:Boolean}},emits:["cancelEdit","onSuccess"],setup(m,{emit:r}){const n=m,f=[{field:"code",headerName:"Kode Satuan"},{field:"name",headerName:"Nama Satuan"}],s=v(""),_=v(),e=E({}),k={name:[{required:!0,message:"Nama alat kerja wajib diisi",trigger:"change"}],unit_id:[{required:!0,message:"Satuan wajib dipilih",trigger:"change"}],specification:[{required:!0,message:"Spesifikasi wajib diisi",trigger:"change"}]},c=v(),{run:u,loading:d,response:h}=x(),{run:S,loading:w,response:T}=x(),{run:ke,loading:A,response:De}=x();async function H(){var l,o,D;try{n.editMode?await u(N.update((l=n.formData)==null?void 0:l.id,{name:e.name,unit_id:e.unit_id,specification:e.specification})):(await u(N.create({name:e.name,unit_id:e.unit_id,specification:e.specification})),(o=h.value)!=null&&o.success&&j()),(D=h.value)!=null&&D.success&&r("onSuccess")}catch{}}async function W(){}function j(){var l;if(n.editMode){for(const o in e)e[o]=void 0;s.value="",r("cancelEdit")}else(l=_.value)==null||l.resetFields(),s.value=""}function z(){Z.confirm({title:"Konfirmasi Hapus Alat Kerja",content:"Apakah kamu sudah yakin ingin menghapus data [Edit Here]",cancelText:"Batal",onOk:W})}return U(()=>n.formData,()=>{var l;n.formData&&((l=_.value)==null||l.clearValidate(),e.name=n.formData.name,e.specification=n.formData.specification,e.unit_id=n.formData.unit.id,s.value=`${n.formData.unit.code} - ${n.formData.unit.name}`)}),q(async()=>{var l;try{await S(N.formOptions()),(l=T.value)!=null&&l.success&&(c.value=T.value.data)}catch{}}),(l,o)=>{const D=ee,K=ae,C=te,G=oe,M=I,Q=ne;return y(),F("div",le,[i("div",ce,[i("div",de,[re,m.editMode?(y(),B(D,{key:0,color:"orange"},{default:a(()=>[g("Mode Edit")]),_:1})):(y(),B(D,{key:1,color:"cyan"},{default:a(()=>[g("Mode Input")]),_:1}))])]),i("div",ue,[t(Q,{ref_key:"formRef",ref:_,model:e,rules:k,"label-col":{style:{width:"220px"}},colon:!1,"label-align":"left",onFinish:o[3]||(o[3]=p=>b(L)(_.value,H))},{default:a(()=>[i("div",me,[i("div",fe,[t(C,{label:"Nama",name:"name",ref:"name"},{default:a(()=>[t(K,{value:e.name,"onUpdate:value":o[0]||(o[0]=p=>e.name=p)},null,8,["value"])]),_:1},512),t(C,{label:"Satuan",name:"unit_id",ref:"unit_id"},{default:a(()=>{var p;return[t(P,{"column-defs":f,"grid-data":((p=c.value)==null?void 0:p.units)??[],loading:b(w),value:void 0,"value-display":s.value,onChange:o[1]||(o[1]=$=>{e.unit_id=$.id,s.value=`${$.code} - ${$.name}`})},null,8,["grid-data","loading","value-display"])]}),_:1},512),t(C,{label:"Spesifikasi",name:"specification",ref:"specification"},{default:a(()=>[t(G,{value:e.specification,"onUpdate:value":o[2]||(o[2]=p=>e.specification=p)},null,8,["value"])]),_:1},512),t(M,{type:"primary","html-type":"submit",loading:b(d)},{default:a(()=>[_e,i("span",null,V(m.editMode?"Edit":"Simpan"),1)]),_:1},8,["loading"]),t(M,{class:"mx-3",onClick:j},{default:a(()=>[g(V(m.editMode?"Batal Edit":"Bersihkan"),1)]),_:1}),m.editMode?(y(),B(M,{key:0,danger:"",type:"primary",onClick:z,loading:b(A)},{default:a(()=>[g(" Hapus ")]),_:1},8,["loading"])):X("",!0)])])]),_:1},8,["model"])])])}}}),ve=O({__name:"DataTable",props:{idx:null},emits:["rowClick"],setup(m,{emit:r}){const n=m,f=E({value:[{field:"name",headerName:"Nama",pinned:"left"},{field:"specification",headerName:"Spesifikasi"},{field:"unit.name",headerName:"Satuan"},{field:"created_at",headerName:"Diinput Tgl",...R},{field:"updated_at",headerName:"Diupdate Tgl",...R},{field:"created_by_user_username",headerName:"Diinput Oleh",flex:0,width:120},{field:"updated_by_user_username",headerName:"Diupdate Oleh",flex:0,width:120}]}),s=E({value:null}),{run:_,response:e,loading:k}=x();async function c(){var d;try{await _(N.list()),(d=e.value)!=null&&d.success&&(s.value=e.value.data)}catch{}}function u(d){r("rowClick",d)}return q(()=>{c()}),U(()=>n.idx,()=>{c()}),(d,h)=>(y(),F("div",null,[t(J,{"row-data":s.value,"column-defs":f.value,loading:b(k),onRowClick:u},null,8,["row-data","column-defs","loading"])]))}}),ge=i("span",null,[i("i",{class:"fe fe-edit-2 me-2"}),g(" Input ")],-1),he=i("span",null,[i("i",{class:"fe fe-search me-2"}),g(" Browse ")],-1),ye=i("i",{class:"fe fe-refresh-cw me-2"},null,-1),Re=O({__name:"index",setup(m){const r=v("1"),n=v(),f=v(!1),s=v(1);function _(c){r.value="1",n.value={...c},f.value=!0}function e(){f.value=!1}function k(c){s.value+=1,c!==void 0&&(f.value=c)}return(c,u)=>{const d=se,h=I,S=ie;return y(),F("div",null,[t(S,{class:"input-browse-tab",activeKey:r.value,"onUpdate:activeKey":u[1]||(u[1]=w=>r.value=w),animated:""},Y({default:a(()=>[t(d,{key:"1"},{tab:a(()=>[ge]),default:a(()=>[t(pe,{"form-data":n.value,"edit-mode":f.value,onCancelEdit:e,onOnSuccess:k},null,8,["form-data","edit-mode"])]),_:1}),t(d,{key:"2"},{tab:a(()=>[he]),default:a(()=>[t(ve,{idx:s.value,onRowClick:_},null,8,["idx"])]),_:1})]),_:2},[r.value==="2"?{name:"rightExtra",fn:a(()=>[t(h,{size:"small",class:"mt-3",onClick:u[0]||(u[0]=w=>s.value+=1)},{default:a(()=>[ye,g(" Refresh Data ")]),_:1})]),key:"0"}:void 0]),1032,["activeKey"])])}}});export{Re as default};
