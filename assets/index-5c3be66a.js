var me=Object.defineProperty;var pe=(i,a,t)=>a in i?me(i,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[a]=t;var q=(i,a,t)=>(pe(i,typeof a!="symbol"?a+"":a,t),t);import{B as L}from"./index-00a8ffd2.js";/* empty css              */import{u as fe}from"./modal-e4c7fed2.js";/* empty css              */import"./index-97222043.js";/* empty css              *//* empty css              */import{H as _e,u as D}from"./HttpClient-64290c27.js";import{o as H,a as $}from"./index-f9e6a35e.js";import{_ as Q}from"./AgGrid.vue_vue_type_script_setup_true_lang-d3dbb188.js";import{_ as ge}from"./InputDropdown.vue_vue_type_script_setup_true_lang-55961ea3.js";import{W as ve}from"./WorkerService-46e23d80.js";import{d as B,O as C,r as v,w as Y,a as Z,e as y,a7 as j,ac as l,f as R,g as r,a9 as g,c as o,u as c,ae as z,aa as X,X as ke,ak as he}from"./_plugin-vue_export-helper-50c92bea.js";import{M as J}from"./Modal-5bd2bcee.js";import{_ as we}from"./index-f9be8515.js";import{I as be}from"./Input-97482d20.js";import{_ as ye,F as Me}from"./Form-2caee2e0.js";import{T as De,_ as xe}from"./TabPane-053c7c75.js";import"./dayjs.min-2389bdff.js";import"./pickAttrs-44b65975.js";import"./_flatRest-6ef3b5aa.js";import"./isSymbol-5a6ec0b4.js";import"./debounce-52dc8683.js";import"./useRefs-9f478e5b.js";class x{static list(){return this.HttpClient.axiosInstance.get("/worker_groups")}static create(a){return this.HttpClient.withOptions({showSuccessFeedback:!0,successFeedbackMessage:"Grup Pekerja berhasil ditambah"}).axiosInstance.post("/worker_groups",a)}static update(a,t){return this.HttpClient.withOptions({showSuccessFeedback:!0,successFeedbackMessage:"Grup Pekerja berhasil diupdate"}).axiosInstance.put(`/worker_groups/${a}`,t)}static listMembers(a){return this.HttpClient.axiosInstance.get(`/worker_groups/${a}/worker_group_members`)}static addMember(a,t){return this.HttpClient.withOptions({showSuccessFeedback:!0,successFeedbackMessage:"Pekerja berhasil ditambah kedalam grup"}).axiosInstance.post(`/worker_groups/${a}/worker_group_members`,t)}static updateMember(a,t,m){return this.HttpClient.withOptions({showSuccessFeedback:!0,successFeedbackMessage:"Anggota Grup berhasil diupdate"}).axiosInstance.put(`/worker_groups/${a}/worker_group_members/${t}`,m)}}q(x,"HttpClient",new _e);const Ce={class:"card card-custom card-dense"},Ne={class:"card-header"},Fe={class:"card-title w-100 d-flex justify-content-between"},$e=l("h4",{class:"card-label"},"Form Grup Pekerja",-1),je={class:"card-body"},Oe={class:"row"},Pe={class:"col-lg-6"},Se={key:0,class:"col-12"},He={class:"row"},Re={class:"col-lg-6 mt-4"},Be=l("i",{class:"fe fe-save me-2"},null,-1),Ge=B({__name:"Form",props:{formData:null,editMode:{type:Boolean}},emits:["cancelEdit","onSuccess"],setup(i,{emit:a}){const t=i,m=[{field:"worker.code",headerName:"Kode Pekerja"},{field:"worker.name",headerName:"Nama Pekerja"},{field:"created_at",headerName:"Diinput Tgl",...$},{field:"updated_at",headerName:"Diupdate Tgl",...$},{field:"created_by_user_username",headerName:"Diinput Oleh",flex:0,width:120},{field:"updated_by_user_username",headerName:"Diupdate Oleh",flex:0,width:120}],f=[{field:"code",headerName:"Kode Pekerja"},{field:"name",headerName:"Nama Pekerja"},{field:"status_caption",headerName:"Status Pekerja"}],M=C({value:null}),k=v([]),_=v(""),d=v(),s=C({}),p={code:[{required:!0,message:"Kode grup pekerja wajib diisi",trigger:"change"}],group_name:[{required:!0,message:"Nama grup pekerja wajib diisi",trigger:"change"}]},h=v(),w=C({}),N={worker_id:[{required:!0,message:"Pekerja wajib dipilih",trigger:"change"}]},{run:G,loading:ee,response:T}=D(),{run:ae,loading:E,response:I}=D(),{run:te,loading:oe,response:K}=D(),{run:se,loading:We,response:re}=D(),{run:Ue,loading:ne,response:Ve}=D(),{visible:O,open:ie,close:Ae}=fe();async function le(){var n,e,b;try{t.editMode?await G(x.update((n=t.formData)==null?void 0:n.id,{group_name:s.group_name})):(await G(x.create({code:s.code.toUpperCase(),group_name:s.group_name})),(e=T.value)!=null&&e.success&&U()),(b=T.value)!=null&&b.success&&a("onSuccess")}catch{}}async function W(){var n,e;try{await se(x.addMember((n=t.formData)==null?void 0:n.id,{worker_id:w.worker_id})),(e=re.value)!=null&&e.success&&(V(),_.value="",w.worker_id=void 0)}catch{}}async function de(){}function U(){var n;if(t.editMode){for(const e in s)s[e]=void 0;a("cancelEdit")}else(n=d.value)==null||n.resetFields()}function ue(){J.confirm({title:"Konfirmasi Hapus Grup Pekerja",content:"Apakah kamu sudah yakin ingin menghapus data [Edit Here]",cancelText:"Batal",onOk:de})}async function V(){var n,e;try{await ae(x.listMembers((n=t.formData)==null?void 0:n.id)),(e=I.value)!=null&&e.success&&(M.value=I.value.data)}catch{}}return Y(()=>t.formData,()=>{var n;t.formData&&((n=d.value)==null||n.clearValidate(),s.code=t.formData.code,s.group_name=t.formData.group_name,_.value="",w.worker_id=void 0,V())}),Z(async()=>{var n;try{await te(ve.list()),(n=K.value)!=null&&n.success&&(k.value=K.value.data)}catch{}}),(n,e)=>{const b=we,P=be,S=ye,F=L,A=Me,ce=J;return y(),j("div",Ce,[l("div",Ne,[l("div",Fe,[$e,i.editMode?(y(),R(b,{key:0,color:"orange"},{default:r(()=>[g("Mode Edit")]),_:1})):(y(),R(b,{key:1,color:"cyan"},{default:r(()=>[g("Mode Input")]),_:1}))])]),l("div",je,[o(A,{ref_key:"formRef",ref:d,model:s,rules:p,"label-col":{style:{width:"220px"}},colon:!1,"label-align":"left",onFinish:e[3]||(e[3]=u=>c(H)(d.value,le))},{default:r(()=>[l("div",Oe,[l("div",Pe,[o(S,{label:"Kode Grup",name:"code",ref:"code"},{default:r(()=>[o(P,{value:s.code,"onUpdate:value":e[0]||(e[0]=u=>s.code=u),valueModifiers:{trim:!0},style:{"text-transform":"uppercase"},disabled:i.editMode},null,8,["value","disabled"])]),_:1},512),o(S,{label:"Nama Grup",name:"group_name",ref:"group_name"},{default:r(()=>[o(P,{value:s.group_name,"onUpdate:value":e[1]||(e[1]=u=>s.group_name=u)},null,8,["value"])]),_:1},512)]),i.editMode?(y(),j("div",Se,[o(F,{onClick:c(ie),type:"primary"},{default:r(()=>[g("Tambah Anggota")]),_:1},8,["onClick"]),o(Q,{class:"mt-3","row-data":M.value,"column-defs":m,loading:c(E),onRowClick:e[2]||(e[2]=()=>{})},null,8,["row-data","column-defs","loading"])])):z("",!0)]),l("div",He,[l("div",Re,[o(F,{type:"primary","html-type":"submit",loading:c(ee)},{default:r(()=>[Be,l("span",null,X(i.editMode?"Edit":"Simpan"),1)]),_:1},8,["loading"]),o(F,{class:"mx-3",onClick:U},{default:r(()=>[g(X(i.editMode?"Batal Edit":"Bersihkan"),1)]),_:1}),i.editMode?(y(),R(F,{key:0,danger:"",type:"primary",onClick:ue,loading:c(ne)},{default:r(()=>[g(" Hapus ")]),_:1},8,["loading"])):z("",!0)])])]),_:1},8,["model"])]),o(ce,{visible:c(O),"onUpdate:visible":e[6]||(e[6]=u=>ke(O)?O.value=u:null),title:"Form Anggota Grup",width:"50vw","confirm-loading":c(E),onOk:e[7]||(e[7]=u=>c(H)(h.value,W))},{default:r(()=>[o(A,{ref_key:"formRefMem",ref:h,model:w,rules:N,"label-col":{style:{width:"220px"}},colon:!1,"label-align":"left",onFinish:e[5]||(e[5]=u=>c(H)(h.value,W))},{default:r(()=>[o(S,{label:"Pekerja",name:"worker_id",ref:"worker_id"},{default:r(()=>[o(ge,{"column-defs":f,"grid-data":k.value,loading:c(oe),value:void 0,"value-display":_.value,"min-width":"100%",onChange:e[4]||(e[4]=u=>{w.worker_id=u.id,_.value=`${u.code} - ${u.name}`})},null,8,["grid-data","loading","value-display"])]),_:1},512)]),_:1},8,["model"])]),_:1},8,["visible","confirm-loading"])])}}}),Te=B({__name:"DataTable",props:{idx:null},emits:["rowClick"],setup(i,{emit:a}){const t=i,m=C({value:[{field:"code",headerName:"Kode Grup",flex:0,width:100},{field:"group_name",headerName:"Nama Grup",flex:0,width:150},{field:"created_at",headerName:"Diinput Tgl",...$},{field:"updated_at",headerName:"Diupdate Tgl",...$},{field:"created_by_user_username",headerName:"Diinput Oleh",flex:0,width:120},{field:"updated_by_user_username",headerName:"Diupdate Oleh",flex:0,width:120}]}),f=C({value:null}),{run:M,response:k,loading:_}=D();async function d(){var p;try{await M(x.list()),(p=k.value)!=null&&p.success&&(f.value=k.value.data)}catch{}}function s(p){a("rowClick",p)}return Z(()=>{d()}),Y(()=>t.idx,()=>{d()}),(p,h)=>(y(),j("div",null,[o(Q,{"row-data":f.value,"column-defs":m.value,loading:c(_),onRowClick:s},null,8,["row-data","column-defs","loading"])]))}}),Ee=l("span",null,[l("i",{class:"fe fe-edit-2 me-2"}),g(" Input ")],-1),Ie=l("span",null,[l("i",{class:"fe fe-search me-2"}),g(" Browse ")],-1),Ke=l("i",{class:"fe fe-refresh-cw me-2"},null,-1),va=B({__name:"index",setup(i){const a=v("1"),t=v(),m=v(!1),f=v(1);function M(d){a.value="1",t.value={...d},m.value=!0}function k(){m.value=!1}function _(d){f.value+=1,d!==void 0&&(m.value=d)}return(d,s)=>{const p=xe,h=L,w=De;return y(),j("div",null,[o(w,{class:"input-browse-tab",activeKey:a.value,"onUpdate:activeKey":s[1]||(s[1]=N=>a.value=N),animated:""},he({default:r(()=>[o(p,{key:"1"},{tab:r(()=>[Ee]),default:r(()=>[o(Ge,{"form-data":t.value,"edit-mode":m.value,onCancelEdit:k,onOnSuccess:_},null,8,["form-data","edit-mode"])]),_:1}),o(p,{key:"2"},{tab:r(()=>[Ie]),default:r(()=>[o(Te,{idx:f.value,onRowClick:M},null,8,["idx"])]),_:1})]),_:2},[a.value==="2"?{name:"rightExtra",fn:r(()=>[o(h,{size:"small",class:"mt-3",onClick:s[0]||(s[0]=N=>f.value+=1)},{default:r(()=>[Ke,g(" Refresh Data ")]),_:1})]),key:"0"}:void 0]),1032,["activeKey"])])}}});export{va as default};
