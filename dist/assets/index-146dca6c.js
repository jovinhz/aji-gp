var P=Object.defineProperty;var W=(o,t,e)=>t in o?P(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e;var I=(o,t,e)=>(W(o,typeof t!="symbol"?t+"":t,e),e);import{B as A}from"./index-9584979d.js";/* empty css              */import{H as X,u as C}from"./HttpClient-0a75d377.js";import{I as Y}from"./index-10fa5780.js";import{o as Z,a as T}from"./index-b888b7f0.js";import{_ as ee}from"./InputDropdown.vuevuetypescriptsetuptruelang-dcd6530b.js";import{d as B,r as v,Q as O,w as V,e as U,g as k,a2 as j,a7 as l,j as F,k as n,a4 as g,b as i,u as b,a5 as R,a9 as ae,ak as te}from"./runtime-core.esm-bundler-91f37afc.js";import{M as ne}from"./Modal-ae1a596d.js";import{_ as ie,T as oe,a as se}from"./index-a67e165f.js";import{_ as le,F as ce}from"./index-f05d861a.js";import{_ as re}from"./TextArea-a8cbd09f.js";import{_ as de}from"./AgGrid.vuevuetypescriptsetuptruelang-73411e77.js";import"./plugin-vueexport-helper-c27b6911.js";class D{static list(){return this.HttpClient.axiosInstance.get("/working_tools")}static create(t){return this.HttpClient.withOptions({showSuccessFeedback:!0,successFeedbackMessage:"Alat Kerja berhasil ditambah"}).axiosInstance.post("/working_tools",t)}static update(t,e){return this.HttpClient.withOptions({showSuccessFeedback:!0,successFeedbackMessage:"Alat Kerja berhasil diupdate"}).axiosInstance.put(`/working_tools/${t}`,e)}static formOptions(){return this.HttpClient.axiosInstance.get("/working_tools/form_options")}}I(D,"HttpClient",new X);const ue={class:"card card-custom card-dense"},me={class:"card-header"},fe={class:"card-title w-100 d-flex justify-content-between"},pe=l("h4",{class:"card-label"},"Form Master Alat Kerja",-1),_e={class:"card-body"},ve={class:"row"},ge={class:"col-lg-6"},he=l("i",{class:"fe fe-save me-2"},null,-1),ke=B({__name:"Form",props:{formData:null,editMode:{type:Boolean}},emits:["cancelEdit","onSuccess"],setup(o,{emit:t}){const e=o,f=[{field:"code",headerName:"Kode Satuan"},{field:"name",headerName:"Nama Satuan"}],c=v(""),p=v(),a=O({}),w={name:[{required:!0,message:"Nama alat kerja wajib diisi",trigger:"change"}],unit_id:[{required:!0,message:"Satuan wajib dipilih",trigger:"change"}],specification:[{required:!0,message:"Spesifikasi wajib diisi",trigger:"change"}]},d=v(),{run:m,loading:u,response:h}=C(),{run:S,loading:x,response:E}=C(),{run:xe,loading:q,response:Ce}=C();async function z(){var r,s,y;try{e.editMode?await m(D.update((r=e.formData)==null?void 0:r.id,{name:a.name,unit_id:a.unit_id,specification:a.specification})):(await m(D.create({name:a.name,unit_id:a.unit_id,specification:a.specification})),(s=h.value)!=null&&s.success&&H()),(y=h.value)!=null&&y.success&&t("onSuccess")}catch{}}async function G(){}function H(){var r;if(e.editMode){for(const s in a)a[s]=void 0;c.value="",t("cancelEdit")}else(r=p.value)==null||r.resetFields(),c.value=""}function Q(){ne.confirm({title:"Konfirmasi Hapus Alat Kerja",content:"Apakah kamu sudah yakin ingin menghapus data [Edit Here]",cancelText:"Batal",onOk:G})}return V(()=>e.formData,()=>{var r;e.formData&&((r=p.value)==null||r.clearValidate(),a.name=e.formData.name,a.specification=e.formData.specification,a.unit_id=e.formData.unit.id,c.value=`${e.formData.unit.code} - ${e.formData.unit.name}`)}),U(async()=>{var r;try{await S(D.formOptions()),(r=E.value)!=null&&r.success&&(d.value=E.value.data)}catch{}}),(r,s)=>{const y=ie,K=Y,M=le,J=re,N=A,L=ce;return k(),j("div",ue,[l("div",me,[l("div",fe,[pe,o.editMode?(k(),F(y,{key:0,color:"orange"},{default:n(()=>[g("Mode Edit")]),_:1})):(k(),F(y,{key:1,color:"cyan"},{default:n(()=>[g("Mode Input")]),_:1}))])]),l("div",_e,[i(L,{ref_key:"formRef",ref:p,model:a,rules:w,"label-col":{style:{width:"220px"}},colon:!1,"label-align":"left",onFinish:s[3]||(s[3]=_=>b(Z)(p.value,z))},{default:n(()=>[l("div",ve,[l("div",ge,[i(M,{label:"Nama",name:"name",ref:"name"},{default:n(()=>[i(K,{value:a.name,"onUpdate:value":s[0]||(s[0]=_=>a.name=_)},null,8,["value"])]),_:1},512),i(M,{label:"Satuan",name:"unit_id",ref:"unit_id"},{default:n(()=>{var _;return[i(ee,{"column-defs":f,"grid-data":((_=d.value)==null?void 0:_.units)??[],loading:b(x),value:void 0,"value-display":c.value,onChange:s[1]||(s[1]=$=>{a.unit_id=$.id,c.value=`${$.code} - ${$.name}`})},null,8,["grid-data","loading","value-display"])]}),_:1},512),i(M,{label:"Spesifikasi",name:"specification",ref:"specification"},{default:n(()=>[i(J,{value:a.specification,"onUpdate:value":s[2]||(s[2]=_=>a.specification=_)},null,8,["value"])]),_:1},512),i(N,{type:"primary","html-type":"submit",loading:b(u)},{default:n(()=>[he,l("span",null,R(o.editMode?"Edit":"Simpan"),1)]),_:1},8,["loading"]),i(N,{class:"mx-3",onClick:H},{default:n(()=>[g(R(o.editMode?"Batal Edit":"Bersihkan"),1)]),_:1}),o.editMode?(k(),F(N,{key:0,danger:"",type:"primary",onClick:Q,loading:b(q)},{default:n(()=>[g(" Hapus ")]),_:1},8,["loading"])):ae("",!0)])])]),_:1},8,["model"])])])}}}),we=B({__name:"DataTable",props:{idx:null},emits:["rowClick"],setup(o,{emit:t}){const e=o,f=O({value:[{field:"name",headerName:"Nama",pinned:"left"},{field:"specification",headerName:"Spesifikasi"},{field:"unit.name",headerName:"Satuan"},{field:"created_at",headerName:"Diinput Tgl",...T},{field:"updated_at",headerName:"Diupdate Tgl",...T},{field:"created_by_user_username",headerName:"Diinput Oleh",flex:0,width:120},{field:"updated_by_user_username",headerName:"Diupdate Oleh",flex:0,width:120}]}),c=O({value:null}),{run:p,response:a,loading:w}=C();async function d(){var u;try{await p(D.list()),(u=a.value)!=null&&u.success&&(c.value=a.value.data)}catch{}}function m(u){t("rowClick",u)}return U(()=>{d()}),V(()=>e.idx,()=>{d()}),(u,h)=>(k(),j("div",null,[i(de,{"row-data":c.value,"column-defs":f.value,loading:b(w),onRowClick:m},null,8,["row-data","column-defs","loading"])]))}}),ye=l("span",null,[l("i",{class:"fe fe-edit-2 me-2"}),g(" Input ")],-1),be=l("span",null,[l("i",{class:"fe fe-search me-2"}),g(" Browse ")],-1),De=l("i",{class:"fe fe-refresh-cw me-2"},null,-1),Ae=B({__name:"index",setup(o){const t=v("1"),e=v(),f=v(!1),c=v(1);function p(d){t.value="1",e.value={...d},f.value=!0}function a(){f.value=!1}function w(d){c.value+=1,d!==void 0&&(f.value=d)}return(d,m)=>{const u=se,h=A,S=oe;return k(),j("div",null,[i(S,{class:"input-browse-tab",activeKey:t.value,"onUpdate:activeKey":m[1]||(m[1]=x=>t.value=x),animated:""},te({default:n(()=>[i(u,{key:"1"},{tab:n(()=>[ye]),default:n(()=>[i(ke,{"form-data":e.value,"edit-mode":f.value,onCancelEdit:a,onOnSuccess:w},null,8,["form-data","edit-mode"])]),_:1}),i(u,{key:"2"},{tab:n(()=>[be]),default:n(()=>[i(we,{idx:c.value,onRowClick:p},null,8,["idx"])]),_:1})]),_:2},[t.value==="2"?{name:"rightExtra",fn:n(()=>[i(h,{size:"small",class:"mt-3",onClick:m[0]||(m[0]=x=>c.value+=1)},{default:n(()=>[De,g(" Refresh Data ")]),_:1})]),key:"0"}:void 0]),1032,["activeKey"])])}}});export{Ae as default};
