import{B as I}from"./index-0bb8ea7a.js";import{_ as P}from"./AgGrid.vuevuetypescriptsetuptruelang-7e3c6181.js";import{o as X,a as R}from"./index-a5a9580b.js";import"./index-88df4a80.js";/* empty css              */import{u as S}from"./HttpClient-ea8ece11.js";import{_ as Y}from"./InputDropdown.vuevuetypescriptsetuptruelang-0cd387c5.js";import{W as w}from"./WorkingToolService-7fae91e9.js";import{d as F,r as v,Q as E,w as U,e as q,g as k,a7 as T,ac as s,j as O,k as o,a9 as g,b as i,u as b,aa as V,ae as Z,ak as ee}from"./plugin-vueexport-helper-23a171d5.js";import{M as ae}from"./Modal-6ee96ca6.js";import{_ as te}from"./index-34514a8f.js";import{I as ne,_ as oe,F as ie}from"./Input-1a0f2199.js";import{_ as se}from"./TextArea-c9a675dc.js";import{T as le,_ as ce}from"./TabPane-5937dbd3.js";import"./pickAttrs-349b6a5f.js";const re={class:"card card-custom card-dense"},de={class:"card-header"},ue={class:"card-title w-100 d-flex justify-content-between"},me=s("h4",{class:"card-label"},"Form Master Alat Kerja",-1),fe={class:"card-body"},_e={class:"row"},pe={class:"col-lg-6"},ve=s("i",{class:"fe fe-save me-2"},null,-1),ge=F({__name:"Form",props:{formData:null,editMode:{type:Boolean}},emits:["cancelEdit","onSuccess"],setup(m,{emit:r}){const t=m,f=[{field:"code",headerName:"Kode Satuan"},{field:"name",headerName:"Nama Satuan"}],l=v(""),_=v(),e=E({}),D={name:[{required:!0,message:"Nama alat kerja wajib diisi",trigger:"change"}],unit_id:[{required:!0,message:"Satuan wajib dipilih",trigger:"change"}],specification:[{required:!0,message:"Spesifikasi wajib diisi",trigger:"change"}]},c=v(),{run:u,loading:d,response:h}=S(),{run:N,loading:x,response:j}=S(),{run:A,loading:H,response:W}=S();async function z(){var a,n,y;try{t.editMode?await u(w.update((a=t.formData)==null?void 0:a.id,{name:e.name,unit_id:e.unit_id,specification:e.specification})):(await u(w.create({name:e.name,unit_id:e.unit_id,specification:e.specification})),(n=h.value)!=null&&n.success&&C()),(y=h.value)!=null&&y.success&&r("onSuccess")}catch{}}async function G(){var a,n;try{await A(w.delete((a=t.formData)==null?void 0:a.id)),(n=W.value)!=null&&n.success&&(C(),r("onSuccess"))}catch{}}function C(){var a;if(t.editMode){for(const n in e)e[n]=void 0;l.value="",r("cancelEdit")}else(a=_.value)==null||a.resetFields(),l.value=""}function Q(){var a;ae.confirm({title:"Konfirmasi Hapus Alat Kerja",content:`Apakah kamu sudah yakin ingin menghapus data ${(a=t.formData)==null?void 0:a.name} ?`,cancelText:"Batal",onOk:G})}return U(()=>t.formData,()=>{var a;t.formData&&((a=_.value)==null||a.clearValidate(),e.name=t.formData.name,e.specification=t.formData.specification,e.unit_id=t.formData.unit.id,l.value=`${t.formData.unit.code} - ${t.formData.unit.name}`)}),q(async()=>{var a;try{await N(w.formOptions()),(a=j.value)!=null&&a.success&&(c.value=j.value.data)}catch{}}),(a,n)=>{const y=te,K=ne,M=oe,J=se,$=I,L=ie;return k(),T("div",re,[s("div",de,[s("div",ue,[me,m.editMode?(k(),O(y,{key:0,color:"orange"},{default:o(()=>[g("Mode Edit")]),_:1})):(k(),O(y,{key:1,color:"cyan"},{default:o(()=>[g("Mode Input")]),_:1}))])]),s("div",fe,[i(L,{ref_key:"formRef",ref:_,model:e,rules:D,"label-col":{style:{width:"220px"}},colon:!1,"label-align":"left",onFinish:n[3]||(n[3]=p=>b(X)(_.value,z))},{default:o(()=>[s("div",_e,[s("div",pe,[i(M,{label:"Nama",name:"name",ref:"name"},{default:o(()=>[i(K,{value:e.name,"onUpdate:value":n[0]||(n[0]=p=>e.name=p)},null,8,["value"])]),_:1},512),i(M,{label:"Satuan",name:"unit_id",ref:"unit_id"},{default:o(()=>{var p;return[i(Y,{"column-defs":f,"grid-data":((p=c.value)==null?void 0:p.units)??[],loading:b(x),value:void 0,"value-display":l.value,onChange:n[1]||(n[1]=B=>{e.unit_id=B.id,l.value=`${B.code} - ${B.name}`})},null,8,["grid-data","loading","value-display"])]}),_:1},512),i(M,{label:"Spesifikasi",name:"specification",ref:"specification"},{default:o(()=>[i(J,{value:e.specification,"onUpdate:value":n[2]||(n[2]=p=>e.specification=p)},null,8,["value"])]),_:1},512),i($,{type:"primary","html-type":"submit",loading:b(d)},{default:o(()=>[ve,s("span",null,V(m.editMode?"Edit":"Simpan"),1)]),_:1},8,["loading"]),i($,{class:"mx-3",onClick:C},{default:o(()=>[g(V(m.editMode?"Batal Edit":"Bersihkan"),1)]),_:1}),m.editMode?(k(),O($,{key:0,danger:"",type:"primary",onClick:Q,loading:b(H)},{default:o(()=>[g(" Hapus ")]),_:1},8,["loading"])):Z("",!0)])])]),_:1},8,["model"])])])}}}),he=F({__name:"DataTable",props:{idx:null},emits:["rowClick"],setup(m,{emit:r}){const t=m,f=E({value:[{field:"name",headerName:"Nama",pinned:"left"},{field:"specification",headerName:"Spesifikasi"},{field:"unit.name",headerName:"Satuan"},{field:"created_at",headerName:"Diinput Tgl",...R},{field:"updated_at",headerName:"Diupdate Tgl",...R},{field:"created_by_user_username",headerName:"Diinput Oleh",flex:0,width:120},{field:"updated_by_user_username",headerName:"Diupdate Oleh",flex:0,width:120}]}),l=E({value:null}),{run:_,response:e,loading:D}=S();async function c(){var d;try{await _(w.list()),(d=e.value)!=null&&d.success&&(l.value=e.value.data)}catch{}}function u(d){r("rowClick",d)}return q(()=>{c()}),U(()=>t.idx,()=>{c()}),(d,h)=>(k(),T("div",null,[i(P,{"row-data":l.value,"column-defs":f.value,loading:b(D),onRowClick:u},null,8,["row-data","column-defs","loading"])]))}}),ye=s("span",null,[s("i",{class:"fe fe-edit-2 me-2"}),g(" Input ")],-1),ke=s("span",null,[s("i",{class:"fe fe-search me-2"}),g(" Browse ")],-1),De=s("i",{class:"fe fe-refresh-cw me-2"},null,-1),Re=F({__name:"index",setup(m){const r=v("1"),t=v(),f=v(!1),l=v(1);function _(c){r.value="1",t.value={...c},f.value=!0}function e(){f.value=!1}function D(c){l.value+=1,c!==void 0&&(f.value=c)}return(c,u)=>{const d=ce,h=I,N=le;return k(),T("div",null,[i(N,{class:"input-browse-tab",activeKey:r.value,"onUpdate:activeKey":u[1]||(u[1]=x=>r.value=x),animated:""},ee({default:o(()=>[i(d,{key:"1"},{tab:o(()=>[ye]),default:o(()=>[i(ge,{"form-data":t.value,"edit-mode":f.value,onCancelEdit:e,onOnSuccess:D},null,8,["form-data","edit-mode"])]),_:1}),i(d,{key:"2"},{tab:o(()=>[ke]),default:o(()=>[i(he,{idx:l.value,onRowClick:_},null,8,["idx"])]),_:1})]),_:2},[r.value==="2"?{name:"rightExtra",fn:o(()=>[i(h,{size:"small",class:"mt-3",onClick:u[0]||(u[0]=x=>l.value+=1)},{default:o(()=>[De,g(" Refresh Data ")]),_:1})]),key:"0"}:void 0]),1032,["activeKey"])])}}});export{Re as default};
