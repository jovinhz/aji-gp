var Z=Object.defineProperty;var ee=(l,s,a)=>s in l?Z(l,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):l[s]=a;var G=(l,s,a)=>(ee(l,typeof s!="symbol"?s+"":s,a),a);import{B as A}from"./index-153eefc2.js";import{_ as ae}from"./AgGrid.vuevuetypescriptsetuptruelang-ab13ecb9.js";import{o as te,a as H}from"./index-8f77c718.js";import"./index-516ff1a6.js";import{S as oe,_ as ne}from"./index-6857fb4e.js";/* empty css              */import{_ as se}from"./InputDropdown.vuevuetypescriptsetuptruelang-59e1ec1d.js";import{H as ie,u as M}from"./HttpClient-7fc79ba3.js";import{d as T,r as b,O as K,w as j,a as V,e as y,a7 as U,ac as d,f as B,g as n,a9 as v,c as t,u as C,aa as R,ae as re,ak as le}from"./plugin-vueexport-helper-0ef99882.js";import{M as de}from"./Modal-79dc3d32.js";import{_ as ue}from"./index-0437c30a.js";import{I as ce,_ as me,F as fe}from"./Input-bda0940e.js";import{_ as pe}from"./TextArea-17c42df7.js";import{T as _e,_ as ve}from"./TabPane-9c8435b0.js";import"./pickAttrs-596f35c3.js";import"./useMemo-49158cc8.js";import"./DownOutlined-80526c88.js";import"./CheckOutlined-94b1a800.js";import"./SearchOutlined-1764655a.js";class k{static list(){return this.HttpClient.axiosInstance.get("/customers")}static create(s){return this.HttpClient.withOptions({showSuccessFeedback:!0,successFeedbackMessage:"Customer berhasil ditambah"}).axiosInstance.post("/customers",s)}static update(s,a){return this.HttpClient.withOptions({showSuccessFeedback:!0,successFeedbackMessage:"Customer berhasil diupdate"}).axiosInstance.put(`/customers/${s}`,a)}static formOptions(){return this.HttpClient.axiosInstance.get("/customers/form_options")}static delete(s){return this.HttpClient.withOptions({showSuccessFeedback:!0,successFeedbackMessage:"Customer berhasil dihapus"}).axiosInstance.delete(`/customers/${s}`)}}G(k,"HttpClient",new ie);const he={class:"card card-custom card-dense"},ge={class:"card-header"},be={class:"card-title w-100 d-flex justify-content-between"},xe=d("h4",{class:"card-label"},"Form Master Customer",-1),we={class:"card-body"},De={class:"row"},ye={class:"col-lg-6"},ke=d("i",{class:"fe fe-save me-2"},null,-1),Ce=T({__name:"Form",props:{formData:null,editMode:{type:Boolean}},emits:["cancelEdit","onSuccess"],setup(l,{emit:s}){const a=l,h=[{field:"code",headerName:"Kode Grup"},{field:"name",headerName:"Nama Grup"}],c=b(""),x=b(),f=b(),e=K({is_active:!0}),m={code:[{required:!0,message:"Kode customer wajib diisi",trigger:"change"}],name:[{required:!0,message:"Nama customer wajib diisi",trigger:"change"}],customer_group_id:[{required:!0,message:"Grup customer wajib dipilih",trigger:"change"}],address:[{required:!0,message:"Alamat customer wajib diisi",trigger:"change"}]},{run:p,loading:u,response:w}=M(),{run:$,loading:N,response:E}=M(),{run:q,loading:P,response:z}=M();async function J(){var r,o,D;try{a.editMode?await p(k.update((r=a.formData)==null?void 0:r.id,{address:e.address,customer_group_id:e.customer_group_id,name:e.name,fax:e.fax,handphone:e.handphone,note:e.note,is_active:e.is_active,phone_number:e.phone_number})):(await p(k.create({code:e.code.toUpperCase(),address:e.address,customer_group_id:e.customer_group_id,name:e.name,fax:e.fax,handphone:e.handphone,note:e.note,is_active:e.is_active,phone_number:e.phone_number})),(o=w.value)!=null&&o.success&&F()),(D=w.value)!=null&&D.success&&s("onSuccess")}catch{}}async function L(){var r,o;try{await q(k.delete((r=a.formData)==null?void 0:r.id)),(o=z.value)!=null&&o.success&&(F(),s("onSuccess"))}catch{}}function F(){var r;if(a.editMode){for(const o in e)e[o]=void 0;e.is_active=!0,s("cancelEdit")}else(r=f.value)==null||r.resetFields();c.value=""}function Q(){var r;de.confirm({title:"Konfirmasi Hapus Customer",content:`Apakah kamu sudah yakin ingin menghapus data ${(r=a.formData)==null?void 0:r.code} ?`,cancelText:"Batal",onOk:L})}return j(()=>a.formData,()=>{var r;a.formData&&((r=f.value)==null||r.clearValidate(),e.code=a.formData.code,e.address=a.formData.address,e.customer_group_id=a.formData.customer_group.id,e.fax=a.formData.fax,e.handphone=a.formData.handphone,e.name=a.formData.name,e.note=a.formData.note,e.phone_number=a.formData.phone_number,e.is_active=a.formData.is_active,c.value=`${a.formData.customer_group.code} - ${a.formData.customer_group.name}`)}),V(async()=>{var r;try{await $(k.formOptions()),(r=E.value)!=null&&r.success&&(x.value=E.value.data)}catch{}}),(r,o)=>{const D=ue,g=ce,_=me,W=pe,I=oe,X=ne,O=A,Y=fe;return y(),U("div",he,[d("div",ge,[d("div",be,[xe,l.editMode?(y(),B(D,{key:0,color:"orange"},{default:n(()=>[v("Mode Edit")]),_:1})):(y(),B(D,{key:1,color:"cyan"},{default:n(()=>[v("Mode Input")]),_:1}))])]),d("div",we,[t(Y,{ref_key:"formRef",ref:f,model:e,rules:m,"label-col":{style:{width:"220px"}},colon:!1,"label-align":"left",onFinish:o[9]||(o[9]=i=>C(te)(f.value,J))},{default:n(()=>[d("div",De,[d("div",ye,[t(_,{label:"Kode Customer",name:"code",ref:"code"},{default:n(()=>[t(g,{value:e.code,"onUpdate:value":o[0]||(o[0]=i=>e.code=i),valueModifiers:{trim:!0},style:{"text-transform":"uppercase"},disabled:l.editMode},null,8,["value","disabled"])]),_:1},512),t(_,{label:"Nama Customer",name:"name",ref:"name"},{default:n(()=>[t(g,{value:e.name,"onUpdate:value":o[1]||(o[1]=i=>e.name=i)},null,8,["value"])]),_:1},512),t(_,{label:"Grup Customer",name:"customer_group_id",ref:"customer_group_id"},{default:n(()=>{var i;return[t(se,{"column-defs":h,"grid-data":((i=x.value)==null?void 0:i.customer_groups)??[],loading:C(N),value:void 0,"value-display":c.value,onChange:o[2]||(o[2]=S=>{e.customer_group_id=S.id,c.value=`${S.code} - ${S.name}`})},null,8,["grid-data","loading","value-display"])]}),_:1},512),t(_,{label:"Alamat",name:"address",ref:"address"},{default:n(()=>[t(W,{value:e.address,"onUpdate:value":o[3]||(o[3]=i=>e.address=i)},null,8,["value"])]),_:1},512),t(_,{label:"Telp",name:"phone_number",ref:"phone_number"},{default:n(()=>[t(g,{value:e.phone_number,"onUpdate:value":o[4]||(o[4]=i=>e.phone_number=i)},null,8,["value"])]),_:1},512),t(_,{label:"HP",name:"handphone",ref:"handphone"},{default:n(()=>[t(g,{value:e.handphone,"onUpdate:value":o[5]||(o[5]=i=>e.handphone=i)},null,8,["value"])]),_:1},512),t(_,{label:"Fax",name:"fax",ref:"fax"},{default:n(()=>[t(g,{value:e.fax,"onUpdate:value":o[6]||(o[6]=i=>e.fax=i)},null,8,["value"])]),_:1},512),t(_,{label:"Keterangan",name:"note",ref:"note"},{default:n(()=>[t(g,{value:e.note,"onUpdate:value":o[7]||(o[7]=i=>e.note=i)},null,8,["value"])]),_:1},512),t(_,{label:"Status",name:"is_active",ref:"is_active"},{default:n(()=>[t(X,{value:e.is_active,"onUpdate:value":o[8]||(o[8]=i=>e.is_active=i)},{default:n(()=>[t(I,{value:!0},{default:n(()=>[v(" Aktif ")]),_:1}),t(I,{value:!1},{default:n(()=>[v(" Nonaktif ")]),_:1})]),_:1},8,["value"])]),_:1},512),t(O,{type:"primary","html-type":"submit",loading:C(u)},{default:n(()=>[ke,d("span",null,R(l.editMode?"Edit":"Simpan"),1)]),_:1},8,["loading"]),t(O,{class:"mx-3",onClick:F},{default:n(()=>[v(R(l.editMode?"Batal Edit":"Bersihkan"),1)]),_:1}),l.editMode?(y(),B(O,{key:0,danger:"",type:"primary",onClick:Q,loading:C(P)},{default:n(()=>[v(" Hapus ")]),_:1},8,["loading"])):re("",!0)])])]),_:1},8,["model"])])])}}}),Ne=T({__name:"DataTable",props:{idx:null},emits:["rowClick"],setup(l,{emit:s}){const a=l,h=K({value:[{field:"code",headerName:"Kode Customer",flex:0,width:130,pinned:"left"},{field:"name",headerName:"Nama",flex:0,width:170},{field:"address",headerName:"Alamat",flex:0,width:150},{field:"customer_group.code",headerName:"Grup",flex:0,width:80},{field:"is_active",headerName:"Status",flex:0,width:100,valueGetter:u=>u.data.is_active?"Aktif":"Nonaktif"},{field:"phone_number",headerName:"Telp",flex:0,width:100},{field:"fax",headerName:"Fax",flex:0,width:100},{field:"handphone",headerName:"HP",flex:0,width:100},{field:"note",headerName:"Keterangan",flex:0,width:100},{field:"created_at",headerName:"Diinput Tgl",...H},{field:"created_at",headerName:"Diinput Tgl",...H},{field:"updated_at",headerName:"Diupdate Tgl",...H},{field:"created_by_user_username",headerName:"Diinput Oleh",flex:0,width:120},{field:"updated_by_user_username",headerName:"Diupdate Oleh",flex:0,width:120}]}),c=K({value:null}),{run:x,response:f,loading:e}=M();async function m(){var u;try{await x(k.list()),(u=f.value)!=null&&u.success&&(c.value=f.value.data)}catch{}}function p(u){s("rowClick",u)}return V(()=>{m()}),j(()=>a.idx,()=>{m()}),(u,w)=>(y(),U("div",null,[t(ae,{"row-data":c.value,"column-defs":h.value,loading:C(e),onRowClick:p},null,8,["row-data","column-defs","loading"])]))}}),Me=d("span",null,[d("i",{class:"fe fe-edit-2 me-2"}),v(" Input ")],-1),$e=d("span",null,[d("i",{class:"fe fe-search me-2"}),v(" Browse ")],-1),Fe=d("i",{class:"fe fe-refresh-cw me-2"},null,-1),We=T({__name:"index",setup(l){const s=b("1"),a=b(),h=b(!1),c=b(1);function x(m){s.value="1",a.value={...m},h.value=!0}function f(){h.value=!1}function e(m){c.value+=1,m!==void 0&&(h.value=m)}return(m,p)=>{const u=ve,w=A,$=_e;return y(),U("div",null,[t($,{class:"input-browse-tab",activeKey:s.value,"onUpdate:activeKey":p[1]||(p[1]=N=>s.value=N),animated:""},le({default:n(()=>[t(u,{key:"1"},{tab:n(()=>[Me]),default:n(()=>[t(Ce,{"form-data":a.value,"edit-mode":h.value,onCancelEdit:f,onOnSuccess:e},null,8,["form-data","edit-mode"])]),_:1}),t(u,{key:"2"},{tab:n(()=>[$e]),default:n(()=>[t(Ne,{idx:c.value,onRowClick:x},null,8,["idx"])]),_:1})]),_:2},[s.value==="2"?{name:"rightExtra",fn:n(()=>[t(w,{size:"small",class:"mt-3",onClick:p[0]||(p[0]=N=>c.value+=1)},{default:n(()=>[Fe,v(" Refresh Data ")]),_:1})]),key:"0"}:void 0]),1032,["activeKey"])])}}});export{We as default};
