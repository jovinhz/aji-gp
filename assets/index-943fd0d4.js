var X=Object.defineProperty;var Y=(r,t,a)=>t in r?X(r,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):r[t]=a;var T=(r,t,a)=>(Y(r,typeof t!="symbol"?t+"":t,a),a);import{B as V}from"./index-0bb8ea7a.js";import{_ as Z}from"./AgGrid.vuevuetypescriptsetuptruelang-7e3c6181.js";import{o as ee,a as R}from"./index-a5a9580b.js";import"./index-88df4a80.js";/* empty css              */import{H as ae,u as N}from"./HttpClient-ea8ece11.js";import{_ as te}from"./InputDropdown.vuevuetypescriptsetuptruelang-0cd387c5.js";import{d as B,r as v,Q as S,w as A,e as q,g as y,a7 as H,ac as d,j as K,k as i,a9 as h,b as o,u as k,aa as j,ae as se,ak as oe}from"./plugin-vueexport-helper-23a171d5.js";import{M as ne}from"./Modal-6ee96ca6.js";import{_ as ie}from"./index-34514a8f.js";import{I as re,_ as de,F as le}from"./Input-1a0f2199.js";import{_ as ue}from"./TextArea-c9a675dc.js";import{T as ce,_ as me}from"./TabPane-5937dbd3.js";import"./pickAttrs-349b6a5f.js";class C{static list(){return this.HttpClient.axiosInstance.get("/customer_units")}static create(t){return this.HttpClient.withOptions({showSuccessFeedback:!0,successFeedbackMessage:"Customer Unit berhasil ditambah"}).axiosInstance.post("/customer_units",t)}static update(t,a){return this.HttpClient.withOptions({showSuccessFeedback:!0,successFeedbackMessage:"Customer Unit berhasil diupdate"}).axiosInstance.put(`/customer_units/${t}`,a)}static formOptions(){return this.HttpClient.axiosInstance.get("/customer_units/form_options")}static delete(t){return this.HttpClient.withOptions({showSuccessFeedback:!0,successFeedbackMessage:"Customer Unit berhasil dihapus"}).axiosInstance.delete(`/customer_units/${t}`)}}T(C,"HttpClient",new ae);const fe={class:"card card-custom card-dense"},pe={class:"card-header"},_e={class:"card-title w-100 d-flex justify-content-between"},ve=d("h4",{class:"card-label"},"Form Master Customer Unit",-1),he={class:"card-body"},ge={class:"row"},be={class:"col-lg-6"},we=d("i",{class:"fe fe-save me-2"},null,-1),ye=B({__name:"Form",props:{formData:null,editMode:{type:Boolean}},emits:["cancelEdit","onSuccess"],setup(r,{emit:t}){const a=r,l=v(""),_=[{field:"code",headerName:"Kode Customer",flex:0,width:140},{field:"name",headerName:"Nama Customer"},{field:"customer_group.code",headerName:"Kode Grup",flex:0,width:120},{field:"customer_group.name",headerName:"Nama Grup"},{field:"address",headerName:"Alamat"}],g=v(),f=v(),e=S({}),c={code:[{required:!0,message:"Kode unit wajib diisi",trigger:"change"}],name:[{required:!0,message:"Nama unit wajib diisi",trigger:"change"}],customer_id:[{required:!0,message:"Customer wajib dipilih",trigger:"change"}]},{run:p,loading:m,response:b}=N(),{run:M,loading:x,response:E}=N(),{run:G,loading:z,response:Q}=N();async function J(){var n,s,w;try{a.editMode?await p(C.update((n=a.formData)==null?void 0:n.id,{customer_id:e.customer_id,name:e.name,address:e.address,note:e.note})):(await p(C.create({code:e.code.toUpperCase(),customer_id:e.customer_id,name:e.name,address:e.address,note:e.note})),(s=b.value)!=null&&s.success&&$()),(w=b.value)!=null&&w.success&&t("onSuccess")}catch{}}async function L(){var n,s;try{await G(C.delete((n=a.formData)==null?void 0:n.id)),(s=Q.value)!=null&&s.success&&($(),t("onSuccess"))}catch{}}function $(){var n;if(a.editMode){for(const s in e)e[s]=void 0;t("cancelEdit")}else(n=f.value)==null||n.resetFields();l.value=""}function P(){var n;ne.confirm({title:"Konfirmasi Hapus Unit",content:`Apakah kamu sudah yakin ingin menghapus data ${(n=a.formData)==null?void 0:n.code} ?`,cancelText:"Batal",onOk:L})}return A(()=>a.formData,()=>{var n;a.formData&&((n=f.value)==null||n.clearValidate(),e.code=a.formData.code,e.customer_id=a.formData.customer.id,e.address=a.formData.address,e.name=a.formData.name,e.note=a.formData.note,l.value=`${a.formData.customer.code} - ${a.formData.customer.name}`)}),q(async()=>{var n;try{await M(C.formOptions()),(n=E.value)!=null&&n.success&&(g.value=E.value.data)}catch{}}),(n,s)=>{const w=ie,F=re,D=de,I=ue,U=V,W=le;return y(),H("div",fe,[d("div",pe,[d("div",_e,[ve,r.editMode?(y(),K(w,{key:0,color:"orange"},{default:i(()=>[h("Mode Edit")]),_:1})):(y(),K(w,{key:1,color:"cyan"},{default:i(()=>[h("Mode Input")]),_:1}))])]),d("div",he,[o(W,{ref_key:"formRef",ref:f,model:e,rules:c,"label-col":{style:{width:"220px"}},colon:!1,"label-align":"left",onFinish:s[5]||(s[5]=u=>k(ee)(f.value,J))},{default:i(()=>[d("div",ge,[d("div",be,[o(D,{label:"Kode Unit",name:"code",ref:"code"},{default:i(()=>[o(F,{value:e.code,"onUpdate:value":s[0]||(s[0]=u=>e.code=u),valueModifiers:{trim:!0},style:{"text-transform":"uppercase"},disabled:r.editMode},null,8,["value","disabled"])]),_:1},512),o(D,{label:"Nama Unit",name:"name",ref:"name"},{default:i(()=>[o(F,{value:e.name,"onUpdate:value":s[1]||(s[1]=u=>e.name=u)},null,8,["value"])]),_:1},512),o(D,{label:"Customer",name:"customer_id",ref:"customer_id"},{default:i(()=>{var u;return[o(te,{"column-defs":_,"grid-data":((u=g.value)==null?void 0:u.customers)??[],loading:k(x),value:void 0,"value-display":l.value,onChange:s[2]||(s[2]=O=>{e.customer_id=O.id,l.value=`${O.code} - ${O.name}`})},null,8,["grid-data","loading","value-display"])]}),_:1},512),o(D,{label:"Alamat",name:"address",ref:"address"},{default:i(()=>[o(I,{value:e.address,"onUpdate:value":s[3]||(s[3]=u=>e.address=u)},null,8,["value"])]),_:1},512),o(D,{label:"Keterangan",name:"note",ref:"note"},{default:i(()=>[o(I,{value:e.note,"onUpdate:value":s[4]||(s[4]=u=>e.note=u)},null,8,["value"])]),_:1},512),o(U,{type:"primary","html-type":"submit",loading:k(m)},{default:i(()=>[we,d("span",null,j(r.editMode?"Edit":"Simpan"),1)]),_:1},8,["loading"]),o(U,{class:"mx-3",onClick:$},{default:i(()=>[h(j(r.editMode?"Batal Edit":"Bersihkan"),1)]),_:1}),r.editMode?(y(),K(U,{key:0,danger:"",type:"primary",onClick:P,loading:k(z)},{default:i(()=>[h(" Hapus ")]),_:1},8,["loading"])):se("",!0)])])]),_:1},8,["model"])])])}}}),Ce=B({__name:"DataTable",props:{idx:null},emits:["rowClick"],setup(r,{emit:t}){const a=r,l=S({value:[{field:"code",headerName:"Kode Unit",flex:0,width:100,pinned:"left"},{field:"name",headerName:"Nama Unit",flex:0,width:150},{field:"customer.name",headerName:"Nama Customer"},{field:"address",headerName:"Alamat"},{field:"note",headerName:"Keterangan"},{field:"created_at",headerName:"Diinput Tgl",...R},{field:"updated_at",headerName:"Diupdate Tgl",...R},{field:"created_by_user_username",headerName:"Diinput Oleh",flex:0,width:120},{field:"updated_by_user_username",headerName:"Diupdate Oleh",flex:0,width:120}]}),_=S({value:null}),{run:g,response:f,loading:e}=N();async function c(){var m;try{await g(C.list()),(m=f.value)!=null&&m.success&&(_.value=f.value.data)}catch{}}function p(m){t("rowClick",m)}return q(()=>{c()}),A(()=>a.idx,()=>{c()}),(m,b)=>(y(),H("div",null,[o(Z,{"row-data":_.value,"column-defs":l.value,loading:k(e),onRowClick:p},null,8,["row-data","column-defs","loading"])]))}}),De=d("span",null,[d("i",{class:"fe fe-edit-2 me-2"}),h(" Input ")],-1),ke=d("span",null,[d("i",{class:"fe fe-search me-2"}),h(" Browse ")],-1),xe=d("i",{class:"fe fe-refresh-cw me-2"},null,-1),Ve=B({__name:"index",setup(r){const t=v("1"),a=v(),l=v(!1),_=v(1);function g(c){t.value="1",a.value={...c},l.value=!0}function f(){l.value=!1}function e(c){_.value+=1,c!==void 0&&(l.value=c)}return(c,p)=>{const m=me,b=V,M=ce;return y(),H("div",null,[o(M,{class:"input-browse-tab",activeKey:t.value,"onUpdate:activeKey":p[1]||(p[1]=x=>t.value=x),animated:""},oe({default:i(()=>[o(m,{key:"1"},{tab:i(()=>[De]),default:i(()=>[o(ye,{"form-data":a.value,"edit-mode":l.value,onCancelEdit:f,onOnSuccess:e},null,8,["form-data","edit-mode"])]),_:1}),o(m,{key:"2"},{tab:i(()=>[ke]),default:i(()=>[o(Ce,{idx:_.value,onRowClick:g},null,8,["idx"])]),_:1})]),_:2},[t.value==="2"?{name:"rightExtra",fn:i(()=>[o(b,{size:"small",class:"mt-3",onClick:p[0]||(p[0]=x=>_.value+=1)},{default:i(()=>[xe,h(" Refresh Data ")]),_:1})]),key:"0"}:void 0]),1032,["activeKey"])])}}});export{Ve as default};
