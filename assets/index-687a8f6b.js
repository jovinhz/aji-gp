import{B as I}from"./index-0bb8ea7a.js";import{_ as X}from"./AgGrid.vuevuetypescriptsetuptruelang-7e3c6181.js";import{o as Y,a as j}from"./index-a69e05bf.js";import"./index-db653870.js";import{_ as Z}from"./index-660196b9.js";import{_ as ee,S as ae}from"./index-6aba2020.js";/* empty css              */import{u as M}from"./HttpClient-a8d470b1.js";import{_ as te}from"./InputDropdown.vuevuetypescriptsetuptruelang-94aa0dee.js";import{P as C}from"./ProductService-a6787d37.js";import{_ as oe}from"./TextArea-fa00ec12.js";import"./index-f4b315b9.js";import{d as E,r as h,Q as O,w as V,e as q,g as v,a7 as S,ac as s,j as N,k as n,a9 as g,b as t,u as w,F as ne,ab as ie,aa as K,ae as se,ak as re}from"./plugin-vueexport-helper-23a171d5.js";import{M as le}from"./Modal-5e5e8906.js";import{_ as de}from"./index-2b5a45ec.js";import{I as ue,_ as me,F as ce}from"./Input-6750102f.js";import{T as _e,_ as fe}from"./TabPane-6246fdd8.js";import"./DownOutlined-4b2aeb27.js";import"./pickAttrs-349b6a5f.js";import"./useMemo-18bb8ebc.js";import"./SearchOutlined-731e9f20.js";import"./Password-013faafa.js";const pe={class:"card card-custom card-dense"},ve={class:"card-header"},ge={class:"card-title w-100 d-flex justify-content-between"},ke=s("h4",{class:"card-label"},"Form Master Produk",-1),ye={class:"card-body"},he={class:"row"},xe={class:"col-lg-6"},be=s("i",{class:"fe fe-save me-2"},null,-1),we=E({__name:"Form",props:{formData:null,editMode:{type:Boolean}},emits:["cancelEdit","onSuccess"],setup(m,{emit:c}){const i=m,p=[{field:"code",headerName:"Kode Satuan"},{field:"name",headerName:"Nama Satuan"}],r=h(""),k=h(),_=h(),e=O({}),d={unit_id:[{required:!0,message:"Satuan wajib dipilih",trigger:"change"}],category_id:[{required:!0,message:"Kategori wajib dipilih",trigger:"change"}],code:[{required:!0,message:"Kode produk wajib diisi",trigger:"change"}],name:[{required:!0,message:"Nama produk wajib diisi",trigger:"change"}]},{run:f,loading:u,response:x}=M(),{run:$,loading:D,response:U}=M(),{run:Se,loading:H,response:$e}=M();async function z(){var l,o;try{i.editMode?await f(C.update(i.formData.id,{category_id:e.category_id,unit_id:e.unit_id,name:e.name,description:e.description,maximum_stock:e.maximum_stock,minumum_stock:e.maximum_stock})):(await f(C.create({code:e.code.toUpperCase(),category_id:e.category_id,name:e.name,unit_id:e.unit_id,description:e.description,maximum_stock:e.maximum_stock,minumum_stock:e.minumum_stock})),(l=x.value)!=null&&l.success&&P()),(o=x.value)!=null&&o.success&&c("onSuccess")}catch{}}async function A(){}function P(){var l;if(i.editMode){for(const o in e)e[o]=void 0;c("cancelEdit"),r.value=""}else(l=_.value)==null||l.resetFields(),r.value=""}function G(){le.confirm({title:"Konfirmasi Hapus Produk",content:"Apakah kamu sudah yakin ingin menghapus data [Edit Here]",cancelText:"Batal",onOk:A})}return V(()=>i.formData,()=>{var l;i.formData&&((l=_.value)==null||l.clearValidate(),e.code=i.formData.code,e.category_id=i.formData.category_id,e.description=i.formData.description,e.maximum_stock=parseInt(i.formData.maximum_stock,10),e.minumum_stock=parseInt(i.formData.minimum_stock,10),e.name=i.formData.name,e.unit_id=i.formData.unit.id,r.value=`${i.formData.unit.code} - ${i.formData.unit.name}`)}),q(async()=>{var l;try{await $(C.formOptions()),(l=U.value)!=null&&l.success&&(k.value=U.value.data)}catch{}}),(l,o)=>{const B=de,T=ue,y=me,L=ae,Q=ee,J=oe,R=Z,F=I,W=ce;return v(),S("div",pe,[s("div",ve,[s("div",ge,[ke,m.editMode?(v(),N(B,{key:0,color:"orange"},{default:n(()=>[g("Mode Edit")]),_:1})):(v(),N(B,{key:1,color:"cyan"},{default:n(()=>[g("Mode Input")]),_:1}))])]),s("div",ye,[t(W,{ref_key:"formRef",ref:_,model:e,rules:d,"label-col":{style:{width:"220px"}},colon:!1,"label-align":"left",onFinish:o[7]||(o[7]=a=>w(Y)(_.value,z))},{default:n(()=>[s("div",he,[s("div",xe,[t(y,{label:"Kode Produk",name:"code",ref:"code"},{default:n(()=>[t(T,{value:e.code,"onUpdate:value":o[0]||(o[0]=a=>e.code=a),valueModifiers:{trim:!0},style:{"text-transform":"uppercase"},disabled:m.editMode},null,8,["value","disabled"])]),_:1},512),t(y,{label:"Nama Produk",name:"name",ref:"name"},{default:n(()=>[t(T,{value:e.name,"onUpdate:value":o[1]||(o[1]=a=>e.name=a)},null,8,["value"])]),_:1},512),t(y,{label:"Satuan",name:"unit_id",ref:"unit_id"},{default:n(()=>{var a;return[t(te,{"column-defs":p,"grid-data":((a=k.value)==null?void 0:a.units)??[],loading:w(D),value:void 0,"value-display":r.value,onChange:o[2]||(o[2]=b=>{e.unit_id=b.id,r.value=`${b.code} - ${b.name}`})},null,8,["grid-data","loading","value-display"])]}),_:1},512),t(y,{label:"Kategori Produk",name:"category_id",ref:"category_id"},{default:n(()=>[t(Q,{value:e.category_id,"onUpdate:value":o[3]||(o[3]=a=>e.category_id=a)},{default:n(()=>{var a;return[(v(!0),S(ne,null,ie((a=k.value)==null?void 0:a.categories,b=>(v(),N(L,{value:b.id},{default:n(()=>[g(K(b.title),1)]),_:2},1032,["value"]))),256))]}),_:1},8,["value"])]),_:1},512),t(y,{label:"Deskripsi",name:"description",ref:"description"},{default:n(()=>[t(J,{value:e.description,"onUpdate:value":o[4]||(o[4]=a=>e.description=a)},null,8,["value"])]),_:1},512),t(y,{label:"Mininum Stok",name:"minimal_stock",ref:"minimal_stock"},{default:n(()=>[t(R,{value:e.minumum_stock,"onUpdate:value":o[5]||(o[5]=a=>e.minumum_stock=a),min:0,formatter:a=>`${a}`.replace(/\B(?=(\d{3})+(?!\d))/g,"."),parser:a=>a.replace(/\$\s?|(\.*)/g,"")},null,8,["value","formatter","parser"])]),_:1},512),t(y,{label:"Maksimum Stok",name:"maximum_stock",ref:"maximum_stock"},{default:n(()=>[t(R,{value:e.maximum_stock,"onUpdate:value":o[6]||(o[6]=a=>e.maximum_stock=a),min:0,formatter:a=>`${a}`.replace(/\B(?=(\d{3})+(?!\d))/g,"."),parser:a=>a.replace(/\$\s?|(\.*)/g,"")},null,8,["value","formatter","parser"])]),_:1},512),t(F,{type:"primary","html-type":"submit",loading:w(u)},{default:n(()=>[be,s("span",null,K(m.editMode?"Edit":"Simpan"),1)]),_:1},8,["loading"]),t(F,{class:"mx-3",onClick:P},{default:n(()=>[g(K(m.editMode?"Batal Edit":"Bersihkan"),1)]),_:1}),m.editMode?(v(),N(F,{key:0,danger:"",type:"primary",onClick:G,loading:w(H)},{default:n(()=>[g(" Hapus ")]),_:1},8,["loading"])):se("",!0)])])]),_:1},8,["model"])])])}}}),De=E({__name:"DataTable",props:{idx:null},emits:["rowClick"],setup(m,{emit:c}){const i=m,p=O({value:[{field:"code",headerName:"Kode Produk",flex:0,width:150,pinned:"left"},{field:"name",headerName:"Nama",flex:0,width:200,pinned:"left"},{field:"category_caption",headerName:"Kategori",flex:0,width:100},{field:"unit.name",headerName:"Satuan",flex:0,width:90},{field:"minimum_stock",headerName:"Min Stok",flex:0,width:100,filter:"agNumberColumnFilter",type:"numericColumn"},{field:"maximum_stock",headerName:"Max Stok",flex:0,width:100,filter:"agNumberColumnFilter",type:"numericColumn"},{field:"description",headerName:"Deskripsi",flex:0,width:100},{field:"created_at",headerName:"Diinput Tgl",...j},{field:"updated_at",headerName:"Diupdate Tgl",...j},{field:"created_by_user_username",headerName:"Diinput Oleh",flex:0,width:120},{field:"updated_by_user_username",headerName:"Diupdate Oleh",flex:0,width:120}]}),r=O({value:null}),{run:k,response:_,loading:e}=M();async function d(){var u;try{await k(C.list()),(u=_.value)!=null&&u.success&&(r.value=_.value.data)}catch{}}function f(u){c("rowClick",u)}return q(()=>{d()}),V(()=>i.idx,()=>{d()}),(u,x)=>(v(),S("div",null,[t(X,{"row-data":r.value,"column-defs":p.value,loading:w(e),onRowClick:f},null,8,["row-data","column-defs","loading"])]))}}),Ne=s("span",null,[s("i",{class:"fe fe-edit-2 me-2"}),g(" Input ")],-1),Me=s("span",null,[s("i",{class:"fe fe-search me-2"}),g(" Browse ")],-1),Ce=s("i",{class:"fe fe-refresh-cw me-2"},null,-1),Ye=E({__name:"index",setup(m){const c=h("1"),i=h(),p=h(!1),r=h(1);function k(d){c.value="1",i.value={...d},p.value=!0}function _(){p.value=!1}function e(d){r.value+=1,d!==void 0&&(p.value=d)}return(d,f)=>{const u=fe,x=I,$=_e;return v(),S("div",null,[t($,{class:"input-browse-tab",activeKey:c.value,"onUpdate:activeKey":f[1]||(f[1]=D=>c.value=D),animated:""},re({default:n(()=>[t(u,{key:"1"},{tab:n(()=>[Ne]),default:n(()=>[t(we,{"form-data":i.value,"edit-mode":p.value,onCancelEdit:_,onOnSuccess:e},null,8,["form-data","edit-mode"])]),_:1}),t(u,{key:"2"},{tab:n(()=>[Me]),default:n(()=>[t(De,{idx:r.value,onRowClick:k},null,8,["idx"])]),_:1})]),_:2},[c.value==="2"?{name:"rightExtra",fn:n(()=>[t(x,{size:"small",class:"mt-3",onClick:f[0]||(f[0]=D=>r.value+=1)},{default:n(()=>[Ce,g(" Refresh Data ")]),_:1})]),key:"0"}:void 0]),1032,["activeKey"])])}}});export{Ye as default};
