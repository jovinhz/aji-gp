import{B as j}from"./index-153eefc2.js";import{_ as Z}from"./AgGrid.vuevuetypescriptsetuptruelang-ab13ecb9.js";import{o as ee,a as I}from"./index-88aa8355.js";import"./index-7c3bc22f.js";import{_ as ae}from"./index-1212a0e4.js";import{_ as te,S as oe}from"./index-fcb540cd.js";/* empty css              */import{u as C}from"./HttpClient-9b37a6d8.js";import{_ as ne}from"./InputDropdown.vuevuetypescriptsetuptruelang-d8e7c5f6.js";import{P as D}from"./ProductService-6eb59271.js";import{_ as ie}from"./TextArea-dca2e1fe.js";import"./index-cfba9875.js";import{d as U,r as h,O as E,w as V,a as q,e as v,a7 as $,ac as s,f as S,g as n,a9 as g,c as o,u as w,F as re,ab as se,aa as O,ae as le,ak as de}from"./plugin-vueexport-helper-0ef99882.js";import{M as ue}from"./Modal-dae6d828.js";import{_ as me}from"./index-a1c3b359.js";import{I as ce,_ as _e,F as fe}from"./Input-df745255.js";import{T as pe,_ as ve}from"./TabPane-a6349958.js";import"./DownOutlined-80526c88.js";import"./pickAttrs-596f35c3.js";import"./useMemo-49158cc8.js";import"./CheckOutlined-94b1a800.js";import"./SearchOutlined-1764655a.js";import"./Password-77a8db80.js";import"./EyeOutlined-308ec9ea.js";const ge={class:"card card-custom card-dense"},ke={class:"card-header"},ye={class:"card-title w-100 d-flex justify-content-between"},he=s("h4",{class:"card-label"},"Form Master Produk",-1),xe={class:"card-body"},be={class:"row"},De={class:"col-lg-6"},we=s("i",{class:"fe fe-save me-2"},null,-1),Ne=U({__name:"Form",props:{formData:null,editMode:{type:Boolean}},emits:["cancelEdit","onSuccess"],setup(c,{emit:d}){const i=c,p=[{field:"code",headerName:"Kode Satuan"},{field:"name",headerName:"Nama Satuan"}],l=h(""),k=h(),_=h(),e=E({}),u={unit_id:[{required:!0,message:"Satuan wajib dipilih",trigger:"change"}],category_id:[{required:!0,message:"Kategori wajib dipilih",trigger:"change"}],code:[{required:!0,message:"Kode produk wajib diisi",trigger:"change"}],name:[{required:!0,message:"Nama produk wajib diisi",trigger:"change"}]},{run:f,loading:m,response:x}=C(),{run:B,loading:N,response:P}=C(),{run:H,loading:z,response:A}=C();async function G(){var r,t;try{i.editMode?await f(D.update(i.formData.id,{category_id:e.category_id,unit_id:e.unit_id,name:e.name,description:e.description,maximum_stock:e.maximum_stock,minumum_stock:e.maximum_stock})):(await f(D.create({code:e.code.toUpperCase(),category_id:e.category_id,name:e.name,unit_id:e.unit_id,description:e.description,maximum_stock:e.maximum_stock,minumum_stock:e.minumum_stock})),(r=x.value)!=null&&r.success&&F()),(t=x.value)!=null&&t.success&&d("onSuccess")}catch{}}async function L(){var r,t;try{await H(D.delete((r=i.formData)==null?void 0:r.id)),(t=A.value)!=null&&t.success&&(F(),d("onSuccess"))}catch{}}function F(){var r;if(i.editMode){for(const t in e)e[t]=void 0;d("cancelEdit"),l.value=""}else(r=_.value)==null||r.resetFields(),l.value=""}function J(){var r;ue.confirm({title:"Konfirmasi Hapus Produk",content:`Apakah kamu sudah yakin ingin menghapus data ${(r=i.formData)==null?void 0:r.code} ?`,cancelText:"Batal",onOk:L})}return V(()=>i.formData,()=>{var r;i.formData&&((r=_.value)==null||r.clearValidate(),e.code=i.formData.code,e.category_id=i.formData.category_id,e.description=i.formData.description,e.maximum_stock=parseInt(i.formData.maximum_stock,10),e.minumum_stock=parseInt(i.formData.minimum_stock,10),e.name=i.formData.name,e.unit_id=i.formData.unit.id,l.value=`${i.formData.unit.code} - ${i.formData.unit.name}`)}),q(async()=>{var r;try{await B(D.formOptions()),(r=P.value)!=null&&r.success&&(k.value=P.value.data)}catch{}}),(r,t)=>{const M=me,T=ce,y=_e,Q=oe,W=te,X=ie,R=ae,K=j,Y=fe;return v(),$("div",ge,[s("div",ke,[s("div",ye,[he,c.editMode?(v(),S(M,{key:0,color:"orange"},{default:n(()=>[g("Mode Edit")]),_:1})):(v(),S(M,{key:1,color:"cyan"},{default:n(()=>[g("Mode Input")]),_:1}))])]),s("div",xe,[o(Y,{ref_key:"formRef",ref:_,model:e,rules:u,"label-col":{style:{width:"220px"}},colon:!1,"label-align":"left",onFinish:t[7]||(t[7]=a=>w(ee)(_.value,G))},{default:n(()=>[s("div",be,[s("div",De,[o(y,{label:"Kode Produk",name:"code",ref:"code"},{default:n(()=>[o(T,{value:e.code,"onUpdate:value":t[0]||(t[0]=a=>e.code=a),valueModifiers:{trim:!0},style:{"text-transform":"uppercase"},disabled:c.editMode},null,8,["value","disabled"])]),_:1},512),o(y,{label:"Nama Produk",name:"name",ref:"name"},{default:n(()=>[o(T,{value:e.name,"onUpdate:value":t[1]||(t[1]=a=>e.name=a)},null,8,["value"])]),_:1},512),o(y,{label:"Satuan",name:"unit_id",ref:"unit_id"},{default:n(()=>{var a;return[o(ne,{"column-defs":p,"grid-data":((a=k.value)==null?void 0:a.units)??[],loading:w(N),value:void 0,"value-display":l.value,onChange:t[2]||(t[2]=b=>{e.unit_id=b.id,l.value=`${b.code} - ${b.name}`})},null,8,["grid-data","loading","value-display"])]}),_:1},512),o(y,{label:"Kategori Produk",name:"category_id",ref:"category_id"},{default:n(()=>[o(W,{value:e.category_id,"onUpdate:value":t[3]||(t[3]=a=>e.category_id=a)},{default:n(()=>{var a;return[(v(!0),$(re,null,se((a=k.value)==null?void 0:a.categories,b=>(v(),S(Q,{value:b.id},{default:n(()=>[g(O(b.title),1)]),_:2},1032,["value"]))),256))]}),_:1},8,["value"])]),_:1},512),o(y,{label:"Deskripsi",name:"description",ref:"description"},{default:n(()=>[o(X,{value:e.description,"onUpdate:value":t[4]||(t[4]=a=>e.description=a)},null,8,["value"])]),_:1},512),o(y,{label:"Mininum Stok",name:"minimal_stock",ref:"minimal_stock"},{default:n(()=>[o(R,{value:e.minumum_stock,"onUpdate:value":t[5]||(t[5]=a=>e.minumum_stock=a),min:0,formatter:a=>`${a}`.replace(/\B(?=(\d{3})+(?!\d))/g,"."),parser:a=>a.replace(/\$\s?|(\.*)/g,"")},null,8,["value","formatter","parser"])]),_:1},512),o(y,{label:"Maksimum Stok",name:"maximum_stock",ref:"maximum_stock"},{default:n(()=>[o(R,{value:e.maximum_stock,"onUpdate:value":t[6]||(t[6]=a=>e.maximum_stock=a),min:0,formatter:a=>`${a}`.replace(/\B(?=(\d{3})+(?!\d))/g,"."),parser:a=>a.replace(/\$\s?|(\.*)/g,"")},null,8,["value","formatter","parser"])]),_:1},512),o(K,{type:"primary","html-type":"submit",loading:w(m)},{default:n(()=>[we,s("span",null,O(c.editMode?"Edit":"Simpan"),1)]),_:1},8,["loading"]),o(K,{class:"mx-3",onClick:F},{default:n(()=>[g(O(c.editMode?"Batal Edit":"Bersihkan"),1)]),_:1}),c.editMode?(v(),S(K,{key:0,danger:"",type:"primary",onClick:J,loading:w(z)},{default:n(()=>[g(" Hapus ")]),_:1},8,["loading"])):le("",!0)])])]),_:1},8,["model"])])])}}}),Me=U({__name:"DataTable",props:{idx:null},emits:["rowClick"],setup(c,{emit:d}){const i=c,p=E({value:[{field:"code",headerName:"Kode Produk",flex:0,width:150,pinned:"left"},{field:"name",headerName:"Nama",flex:0,width:200,pinned:"left"},{field:"category_caption",headerName:"Kategori",flex:0,width:100},{field:"unit.name",headerName:"Satuan",flex:0,width:90},{field:"minimum_stock",headerName:"Min Stok",flex:0,width:100,filter:"agNumberColumnFilter",type:"numericColumn"},{field:"maximum_stock",headerName:"Max Stok",flex:0,width:100,filter:"agNumberColumnFilter",type:"numericColumn"},{field:"description",headerName:"Deskripsi",flex:0,width:100},{field:"created_at",headerName:"Diinput Tgl",...I},{field:"updated_at",headerName:"Diupdate Tgl",...I},{field:"created_by_user_username",headerName:"Diinput Oleh",flex:0,width:120},{field:"updated_by_user_username",headerName:"Diupdate Oleh",flex:0,width:120}]}),l=E({value:null}),{run:k,response:_,loading:e}=C();async function u(){var m;try{await k(D.list()),(m=_.value)!=null&&m.success&&(l.value=_.value.data)}catch{}}function f(m){d("rowClick",m)}return q(()=>{u()}),V(()=>i.idx,()=>{u()}),(m,x)=>(v(),$("div",null,[o(Z,{"row-data":l.value,"column-defs":p.value,loading:w(e),onRowClick:f},null,8,["row-data","column-defs","loading"])]))}}),Se=s("span",null,[s("i",{class:"fe fe-edit-2 me-2"}),g(" Input ")],-1),Ce=s("span",null,[s("i",{class:"fe fe-search me-2"}),g(" Browse ")],-1),$e=s("i",{class:"fe fe-refresh-cw me-2"},null,-1),ea=U({__name:"index",setup(c){const d=h("1"),i=h(),p=h(!1),l=h(1);function k(u){d.value="1",i.value={...u},p.value=!0}function _(){p.value=!1}function e(u){l.value+=1,u!==void 0&&(p.value=u)}return(u,f)=>{const m=ve,x=j,B=pe;return v(),$("div",null,[o(B,{class:"input-browse-tab",activeKey:d.value,"onUpdate:activeKey":f[1]||(f[1]=N=>d.value=N),animated:""},de({default:n(()=>[o(m,{key:"1"},{tab:n(()=>[Se]),default:n(()=>[o(Ne,{"form-data":i.value,"edit-mode":p.value,onCancelEdit:_,onOnSuccess:e},null,8,["form-data","edit-mode"])]),_:1}),o(m,{key:"2"},{tab:n(()=>[Ce]),default:n(()=>[o(Me,{idx:l.value,onRowClick:k},null,8,["idx"])]),_:1})]),_:2},[d.value==="2"?{name:"rightExtra",fn:n(()=>[o(x,{size:"small",class:"mt-3",onClick:f[0]||(f[0]=N=>l.value+=1)},{default:n(()=>[$e,g(" Refresh Data ")]),_:1})]),key:"0"}:void 0]),1032,["activeKey"])])}}});export{ea as default};
