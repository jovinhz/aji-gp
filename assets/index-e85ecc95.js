var X=Object.defineProperty;var Z=(l,s,a)=>s in l?X(l,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):l[s]=a;var T=(l,s,a)=>(Z(l,typeof s!="symbol"?s+"":s,a),a);import{B as j}from"./index-c2b9e26d.js";import{_ as ee}from"./AgGrid.vuevuetypescriptsetuptruelang-57924cd0.js";import{H as ae,u as N,o as te,a as R}from"./HttpClient-05f26028.js";import{I as oe,Y as ne,F as ie}from"./index-d35a0029.js";import{_ as se}from"./index-81b2037c.js";import{_ as le,S as re}from"./index-2ff3d0ef.js";import{_ as de}from"./InputDropdown.vuevuetypescriptsetuptruelang-e85e0881.js";import{_ as ue}from"./TextArea-9d658de9.js";import"./index-41511ccf.js";import{d as E,r as y,Q as K,w as V,e as q,g,a7 as S,ac as r,j as M,k as i,a9 as v,b as o,u as w,F as ce,ab as me,aa as B,ae as _e,ak as fe}from"./plugin-vueexport-helper-23a171d5.js";import{M as pe}from"./Modal-3e6de3d8.js";import{_ as ge,T as ve,a as ke}from"./index-69e0b682.js";import"./SearchOutlined-c93a7c7c.js";import"./Password-ba2b84e5.js";class D{static list(){return this.HttpClient.axiosInstance.get("/products")}static create(s){return this.HttpClient.withOptions({showSuccessFeedback:!0,successFeedbackMessage:"Produk berhasil ditambah"}).axiosInstance.post("/products",s)}static update(s,a){return this.HttpClient.withOptions({showSuccessFeedback:!0,successFeedbackMessage:"Produk berhasil diupdate"}).axiosInstance.put(`/products/${s}`,a)}static formOptions(){return this.HttpClient.axiosInstance.get("/products/form_options")}}T(D,"HttpClient",new ae);const he={class:"card card-custom card-dense"},ye={class:"card-header"},be={class:"card-title w-100 d-flex justify-content-between"},xe=r("h4",{class:"card-label"},"Form Master Produk",-1),we={class:"card-body"},De={class:"row"},Ce={class:"col-lg-6"},Me=r("i",{class:"fe fe-save me-2"},null,-1),Ne=E({__name:"Form",props:{formData:null,editMode:{type:Boolean}},emits:["cancelEdit","onSuccess"],setup(l,{emit:s}){const a=l,p=[{field:"code",headerName:"Kode Satuan"},{field:"name",headerName:"Nama Satuan"}],d=y(""),k=y(),_=y(),e=K({}),c={unit_id:[{required:!0,message:"Satuan wajib dipilih",trigger:"change"}],category_id:[{required:!0,message:"Kategori wajib dipilih",trigger:"change"}],code:[{required:!0,message:"Kode produk wajib diisi",trigger:"change"}],name:[{required:!0,message:"Nama produk wajib diisi",trigger:"change"}]},{run:f,loading:m,response:b}=N(),{run:$,loading:C,response:H}=N(),{run:Be,loading:z,response:Ke}=N();async function A(){var u,n;try{a.editMode?await f(D.update(a.formData.id,{category_id:e.category_id,unit_id:e.unit_id,name:e.name,description:e.description,maximum_stock:e.maximum_stock,minumum_stock:e.maximum_stock})):(await f(D.create({code:e.code.toUpperCase(),category_id:e.category_id,name:e.name,unit_id:e.unit_id,description:e.description,maximum_stock:e.maximum_stock,minumum_stock:e.minumum_stock})),(u=b.value)!=null&&u.success&&I()),(n=b.value)!=null&&n.success&&s("onSuccess")}catch{}}async function G(){}function I(){var u;if(a.editMode){for(const n in e)e[n]=void 0;s("cancelEdit"),d.value=""}else(u=_.value)==null||u.resetFields(),d.value=""}function L(){pe.confirm({title:"Konfirmasi Hapus Produk",content:"Apakah kamu sudah yakin ingin menghapus data [Edit Here]",cancelText:"Batal",onOk:G})}return V(()=>a.formData,()=>{var u;a.formData&&((u=_.value)==null||u.clearValidate(),e.code=a.formData.code,e.category_id=a.formData.category_id,e.description=a.formData.description,e.maximum_stock=parseInt(a.formData.maximum_stock,10),e.minumum_stock=parseInt(a.formData.minimum_stock,10),e.name=a.formData.name,e.unit_id=a.formData.unit.id,d.value=`${a.formData.unit.code} - ${a.formData.unit.name}`)}),q(async()=>{var u;try{await $(D.formOptions()),(u=H.value)!=null&&u.success&&(k.value=H.value.data)}catch{}}),(u,n)=>{const F=ge,U=oe,h=ne,Q=re,Y=le,J=ue,P=se,O=j,W=ie;return g(),S("div",he,[r("div",ye,[r("div",be,[xe,l.editMode?(g(),M(F,{key:0,color:"orange"},{default:i(()=>[v("Mode Edit")]),_:1})):(g(),M(F,{key:1,color:"cyan"},{default:i(()=>[v("Mode Input")]),_:1}))])]),r("div",we,[o(W,{ref_key:"formRef",ref:_,model:e,rules:c,"label-col":{style:{width:"220px"}},colon:!1,"label-align":"left",onFinish:n[7]||(n[7]=t=>w(te)(_.value,A))},{default:i(()=>[r("div",De,[r("div",Ce,[o(h,{label:"Kode Produk",name:"code",ref:"code"},{default:i(()=>[o(U,{value:e.code,"onUpdate:value":n[0]||(n[0]=t=>e.code=t),valueModifiers:{trim:!0},style:{"text-transform":"uppercase"},disabled:l.editMode},null,8,["value","disabled"])]),_:1},512),o(h,{label:"Nama Produk",name:"name",ref:"name"},{default:i(()=>[o(U,{value:e.name,"onUpdate:value":n[1]||(n[1]=t=>e.name=t)},null,8,["value"])]),_:1},512),o(h,{label:"Satuan",name:"unit_id",ref:"unit_id"},{default:i(()=>{var t;return[o(de,{"column-defs":p,"grid-data":((t=k.value)==null?void 0:t.units)??[],loading:w(C),value:void 0,"value-display":d.value,onChange:n[2]||(n[2]=x=>{e.unit_id=x.id,d.value=`${x.code} - ${x.name}`})},null,8,["grid-data","loading","value-display"])]}),_:1},512),o(h,{label:"Kategori Produk",name:"category_id",ref:"category_id"},{default:i(()=>[o(Y,{value:e.category_id,"onUpdate:value":n[3]||(n[3]=t=>e.category_id=t)},{default:i(()=>{var t;return[(g(!0),S(ce,null,me((t=k.value)==null?void 0:t.categories,x=>(g(),M(Q,{value:x.id},{default:i(()=>[v(B(x.title),1)]),_:2},1032,["value"]))),256))]}),_:1},8,["value"])]),_:1},512),o(h,{label:"Deskripsi",name:"description",ref:"description"},{default:i(()=>[o(J,{value:e.description,"onUpdate:value":n[4]||(n[4]=t=>e.description=t)},null,8,["value"])]),_:1},512),o(h,{label:"Mininum Stok",name:"minimal_stock",ref:"minimal_stock"},{default:i(()=>[o(P,{value:e.minumum_stock,"onUpdate:value":n[5]||(n[5]=t=>e.minumum_stock=t),min:0,formatter:t=>`${t}`.replace(/\B(?=(\d{3})+(?!\d))/g,"."),parser:t=>t.replace(/\$\s?|(\.*)/g,"")},null,8,["value","formatter","parser"])]),_:1},512),o(h,{label:"Maksimum Stok",name:"maximum_stock",ref:"maximum_stock"},{default:i(()=>[o(P,{value:e.maximum_stock,"onUpdate:value":n[6]||(n[6]=t=>e.maximum_stock=t),min:0,formatter:t=>`${t}`.replace(/\B(?=(\d{3})+(?!\d))/g,"."),parser:t=>t.replace(/\$\s?|(\.*)/g,"")},null,8,["value","formatter","parser"])]),_:1},512),o(O,{type:"primary","html-type":"submit",loading:w(m)},{default:i(()=>[Me,r("span",null,B(l.editMode?"Edit":"Simpan"),1)]),_:1},8,["loading"]),o(O,{class:"mx-3",onClick:I},{default:i(()=>[v(B(l.editMode?"Batal Edit":"Bersihkan"),1)]),_:1}),l.editMode?(g(),M(O,{key:0,danger:"",type:"primary",onClick:L,loading:w(z)},{default:i(()=>[v(" Hapus ")]),_:1},8,["loading"])):_e("",!0)])])]),_:1},8,["model"])])])}}}),Se=E({__name:"DataTable",props:{idx:null},emits:["rowClick"],setup(l,{emit:s}){const a=l,p=K({value:[{field:"code",headerName:"Kode Produk",flex:0,width:150,pinned:"left"},{field:"name",headerName:"Nama",flex:0,width:200,pinned:"left"},{field:"category_caption",headerName:"Kategori",flex:0,width:100},{field:"unit.name",headerName:"Satuan",flex:0,width:90},{field:"minimum_stock",headerName:"Min Stok",flex:0,width:100,filter:"agNumberColumnFilter",type:"numericColumn"},{field:"maximum_stock",headerName:"Max Stok",flex:0,width:100,filter:"agNumberColumnFilter",type:"numericColumn"},{field:"description",headerName:"Deskripsi",flex:0,width:100},{field:"created_at",headerName:"Diinput Tgl",...R},{field:"updated_at",headerName:"Diupdate Tgl",...R},{field:"created_by_user_username",headerName:"Diinput Oleh",flex:0,width:120},{field:"updated_by_user_username",headerName:"Diupdate Oleh",flex:0,width:120}]}),d=K({value:null}),{run:k,response:_,loading:e}=N();async function c(){var m;try{await k(D.list()),(m=_.value)!=null&&m.success&&(d.value=_.value.data)}catch{}}function f(m){s("rowClick",m)}return q(()=>{c()}),V(()=>a.idx,()=>{c()}),(m,b)=>(g(),S("div",null,[o(ee,{"row-data":d.value,"column-defs":p.value,loading:w(e),onRowClick:f},null,8,["row-data","column-defs","loading"])]))}}),$e=r("span",null,[r("i",{class:"fe fe-edit-2 me-2"}),v(" Input ")],-1),Fe=r("span",null,[r("i",{class:"fe fe-search me-2"}),v(" Browse ")],-1),Oe=r("i",{class:"fe fe-refresh-cw me-2"},null,-1),Ye=E({__name:"index",setup(l){const s=y("1"),a=y(),p=y(!1),d=y(1);function k(c){s.value="1",a.value={...c},p.value=!0}function _(){p.value=!1}function e(c){d.value+=1,c!==void 0&&(p.value=c)}return(c,f)=>{const m=ke,b=j,$=ve;return g(),S("div",null,[o($,{class:"input-browse-tab",activeKey:s.value,"onUpdate:activeKey":f[1]||(f[1]=C=>s.value=C),animated:""},fe({default:i(()=>[o(m,{key:"1"},{tab:i(()=>[$e]),default:i(()=>[o(Ne,{"form-data":a.value,"edit-mode":p.value,onCancelEdit:_,onOnSuccess:e},null,8,["form-data","edit-mode"])]),_:1}),o(m,{key:"2"},{tab:i(()=>[Fe]),default:i(()=>[o(Se,{idx:d.value,onRowClick:k},null,8,["idx"])]),_:1})]),_:2},[s.value==="2"?{name:"rightExtra",fn:i(()=>[o(b,{size:"small",class:"mt-3",onClick:f[0]||(f[0]=C=>d.value+=1)},{default:i(()=>[Oe,v(" Refresh Data ")]),_:1})]),key:"0"}:void 0]),1032,["activeKey"])])}}});export{Ye as default};
