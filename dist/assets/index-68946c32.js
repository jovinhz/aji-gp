var L=Object.defineProperty;var P=(i,t,a)=>t in i?L(i,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):i[t]=a;var T=(i,t,a)=>(P(i,typeof t!="symbol"?t+"":t,a),a);import{B as V}from"./index-c2b9e26d.js";import{_ as W}from"./AgGrid.vuevuetypescriptsetuptruelang-57924cd0.js";import{H as X,u as N,o as Z,a as R}from"./HttpClient-05f26028.js";import{I as ee,Y as ae,F as te}from"./index-d35a0029.js";import{_ as oe}from"./InputDropdown.vuevuetypescriptsetuptruelang-e85e0881.js";import{d as B,r as v,Q as K,w as A,e as q,g as w,a7 as E,ac as d,j as O,k as n,a9 as h,b as o,u as D,aa as j,ae as se,ak as ne}from"./plugin-vueexport-helper-23a171d5.js";import{M as ie}from"./Modal-3e6de3d8.js";import{_ as de,T as le,a as re}from"./index-69e0b682.js";import{_ as ue}from"./TextArea-9d658de9.js";class k{static list(){return this.HttpClient.axiosInstance.get("/customer_units")}static create(t){return this.HttpClient.withOptions({showSuccessFeedback:!0,successFeedbackMessage:"Customer Unit berhasil ditambah"}).axiosInstance.post("/customer_units",t)}static update(t,a){return this.HttpClient.withOptions({showSuccessFeedback:!0,successFeedbackMessage:"Customer Unit berhasil diupdate"}).axiosInstance.put(`/customer_units/${t}`,a)}static formOptions(){return this.HttpClient.axiosInstance.get("/customer_units/form_options")}}T(k,"HttpClient",new X);const ce={class:"card card-custom card-dense"},me={class:"card-header"},fe={class:"card-title w-100 d-flex justify-content-between"},_e=d("h4",{class:"card-label"},"Form Master Customer Unit",-1),pe={class:"card-body"},ve={class:"row"},he={class:"col-lg-6"},ge=d("i",{class:"fe fe-save me-2"},null,-1),be=B({__name:"Form",props:{formData:null,editMode:{type:Boolean}},emits:["cancelEdit","onSuccess"],setup(i,{emit:t}){const a=i,r=v(""),p=[{field:"code",headerName:"Kode Customer",flex:0,width:140},{field:"name",headerName:"Nama Customer"},{field:"customer_group.code",headerName:"Kode Grup",flex:0,width:120},{field:"customer_group.name",headerName:"Nama Grup"},{field:"address",headerName:"Alamat"}],g=v(),f=v(),e=K({}),c={code:[{required:!0,message:"Kode unit wajib diisi",trigger:"change"}],name:[{required:!0,message:"Nama unit wajib diisi",trigger:"change"}],customer_id:[{required:!0,message:"Customer wajib dipilih",trigger:"change"}]},{run:_,loading:m,response:b}=N(),{run:M,loading:x,response:H}=N(),{run:ke,loading:G,response:xe}=N();async function z(){var l,s,y;try{a.editMode?await _(k.update((l=a.formData)==null?void 0:l.id,{customer_id:e.customer_id,name:e.name,address:e.address,note:e.note})):(await _(k.create({code:e.code.toUpperCase(),customer_id:e.customer_id,name:e.name,address:e.address,note:e.note})),(s=b.value)!=null&&s.success&&S()),(y=b.value)!=null&&y.success&&t("onSuccess")}catch{}}async function Q(){}function S(){var l;if(a.editMode){for(const s in e)e[s]=void 0;t("cancelEdit")}else(l=f.value)==null||l.resetFields();r.value=""}function Y(){ie.confirm({title:"Konfirmasi Hapus Unit",content:"Apakah kamu sudah yakin ingin menghapus data [Edit Here]",cancelText:"Batal",onOk:Q})}return A(()=>a.formData,()=>{var l;a.formData&&((l=f.value)==null||l.clearValidate(),e.code=a.formData.code,e.customer_id=a.formData.customer.id,e.address=a.formData.address,e.name=a.formData.name,e.note=a.formData.note,r.value=`${a.formData.customer.code} - ${a.formData.customer.name}`)}),q(async()=>{var l;try{await M(k.formOptions()),(l=H.value)!=null&&l.success&&(g.value=H.value.data)}catch{}}),(l,s)=>{const y=de,$=ee,C=ae,I=ue,U=V,J=te;return w(),E("div",ce,[d("div",me,[d("div",fe,[_e,i.editMode?(w(),O(y,{key:0,color:"orange"},{default:n(()=>[h("Mode Edit")]),_:1})):(w(),O(y,{key:1,color:"cyan"},{default:n(()=>[h("Mode Input")]),_:1}))])]),d("div",pe,[o(J,{ref_key:"formRef",ref:f,model:e,rules:c,"label-col":{style:{width:"220px"}},colon:!1,"label-align":"left",onFinish:s[5]||(s[5]=u=>D(Z)(f.value,z))},{default:n(()=>[d("div",ve,[d("div",he,[o(C,{label:"Kode Unit",name:"code",ref:"code"},{default:n(()=>[o($,{value:e.code,"onUpdate:value":s[0]||(s[0]=u=>e.code=u),valueModifiers:{trim:!0},style:{"text-transform":"uppercase"},disabled:i.editMode},null,8,["value","disabled"])]),_:1},512),o(C,{label:"Nama Unit",name:"name",ref:"name"},{default:n(()=>[o($,{value:e.name,"onUpdate:value":s[1]||(s[1]=u=>e.name=u)},null,8,["value"])]),_:1},512),o(C,{label:"Customer",name:"customer_id",ref:"customer_id"},{default:n(()=>{var u;return[o(oe,{"column-defs":p,"grid-data":((u=g.value)==null?void 0:u.customers)??[],loading:D(x),value:void 0,"value-display":r.value,onChange:s[2]||(s[2]=F=>{e.customer_id=F.id,r.value=`${F.code} - ${F.name}`})},null,8,["grid-data","loading","value-display"])]}),_:1},512),o(C,{label:"Alamat",name:"address",ref:"address"},{default:n(()=>[o(I,{value:e.address,"onUpdate:value":s[3]||(s[3]=u=>e.address=u)},null,8,["value"])]),_:1},512),o(C,{label:"Keterangan",name:"note",ref:"note"},{default:n(()=>[o(I,{value:e.note,"onUpdate:value":s[4]||(s[4]=u=>e.note=u)},null,8,["value"])]),_:1},512),o(U,{type:"primary","html-type":"submit",loading:D(m)},{default:n(()=>[ge,d("span",null,j(i.editMode?"Edit":"Simpan"),1)]),_:1},8,["loading"]),o(U,{class:"mx-3",onClick:S},{default:n(()=>[h(j(i.editMode?"Batal Edit":"Bersihkan"),1)]),_:1}),i.editMode?(w(),O(U,{key:0,danger:"",type:"primary",onClick:Y,loading:D(G)},{default:n(()=>[h(" Hapus ")]),_:1},8,["loading"])):se("",!0)])])]),_:1},8,["model"])])])}}}),we=B({__name:"DataTable",props:{idx:null},emits:["rowClick"],setup(i,{emit:t}){const a=i,r=K({value:[{field:"code",headerName:"Kode Unit",flex:0,width:100,pinned:"left"},{field:"name",headerName:"Nama Unit",flex:0,width:150},{field:"customer.name",headerName:"Nama Customer"},{field:"address",headerName:"Alamat"},{field:"note",headerName:"Keterangan"},{field:"created_at",headerName:"Diinput Tgl",...R},{field:"updated_at",headerName:"Diupdate Tgl",...R},{field:"created_by_user_username",headerName:"Diinput Oleh",flex:0,width:120},{field:"updated_by_user_username",headerName:"Diupdate Oleh",flex:0,width:120}]}),p=K({value:null}),{run:g,response:f,loading:e}=N();async function c(){var m;try{await g(k.list()),(m=f.value)!=null&&m.success&&(p.value=f.value.data)}catch{}}function _(m){t("rowClick",m)}return q(()=>{c()}),A(()=>a.idx,()=>{c()}),(m,b)=>(w(),E("div",null,[o(W,{"row-data":p.value,"column-defs":r.value,loading:D(e),onRowClick:_},null,8,["row-data","column-defs","loading"])]))}}),ye=d("span",null,[d("i",{class:"fe fe-edit-2 me-2"}),h(" Input ")],-1),Ce=d("span",null,[d("i",{class:"fe fe-search me-2"}),h(" Browse ")],-1),De=d("i",{class:"fe fe-refresh-cw me-2"},null,-1),Se=B({__name:"index",setup(i){const t=v("1"),a=v(),r=v(!1),p=v(1);function g(c){t.value="1",a.value={...c},r.value=!0}function f(){r.value=!1}function e(c){p.value+=1,c!==void 0&&(r.value=c)}return(c,_)=>{const m=re,b=V,M=le;return w(),E("div",null,[o(M,{class:"input-browse-tab",activeKey:t.value,"onUpdate:activeKey":_[1]||(_[1]=x=>t.value=x),animated:""},ne({default:n(()=>[o(m,{key:"1"},{tab:n(()=>[ye]),default:n(()=>[o(be,{"form-data":a.value,"edit-mode":r.value,onCancelEdit:f,onOnSuccess:e},null,8,["form-data","edit-mode"])]),_:1}),o(m,{key:"2"},{tab:n(()=>[Ce]),default:n(()=>[o(we,{idx:p.value,onRowClick:g},null,8,["idx"])]),_:1})]),_:2},[t.value==="2"?{name:"rightExtra",fn:n(()=>[o(b,{size:"small",class:"mt-3",onClick:_[0]||(_[0]=x=>p.value+=1)},{default:n(()=>[De,h(" Refresh Data ")]),_:1})]),key:"0"}:void 0]),1032,["activeKey"])])}}});export{Se as default};
